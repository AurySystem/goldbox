var beepbox=function(t){"use strict";
/*!
    Copyright (C) 2020 John Nesky

    Permission is hereby granted, free of charge, to any person obtaining a copy of
    this software and associated documentation files (the "Software"), to deal in
    the Software without restriction, including without limitation the rights to
    use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
    of the Software, and to permit persons to whom the Software is furnished to do
    so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.
    */class e{}function n(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];const n=e/t.length;let i=0,a=0;for(let e=0;e<t.length;e++)i+=a,a=t[e]-n,t[e]=i;return t.push(0),new Float64Array(t)}function i(t){let e=0,n=0;for(let i=0;i<t.length;i++)e+=t[i],n+=Math.abs(t[i]);const i=e/t.length,a=n/t.length;let r=0,s=0;for(let e=0;e<t.length;e++)r+=s,s=(t[e]-i)/a,t[e]=r;return t.push(0),new Float64Array(t)}function a(t,n=null,i=null){let a=e.chipNoises[t].samples;if(null==a){if(a=new Float32Array(e.chipNoiseLength+1),e.chipNoises[t].samples=a,0==t){let t=1;for(let n=0;n<e.chipNoiseLength;n++){a[n]=2*(1&t)-1;let e=t>>1;1==(t+e&1)&&(e+=16384),t=e}}else if(1==t)for(let t=0;t<e.chipNoiseLength;t++)a[t]=2*Math.random()-1;else if(2==t){let t=1;for(let n=0;n<e.chipNoiseLength;n++){a[n]=2*(1&t)-1;let e=t>>1;1==(t+e&1)&&(e+=32768),t=e}}else if(3==t){let t=1;for(let n=0;n<e.chipNoiseLength;n++){a[n]=2*(1&t)-1;let e=t>>1;1==(t+e&1)&&(e+=40),t=e}}else if(4==t)r(a,10,11,1,1,0),r(a,11,14,.6578,.6578,0),n(a,e.chipNoiseLength),i(a,1/Math.sqrt(e.chipNoiseLength));else if(5==t)for(var s=1,o=0;o<e.chipNoiseLength;o++){a[o]=2*(1&s)-1,1==(s+(l=s>>1)&1)&&(l+=40),s=l}else if(6==t)r(a,1,10,1,1,0),r(a,20,14,-2,-2,0),n(a,e.chipNoiseLength),i(a,1/Math.sqrt(e.chipNoiseLength));else if(7==t)for(s=1,o=0;o<e.chipNoiseLength;o++){a[o]=4*(1&s)*(14*Math.random()+1),1==(s+(l=s>>1)&1)&&(l+=60),s=l}else if(8==t)for(s=1,o=0;o<32768;o++){var l;a[o]=(1&s)/2+.5,1==(s+(l=s>>1)&1)&&(l-=40),s=l}else{if(9!=t)throw new Error("Unrecognized drum index: "+t);{let t=1;for(let n=0;n<e.chipNoiseLength;n++){a[n]=2*(1&t)-1.1;let e=t>>1;1==(t+e&1)&&(e+=131080),t=e}}}a[e.chipNoiseLength]=a[0]}return a}function r(t,n,i,r,s,o){const l=0|Math.pow(2,n),c=Math.min(e.chipNoiseLength>>1,0|Math.pow(2,i)),h=a(0);let m=0;for(let a=l;a<c;a++){let l=r+(s-r)*(Math.log(a)/Math.LN2-n)/(i-n),c=Math.pow(2,(l-1)*e.spectrumMax+1)*l;c*=Math.pow(a/2048,o),m+=c,c*=h[a];const d=.61803398875*a*a*Math.PI*2;t[a]=Math.cos(d)*c,t[e.chipNoiseLength-a]=Math.sin(d)*c}return m}function s(){const t=new Float64Array(e.sineWaveLength+1);for(let n=0;n<e.sineWaveLength+1;n++)t[n]=Math.sin(n*Math.PI*2/e.sineWaveLength);return t}function o(){const t=new Float64Array(e.sineWaveLength+1);for(let n=0;n<e.sineWaveLength+1;n++)t[n]=Math.asin(Math.sin(n*Math.PI*2/e.sineWaveLength))/(Math.PI/2);return t}function l(){const t=new Float64Array(e.sineWaveLength+1);for(let n=0;n<e.sineWaveLength+1;n++)t[n]=Math.sin(n*Math.PI*2/e.sineWaveLength),t[n]=t[n]>0?1:-1;return t}function c(){const t=new Float64Array(e.sineWaveLength+1);for(let n=0;n<e.sineWaveLength+1;n++)t[n]=2*(n-.75*e.sineWaveLength+e.sineWaveLength)/e.sineWaveLength%2-1;return t}function h(t,n,i){let a=e.arpeggioPatterns[t-1];return null!=a?(2==t&&0==n&&(a=[0,0,1,1]),a[i%a.length]):i%t}function m(t){const e={};for(let n=0;n<t.length;n++){const i=t[n];i.index=n,e[i.name]=i}const n=t;return n.dictionary=e,n}e.thresholdVal=-10,e.kneeVal=40,e.ratioVal=12,e.attackVal=0,e.releaseVal=.25,e.scales=m([{name:"Free",realName:"chromatic",flags:[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]},{name:"Major",realName:"ionian",flags:[!0,!1,!0,!1,!0,!0,!1,!0,!1,!0,!1,!0]},{name:"Minor",realName:"aeolian",flags:[!0,!1,!0,!0,!1,!0,!1,!0,!0,!1,!0,!1]},{name:"Mixolydian",realName:"mixolydian",flags:[!0,!1,!0,!1,!0,!0,!1,!0,!1,!0,!0,!1]},{name:"Lydian",realName:"lydian",flags:[!0,!1,!0,!1,!0,!1,!0,!0,!1,!0,!1,!0]},{name:"Dorian",realName:"dorian",flags:[!0,!1,!0,!0,!1,!0,!1,!0,!1,!0,!0,!1]},{name:"Phrygian",realName:"phrygian",flags:[!0,!0,!1,!0,!1,!0,!1,!0,!0,!1,!0,!1]},{name:"Locrian",realName:"locrian",flags:[!0,!0,!1,!0,!1,!0,!0,!1,!0,!1,!0,!1]},{name:"Lydian Dominant",realName:"lydian dominant",flags:[!0,!1,!0,!1,!0,!1,!0,!0,!1,!0,!0,!1]},{name:"Phrygian Dominant",realName:"phrygian dominant",flags:[!0,!0,!1,!1,!0,!0,!1,!0,!0,!1,!0,!1]},{name:"Harmonic Major",realName:"harmonic major",flags:[!0,!1,!0,!1,!0,!0,!1,!0,!0,!1,!1,!0]},{name:"Harmonic Minor",realName:"harmonic minor",flags:[!0,!1,!0,!0,!1,!0,!1,!0,!0,!1,!1,!0]},{name:"Melodic Minor",realName:"melodic minor",flags:[!0,!1,!0,!0,!1,!0,!1,!0,!1,!0,!1,!0]},{name:"Blues",realName:"blues",flags:[!0,!1,!1,!0,!1,!0,!0,!0,!1,!1,!0,!1]},{name:"Altered",realName:"altered",flags:[!0,!0,!1,!0,!0,!1,!0,!1,!0,!1,!0,!1]},{name:"Major Pentatonic",realName:"major pentatonic",flags:[!0,!1,!0,!1,!0,!1,!1,!0,!1,!0,!1,!1]},{name:"Minor Pentatonic",realName:"minor pentatonic",flags:[!0,!1,!1,!0,!1,!0,!1,!0,!1,!1,!0,!1]},{name:"Whole Tone",realName:"whole tone",flags:[!0,!1,!0,!1,!0,!1,!0,!1,!0,!1,!0,!1]},{name:"Octatonic",realName:"octatonic",flags:[!0,!1,!0,!0,!1,!0,!0,!1,!0,!0,!1,!0]},{name:"Hexatonic",realName:"hexatonic",flags:[!0,!1,!1,!0,!0,!1,!1,!0,!0,!1,!1,!0]},{name:"Custom",realName:"custom",flags:[!0,!1,!0,!0,!1,!1,!1,!0,!0,!1,!0,!0]}]),e.keys=m([{name:"C",isWhiteKey:!0,basePitch:12},{name:"C♯",isWhiteKey:!1,basePitch:13},{name:"D",isWhiteKey:!0,basePitch:14},{name:"D♯",isWhiteKey:!1,basePitch:15},{name:"E",isWhiteKey:!0,basePitch:16},{name:"F",isWhiteKey:!0,basePitch:17},{name:"F♯",isWhiteKey:!1,basePitch:18},{name:"G",isWhiteKey:!0,basePitch:19},{name:"G♯",isWhiteKey:!1,basePitch:20},{name:"A",isWhiteKey:!0,basePitch:21},{name:"A♯",isWhiteKey:!1,basePitch:22},{name:"B",isWhiteKey:!0,basePitch:23}]),e.blackKeyNameParents=[-1,1,-1,1,-1,1,-1,-1,1,-1,1,-1],e.tempoMin=30,e.tempoMax=320,e.reverbRange=32,e.beatsPerBarMin=2,e.beatsPerBarMax=16,e.barCountMin=1,e.barCountMax=256,e.instrumentsPerChannelMin=1,e.instrumentsPerChannelMax=10,e.partsPerBeat=24,e.ticksPerPart=2,e.ticksPerArpeggio=3,e.arpeggioPatterns=[[0],[0,1],[0,1,2,1],[0,1,2,3],[0,1,2,3,4],[0,1,2,3,4,5],[0,1,2,3,4,5,6],[0,1,2,3,4,5,6,7]],e.rhythms=m([{name:"÷3 (triplets)",stepsPerBeat:3,roundUpThresholds:[5,12,18]},{name:"÷4 (standard)",stepsPerBeat:4,roundUpThresholds:[3,9,17,21]},{name:"÷6",stepsPerBeat:6,roundUpThresholds:null},{name:"÷8",stepsPerBeat:8,roundUpThresholds:null},{name:"freehand",stepsPerBeat:24,roundUpThresholds:null}]),e.instrumentTypeNames=["chip","FM","noise","spectrum","drumset","harmonics","PWM","custom chip","mod"],e.instrumentTypeHasSpecialInterval=[!0,!0,!1,!1,!1,!0,!1,!0],e.chipWaves=m([{name:"rounded",volume:.94,samples:n([0,.2,.4,.5,.6,.7,.8,.85,.9,.95,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.95,.9,.85,.8,.7,.6,.5,.4,.2,0,-.2,-.4,-.5,-.6,-.7,-.8,-.85,-.9,-.95,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-.95,-.9,-.85,-.8,-.7,-.6,-.5,-.4,-.2])},{name:"triangle",volume:1,samples:n([1/15,.2,5/15,7/15,.6,11/15,13/15,1,1,13/15,11/15,.6,7/15,5/15,.2,1/15,-1/15,-.2,-5/15,-7/15,-.6,-11/15,-13/15,-1,-1,-13/15,-11/15,-.6,-7/15,-5/15,-.2,-1/15])},{name:"square",volume:.5,samples:n([1,-1])},{name:"1/4 pulse",volume:.5,samples:n([1,-1,-1,-1])},{name:"1/8 pulse",volume:.5,samples:n([1,-1,-1,-1,-1,-1,-1,-1])},{name:"sawtooth",volume:.65,samples:n([1/31,3/31,5/31,7/31,9/31,11/31,13/31,15/31,17/31,19/31,21/31,23/31,25/31,27/31,29/31,1,-1,-29/31,-27/31,-25/31,-23/31,-21/31,-19/31,-17/31,-15/31,-13/31,-11/31,-9/31,-7/31,-5/31,-3/31,-1/31])},{name:"double saw",volume:.5,samples:n([0,-.2,-.4,-.6,-.8,-1,1,-.8,-.6,-.4,-.2,1,.8,.6,.4,.2])},{name:"double pulse",volume:.4,samples:n([1,1,1,1,1,-1,-1,-1,1,1,1,1,-1,-1,-1,-1])},{name:"spiky",volume:.4,samples:n([1,-1,1,-1,1,0])},{name:"sine",volume:.88,samples:i([8,9,11,12,13,14,15,15,15,15,14,14,13,11,10,9,7,6,4,3,2,1,0,0,0,0,1,1,2,4,5,6])},{name:"flute",volume:.8,samples:i([3,4,6,8,10,11,13,14,15,15,14,13,11,8,5,3])},{name:"harp",volume:.8,samples:i([0,3,3,3,4,5,5,6,7,8,9,11,11,13,13,15,15,14,12,11,10,9,8,7,7,5,4,3,2,1,0,0])},{name:"sharp clarinet",volume:.38,samples:i([0,0,0,1,1,8,8,9,9,9,8,8,8,8,8,9,9,7,9,9,10,4,0,0,0,0,0,0,0,0,0,0])},{name:"soft clarinet",volume:.45,samples:i([0,1,5,8,9,9,9,9,9,9,9,11,11,12,13,12,10,9,7,6,4,3,3,3,1,1,1,1,1,1,1,1])},{name:"alto sax",volume:.3,samples:i([5,5,6,4,3,6,8,7,2,1,5,6,5,4,5,7,9,11,13,14,14,14,14,13,10,8,7,7,4,3,4,2])},{name:"bassoon",volume:.35,samples:i([9,9,7,6,5,4,4,4,4,5,7,8,9,10,11,13,13,11,10,9,7,6,4,2,1,1,1,2,2,5,11,14])},{name:"trumpet",volume:.22,samples:i([10,11,8,6,5,5,5,6,7,7,7,7,6,6,7,7,7,7,7,6,6,6,6,6,6,6,6,7,8,9,11,14])},{name:"electric guitar",volume:.2,samples:i([11,12,12,10,6,6,8,0,2,4,8,10,9,10,1,7,11,3,6,6,8,13,14,2,0,12,8,4,13,11,10,13])},{name:"organ",volume:.2,samples:i([11,10,12,11,14,7,5,5,12,10,10,9,12,6,4,5,13,12,12,10,12,5,2,2,8,6,6,5,8,3,2,1])},{name:"pan flute",volume:.35,samples:i([1,4,7,6,7,9,7,7,11,12,13,15,13,11,11,12,13,10,7,5,3,6,10,7,3,3,1,0,1,0,1,0])},{name:"glitch",volume:.5,samples:n([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1])}]),e.chipNoises=m([{name:"retro",volume:.25,basePitch:69,pitchFilterMult:1024,isSoft:!1,samples:null},{name:"white",volume:1,basePitch:69,pitchFilterMult:8,isSoft:!0,samples:null},{name:"clang",volume:.4,basePitch:69,pitchFilterMult:1024,isSoft:!1,samples:null},{name:"buzz",volume:.3,basePitch:69,pitchFilterMult:1024,isSoft:!1,samples:null},{name:"hollow",volume:1.5,basePitch:96,pitchFilterMult:1,isSoft:!0,samples:null},{name:"shine",volume:1,basePitch:69,pitchFilterMult:1024,isSoft:!1,samples:null},{name:"deep",volume:1.5,basePitch:120,pitchFilterMult:1024,isSoft:!0,samples:null},{name:"cutter",volume:.005,basePitch:96,pitchFilterMult:1024,isSoft:!1,samples:null},{name:"metallic",volume:1,basePitch:96,pitchFilterMult:1024,isSoft:!1,samples:null},{name:"uhhh??",volume:1,basePitch:96,pitchFilterMult:1024,isSoft:!1,samples:null}]),e.filterCutoffMaxHz=8e3,e.filterCutoffMinHz=1,e.filterMax=.95,e.filterMaxResonance=.95,e.filterCutoffRange=11,e.filterResonanceRange=8,e.transitions=m([{name:"seamless",isSeamless:!0,attackSeconds:0,releases:!1,releaseTicks:1,slides:!1,slideTicks:3},{name:"hard",isSeamless:!1,attackSeconds:0,releases:!1,releaseTicks:3,slides:!1,slideTicks:3},{name:"soft",isSeamless:!1,attackSeconds:.025,releases:!1,releaseTicks:3,slides:!1,slideTicks:3},{name:"slide",isSeamless:!0,attackSeconds:.025,releases:!1,releaseTicks:3,slides:!0,slideTicks:3},{name:"cross fade",isSeamless:!1,attackSeconds:.04,releases:!0,releaseTicks:6,slides:!1,slideTicks:3},{name:"hard fade",isSeamless:!1,attackSeconds:0,releases:!0,releaseTicks:48,slides:!1,slideTicks:3},{name:"medium fade",isSeamless:!1,attackSeconds:.0125,releases:!0,releaseTicks:72,slides:!1,slideTicks:3},{name:"soft fade",isSeamless:!1,attackSeconds:.06,releases:!0,releaseTicks:96,slides:!1,slideTicks:6},{name:"sliding fade",isSeamless:!1,attackSeconds:.08,releases:!0,releaseTicks:96,slides:!0,slideTicks:6}]),e.vibratos=m([{name:"none",amplitude:0,type:0,delayParts:0},{name:"light",amplitude:.15,type:0,delayParts:0},{name:"delayed",amplitude:.3,type:0,delayParts:18},{name:"heavy",amplitude:.45,type:0,delayParts:0},{name:"shaky",amplitude:.1,type:1,delayParts:0}]),e.vibratoTypes=m([{name:"normal",periodsSeconds:[.14],period:.14},{name:"shaky",periodsSeconds:[.11,.17798,.33],period:266.97}]),e.arpSpeedScale=[0,.0625,.125,.2,.25,1/3,.4,.5,2/3,.75,.8,.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.15,4.3,4.5,4.8,5,5.5,6,8],e.intervals=m([{name:"union",spread:0,offset:0,volume:.7,sign:1},{name:"shimmer",spread:.018,offset:0,volume:.8,sign:1},{name:"hum",spread:.045,offset:0,volume:1,sign:1},{name:"honky tonk",spread:.09,offset:0,volume:1,sign:1},{name:"dissonant",spread:.25,offset:0,volume:.9,sign:1},{name:"fifth",spread:3.5,offset:3.5,volume:.9,sign:1},{name:"octave",spread:6,offset:6,volume:.8,sign:1},{name:"bowed",spread:.02,offset:0,volume:1,sign:-1},{name:"piano",spread:.01,offset:0,volume:1,sign:.7},{name:"warbled",spread:.25,offset:.05,volume:.9,sign:-.8}]),e.effectsNames=["none","reverb","chorus","chorus & reverb"],e.volumeRange=50,e.volumeLogScale=.1428,e.panCenter=50,e.panMax=2*e.panCenter,e.detuneMin=-50,e.detuneMax=50,e.songDetuneMin=-250,e.songDetuneMax=250,e.chords=m([{name:"harmony",harmonizes:!0,customInterval:!1,arpeggiates:!1,isCustomInterval:!1,strumParts:0},{name:"strum",harmonizes:!0,customInterval:!1,arpeggiates:!1,isCustomInterval:!1,strumParts:1},{name:"arpeggio",harmonizes:!1,customInterval:!1,arpeggiates:!0,isCustomInterval:!1,strumParts:0},{name:"custom interval",harmonizes:!0,customInterval:!0,arpeggiates:!0,isCustomInterval:!0,strumParts:0}]),e.maxChordSize=9,e.operatorCount=4,e.algorithms=m([{name:"1←(2 3 4)",carrierCount:1,associatedCarrier:[1,1,1,1],modulatedBy:[[2,3,4],[],[],[]]},{name:"1←(2 3←4)",carrierCount:1,associatedCarrier:[1,1,1,1],modulatedBy:[[2,3],[],[4],[]]},{name:"1←2←(3 4)",carrierCount:1,associatedCarrier:[1,1,1,1],modulatedBy:[[2],[3,4],[],[]]},{name:"1←(2 3)←4",carrierCount:1,associatedCarrier:[1,1,1,1],modulatedBy:[[2,3],[4],[4],[]]},{name:"1←2←3←4",carrierCount:1,associatedCarrier:[1,1,1,1],modulatedBy:[[2],[3],[4],[]]},{name:"1←3 2←4",carrierCount:2,associatedCarrier:[1,2,1,2],modulatedBy:[[3],[4],[],[]]},{name:"1 2←(3 4)",carrierCount:2,associatedCarrier:[1,2,2,2],modulatedBy:[[],[3,4],[],[]]},{name:"1 2←3←4",carrierCount:2,associatedCarrier:[1,2,2,2],modulatedBy:[[],[3],[4],[]]},{name:"(1 2)←3←4",carrierCount:2,associatedCarrier:[1,2,2,2],modulatedBy:[[3],[3],[4],[]]},{name:"(1 2)←(3 4)",carrierCount:2,associatedCarrier:[1,2,2,2],modulatedBy:[[3,4],[3,4],[],[]]},{name:"1 2 3←4",carrierCount:3,associatedCarrier:[1,2,3,3],modulatedBy:[[],[],[4],[]]},{name:"(1 2 3)←4",carrierCount:3,associatedCarrier:[1,2,3,3],modulatedBy:[[4],[4],[4],[]]},{name:"1 2 3 4",carrierCount:4,associatedCarrier:[1,2,3,4],modulatedBy:[[],[],[],[]]},{name:"1←(2 3) 2←4",carrierCount:2,associatedCarrier:[1,2,1,2],modulatedBy:[[2,3],[4],[],[]]}]),e.operatorCarrierInterval=[0,.04,-.073,.091],e.operatorAmplitudeMax=15,e.operatorFrequencies=m([{name:"1×",mult:1,hzOffset:0,amplitudeSign:1},{name:"~1×",mult:1,hzOffset:1.5,amplitudeSign:-1},{name:"2×",mult:2,hzOffset:0,amplitudeSign:1},{name:"~2×",mult:2,hzOffset:-1.3,amplitudeSign:-1},{name:"3×",mult:3,hzOffset:0,amplitudeSign:1},{name:"4×",mult:4,hzOffset:0,amplitudeSign:1},{name:"5×",mult:5,hzOffset:0,amplitudeSign:1},{name:"6×",mult:6,hzOffset:0,amplitudeSign:1},{name:"7×",mult:7,hzOffset:0,amplitudeSign:1},{name:"8×",mult:8,hzOffset:0,amplitudeSign:1},{name:"9×",mult:9,hzOffset:0,amplitudeSign:1},{name:"11×",mult:11,hzOffset:0,amplitudeSign:1},{name:"13×",mult:13,hzOffset:0,amplitudeSign:1},{name:"16×",mult:16,hzOffset:0,amplitudeSign:1},{name:"20×",mult:20,hzOffset:0,amplitudeSign:1},{name:"0.5×",mult:.5,hzOffset:0,amplitudeSign:1},{name:"0.25×",mult:.25,hzOffset:0,amplitudeSign:1},{name:"3.5×",mult:3.5,hzOffset:-.05,amplitudeSign:1}]),e.envelopes=m([{name:"custom",type:0,speed:0},{name:"steady",type:1,speed:0},{name:"punch",type:2,speed:0},{name:"flare 1",type:3,speed:32},{name:"flare 2",type:3,speed:8},{name:"flare 3",type:3,speed:2},{name:"twang 1",type:4,speed:32},{name:"twang 2",type:4,speed:8},{name:"twang 3",type:4,speed:2},{name:"swell 1",type:5,speed:32},{name:"swell 2",type:5,speed:8},{name:"swell 3",type:5,speed:2},{name:"tremolo1",type:6,speed:4},{name:"tremolo2",type:6,speed:2},{name:"tremolo3",type:6,speed:1},{name:"tremolo4",type:7,speed:4},{name:"tremolo5",type:7,speed:2},{name:"tremolo6",type:7,speed:1},{name:"decay 1",type:8,speed:10},{name:"decay 2",type:8,speed:7},{name:"decay 3",type:8,speed:4},{name:"wibble 1",type:9,speed:24},{name:"wibble 2",type:9,speed:12},{name:"wibble 3",type:9,speed:4},{name:"linear 1",type:11,speed:32},{name:"linear 2",type:11,speed:8},{name:"linear 3",type:11,speed:2},{name:"linear-1",type:11,speed:128}]),e.feedbacks=m([{name:"1⟲",indices:[[1],[],[],[]]},{name:"2⟲",indices:[[],[2],[],[]]},{name:"3⟲",indices:[[],[],[3],[]]},{name:"4⟲",indices:[[],[],[],[4]]},{name:"1⟲ 2⟲",indices:[[1],[2],[],[]]},{name:"3⟲ 4⟲",indices:[[],[],[3],[4]]},{name:"1⟲ 2⟲ 3⟲",indices:[[1],[2],[3],[]]},{name:"2⟲ 3⟲ 4⟲",indices:[[],[2],[3],[4]]},{name:"1⟲ 2⟲ 3⟲ 4⟲",indices:[[1],[2],[3],[4]]},{name:"1→2",indices:[[],[1],[],[]]},{name:"1→3",indices:[[],[],[1],[]]},{name:"1→4",indices:[[],[],[],[1]]},{name:"2→3",indices:[[],[],[2],[]]},{name:"2→4",indices:[[],[],[],[2]]},{name:"3→4",indices:[[],[],[],[3]]},{name:"1→3 2→4",indices:[[],[],[1],[2]]},{name:"1→4 2→3",indices:[[],[],[2],[1]]},{name:"1→2→3→4",indices:[[],[1],[2],[3]]},{name:"1↔2 3↔4",indices:[[2],[1],[4],[3]]},{name:"1↔4 2↔3",indices:[[4],[3],[2],[1]]},{name:"2→1→4→3→2",indices:[[2],[3],[4],[1]]}]),e.chipNoiseLength=32768,e.spectrumBasePitch=24,e.spectrumControlPoints=30,e.spectrumControlPointsPerOctave=7,e.spectrumControlPointBits=3,e.spectrumMax=(1<<e.spectrumControlPointBits)-1,e.harmonicsControlPoints=28,e.harmonicsRendered=64,e.harmonicsControlPointBits=3,e.harmonicsMax=(1<<e.harmonicsControlPointBits)-1,e.harmonicsWavelength=2048,e.pulseWidthRange=50,e.pitchChannelCountMin=1,e.pitchChannelCountMax=40,e.noiseChannelCountMin=0,e.noiseChannelCountMax=8,e.modChannelCountMin=0,e.modChannelCountMax=8,e.noiseInterval=6,e.pitchesPerOctave=12,e.drumCount=12,e.modCount=6,e.pitchOctaves=8,e.maxScrollableOctaves=5,e.maxPitch=e.pitchOctaves*e.pitchesPerOctave,e.maximumTonesPerChannel=2*e.maxChordSize,e.sineWaveLength=256,e.sineWaveMask=e.sineWaveLength-1,e.sineWave=s(),e.triWave=o(),e.squareWave=l(),e.sawWave=c(),e.operatorWaves=m([{name:"sine",samples:s()},{name:"triangle",samples:o()},{name:"sawtooth",samples:c()},{name:"square",samples:l()}]),e.barEditorHeight=10;var d=t&&t.t||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},f=t&&t.i||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,a,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){a={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return s},p=t&&t.o||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(f(arguments[e]));return t};function u(t,e){var n,i,a,r,s,o;try{for(var l=d(e),c=l.next();!c.done;c=l.next()){var h=c.value;if(h instanceof Node)t.appendChild(h);else if("string"==typeof h)t.appendChild(document.createTextNode(h));else if("function"==typeof h)u(t,[h()]);else if(Array.isArray(h))u(t,h);else if(h&&"undefined"!=typeof Symbol&&"function"==typeof h[Symbol.iterator])u(t,p(h));else if(h&&h.constructor===Object&&t instanceof Element)try{for(var m=(a=void 0,d(Object.keys(h))),f=m.next();!f.done;f=m.next()){var y=f.value,v=h[y];if("class"===y)"string"==typeof v?t.setAttribute("class",v):Array.isArray(h)||v&&"undefined"!=typeof Symbol&&"function"==typeof v[Symbol.iterator]?t.setAttribute("class",p(v).join(" ")):console.warn("Invalid "+y+' value "'+v+'" on '+t.tagName+" element.");else if("style"===y)if(v&&v.constructor===Object)try{for(var g=(s=void 0,d(Object.keys(v))),b=g.next();!b.done;b=g.next()){var k=b.value;k in t.style?t.style[k]=v[k]:t.style.setProperty(k,v[k])}}catch(t){s={error:t}}finally{try{b&&!b.done&&(o=g.return)&&o.call(g)}finally{if(s)throw s.error}}else t.setAttribute(y,v);else"function"==typeof v?t[y]=v:"boolean"==typeof v?v?t.setAttribute(y,""):t.removeAttribute(y):t.setAttribute(y,v)}}catch(t){a={error:t}}finally{try{f&&!f.done&&(r=m.return)&&r.call(m)}finally{if(a)throw a.error}}else t.appendChild(document.createTextNode(h))}}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return t}var y="http://www.w3.org/2000/svg";var v,g,b,k,w=t&&t.t||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},M=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return document.createRange().createContextualFragment(t.join())},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=document.createDocumentFragment(),i=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg">'+t.join()+"</svg>","image/svg+xml").documentElement;null!==i.firstChild;)document.importNode(i.firstChild,!0),n.appendChild(i.firstChild);return n},E=function(t){M[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return u(document.createElement(t),e)}};try{for(var q=w("a abbr address area article aside audio b base bdi bdo blockquote br button canvas caption cite code col colgroup datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hr i iframe img input ins kbd label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td template textarea tfoot th thead time title tr track u ul var video wbr".split(" ")),x=q.next();!x.done;x=q.next()){E(x.value)}}catch(t){v={error:t}}finally{try{x&&!x.done&&(g=q.return)&&g.call(q)}finally{if(v)throw v.error}}var P=function(t){if(C[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return u(document.createElementNS(y,t),e)},/-/.test(t)){var e=t.replace(/-/g,"_");C[e]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return u(document.createElementNS(y,t),e)}}};try{for(var S=w("a altGlyph altGlyphDef altGlyphItem animate animateMotion animateTransform circle clipPath color-profile cursor defs desc discard ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font font-face font-face-format font-face-name font-face-src font-face-uri foreignObject g glyph glyphRef hkern image line linearGradient marker mask metadata missing-glyph mpath path pattern polygon polyline radialGradient rect script set stop style svg switch symbol text textPath title tref tspan use view vkern".split(" ")),F=S.next();!F.done;F=S.next()){P(F.value)}}catch(t){b={error:t}}finally{try{F&&!F.done&&(k=S.return)&&k.call(S)}finally{if(b)throw b.error}}class z{static resetColors(){this.colorLookup.clear()}static getComputedChannelColor(t,e){if("false"==getComputedStyle(this.l).getPropertyValue("--use-color-formula").trim()){let i=z.getChannelColor(t,e);var n=/\(([^)]+)\)/;return{secondaryChannel:z.getComputed(n.exec(i.secondaryChannel)[1]),primaryChannel:z.getComputed(n.exec(i.primaryChannel)[1]),secondaryNote:z.getComputed(n.exec(i.secondaryNote)[1]),primaryNote:z.getComputed(n.exec(i.primaryNote)[1])}}return z.getChannelColor(t,e)}static getChannelColor(t,n){if("false"==getComputedStyle(this.l).getPropertyValue("--use-color-formula").trim())return n<t.pitchChannelCount?z.pitchChannels[n%z.pitchChannels.length]:n<t.pitchChannelCount+t.noiseChannelCount?z.noiseChannels[(n-t.pitchChannelCount)%z.noiseChannels.length]:z.modChannels[(n-t.pitchChannelCount-t.noiseChannelCount)%z.modChannels.length];if(z.colorLookup.has(n))return z.colorLookup.get(n);if(n<t.pitchChannelCount){const t=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-channel-hue"),i=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-channel-hue-scale"),a=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-channel-sat"),r=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-channel-sat-scale"),s=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-channel-lum"),o=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-channel-lum-scale"),l=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-channel-hue"),c=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-channel-hue-scale"),h=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-channel-sat"),m=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-channel-sat-scale"),d=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-channel-lum"),f=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-channel-lum-scale"),p=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-note-hue"),u=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-note-hue-scale"),y=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-note-sat"),v=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-note-sat-scale"),g=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-note-lum"),b=+getComputedStyle(this.l).getPropertyValue("--pitch-secondary-note-lum-scale"),k=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-note-hue"),w=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-note-hue-scale"),M=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-note-sat"),C=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-note-sat-scale"),E=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-note-lum"),q=+getComputedStyle(this.l).getPropertyValue("--pitch-primary-note-lum-scale");let x={secondaryChannel:"hsl("+(+t+n*+i/e.pitchChannelCountMax*256)%256+","+ +a*(1-+r*Math.floor(n/7))+"%,"+ +s*(1-+o*Math.floor(n/7))+"%)",primaryChannel:"hsl("+(+l+n*+c/e.pitchChannelCountMax*256)%256+","+ +h*(1-+m*Math.floor(n/7))+"%,"+ +d*(1-+f*Math.floor(n/7))+"%)",secondaryNote:"hsl("+(+p+n*+u/e.pitchChannelCountMax*256)%256+","+ +y*(1-+v*Math.floor(n/7))+"%,"+ +g*(1-+b*Math.floor(n/7))+"%)",primaryNote:"hsl("+(+k+n*+w/e.pitchChannelCountMax*256)%256+","+ +M*(1-+C*Math.floor(n/7))+"%,"+ +E*(1-+q*Math.floor(n/7))+"%)"};return z.colorLookup.set(n,x),x}if(n<t.pitchChannelCount+t.noiseChannelCount){const i=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-channel-hue"),a=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-channel-hue-scale"),r=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-channel-sat"),s=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-channel-sat-scale"),o=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-channel-lum"),l=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-channel-lum-scale"),c=+getComputedStyle(this.l).getPropertyValue("--noise-primary-channel-hue"),h=+getComputedStyle(this.l).getPropertyValue("--noise-primary-channel-hue-scale"),m=+getComputedStyle(this.l).getPropertyValue("--noise-primary-channel-sat"),d=+getComputedStyle(this.l).getPropertyValue("--noise-primary-channel-sat-scale"),f=+getComputedStyle(this.l).getPropertyValue("--noise-primary-channel-lum"),p=+getComputedStyle(this.l).getPropertyValue("--noise-primary-channel-lum-scale"),u=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-note-hue"),y=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-note-hue-scale"),v=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-note-sat"),g=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-note-sat-scale"),b=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-note-lum"),k=+getComputedStyle(this.l).getPropertyValue("--noise-secondary-note-lum-scale"),w=+getComputedStyle(this.l).getPropertyValue("--noise-primary-note-hue"),M=+getComputedStyle(this.l).getPropertyValue("--noise-primary-note-hue-scale"),C=+getComputedStyle(this.l).getPropertyValue("--noise-primary-note-sat"),E=+getComputedStyle(this.l).getPropertyValue("--noise-primary-note-sat-scale"),q=+getComputedStyle(this.l).getPropertyValue("--noise-primary-note-lum"),x=+getComputedStyle(this.l).getPropertyValue("--noise-primary-note-lum-scale");let P={secondaryChannel:"hsl("+(+i+(n-t.pitchChannelCount)*+a/e.noiseChannelCountMax*256)%256+","+(+r+n*+s)+"%,"+(+o+n*+l)+"%)",primaryChannel:"hsl("+(+c+(n-t.pitchChannelCount)*+h/e.noiseChannelCountMax*256)%256+","+(+m+n*+d)+"%,"+(+f+n*+p)+"%)",secondaryNote:"hsl("+(+u+(n-t.pitchChannelCount)*+y/e.noiseChannelCountMax*256)%256+","+(+v+n*+g)+"%,"+(+b+n*+k)+"%)",primaryNote:"hsl("+(+w+(n-t.pitchChannelCount)*+M/e.noiseChannelCountMax*256)%256+","+(+C+n*+E)+"%,"+(+q+n*+x)+"%)"};return z.colorLookup.set(n,P),P}{const i=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-channel-hue"),a=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-channel-hue-scale"),r=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-channel-sat"),s=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-channel-sat-scale"),o=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-channel-lum"),l=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-channel-lum-scale"),c=+getComputedStyle(this.l).getPropertyValue("--mod-primary-channel-hue"),h=+getComputedStyle(this.l).getPropertyValue("--mod-primary-channel-hue-scale"),m=+getComputedStyle(this.l).getPropertyValue("--mod-primary-channel-sat"),d=+getComputedStyle(this.l).getPropertyValue("--mod-primary-channel-sat-scale"),f=+getComputedStyle(this.l).getPropertyValue("--mod-primary-channel-lum"),p=+getComputedStyle(this.l).getPropertyValue("--mod-primary-channel-lum-scale"),u=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-note-hue"),y=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-note-hue-scale"),v=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-note-sat"),g=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-note-sat-scale"),b=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-note-lum"),k=+getComputedStyle(this.l).getPropertyValue("--mod-secondary-note-lum-scale"),w=+getComputedStyle(this.l).getPropertyValue("--mod-primary-note-hue"),M=+getComputedStyle(this.l).getPropertyValue("--mod-primary-note-hue-scale"),C=+getComputedStyle(this.l).getPropertyValue("--mod-primary-note-sat"),E=+getComputedStyle(this.l).getPropertyValue("--mod-primary-note-sat-scale"),q=+getComputedStyle(this.l).getPropertyValue("--mod-primary-note-lum"),x=+getComputedStyle(this.l).getPropertyValue("--mod-primary-note-lum-scale");let P={secondaryChannel:"hsl("+(+i+(n-t.pitchChannelCount-t.noiseChannelCount)*+a/e.modChannelCountMax*256)%256+","+(+r+n*+s)+"%,"+(+o+n*+l)+"%)",primaryChannel:"hsl("+(+c+(n-t.pitchChannelCount-t.noiseChannelCount)*+h/e.modChannelCountMax*256)%256+","+(+m+n*+d)+"%,"+(+f+n*+p)+"%)",secondaryNote:"hsl("+(+u+(n-t.pitchChannelCount-t.noiseChannelCount)*+y/e.modChannelCountMax*256)%256+","+(+v+n*+g)+"%,"+(+b+n*+k)+"%)",primaryNote:"hsl("+(+w+(n-t.pitchChannelCount-t.noiseChannelCount)*+M/e.modChannelCountMax*256)%256+","+(+C+n*+E)+"%,"+(+q+n*+x)+"%)"};return z.colorLookup.set(n,P),P}}static setTheme(t){this.l.textContent=this.themes[t];const e=document.querySelector("meta[name='theme-color']");null!=e&&e.setAttribute("content",getComputedStyle(document.documentElement).getPropertyValue("--ui-widget-background")),this.resetColors()}static getComputed(t){return getComputedStyle(this.l).getPropertyValue(t)}}z.colorLookup=new Map,z.themes={"dark classic":"\n\t\t\t\t:root {\n\t\t\t\t\t--page-margin: black;\n\t\t\t\t\t--editor-background: black;\n\t\t\t\t\t--hover-preview: white;\n\t\t\t\t\t--playhead: white;\n\t\t\t\t\t--primary-text: white;\n\t\t\t\t\t--secondary-text: #999;\n\t\t\t\t\t--inverted-text: black;\n\t\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t\t--loop-accent: #74f;\n\t\t\t\t\t--link-accent: #98f;\n\t\t\t\t\t--ui-widget-background: #444;\n\t\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t\t--pitch-background: #444;\n\t\t\t\t\t--tonic: #864;\n\t\t\t\t\t--fifth-note: #468;\n\t\t\t\t\t--white-piano-key: #bbb;\n\t\t\t\t\t--black-piano-key: #444;\n\t\t\t\t\t--use-color-formula: false;\n\t\t\t\t\t--track-editor-bg-pitch: #444;\n\t\t\t\t\t--track-editor-bg-pitch-dim: #333;\n\t\t\t\t\t--track-editor-bg-noise: #444;\n\t\t\t\t\t--track-editor-bg-noise-dim: #333;\n\t\t\t\t\t--track-editor-bg-mod: #234;\n\t\t\t\t\t--track-editor-bg-mod-dim: #123;\n\t\t\t\t\t--multiplicative-mod-slider: #456;\n\t\t\t\t\t--overwriting-mod-slider: #654;\n\t\t\t\t\t--indicator-primary: #74f;\n\t\t\t\t\t--indicator-secondary: #444;\n\t\t\t\t\t--select2-opt-group: #585858;\n\t\t\t\t\t--input-box-outline: #333;\n\t\t\t\t\t--mute-button-normal: #ffa033;\n\t\t\t\t\t--mute-button-mod: #9a6bff;\n\t\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t\t--pitch1-secondary-note:    #00bdc7;\n\t\t\t\t\t--pitch1-primary-note:      #92f9ff;\n\t\t\t\t\t--pitch2-secondary-channel: #a1a100;\n\t\t\t\t\t--pitch2-primary-channel:   #ffff25;\n\t\t\t\t\t--pitch2-secondary-note:    #c7c700;\n\t\t\t\t\t--pitch2-primary-note:      #ffff92;\n\t\t\t\t\t--pitch3-secondary-channel: #c75000;\n\t\t\t\t\t--pitch3-primary-channel:   #ff9752;\n\t\t\t\t\t--pitch3-secondary-note:    #ff771c;\n\t\t\t\t\t--pitch3-primary-note:      #ffcdab;\n\t\t\t\t\t--pitch4-secondary-channel: #00a100;\n\t\t\t\t\t--pitch4-primary-channel:   #50ff50;\n\t\t\t\t\t--pitch4-secondary-note:    #00c700;\n\t\t\t\t\t--pitch4-primary-note:      #a0ffa0;\n\t\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t\t--pitch5-primary-channel:   #ff90ff;\n\t\t\t\t\t--pitch5-secondary-note:    #e040e0;\n\t\t\t\t\t--pitch5-primary-note:      #ffc0ff;\n\t\t\t\t\t--pitch6-secondary-channel: #7777b0;\n\t\t\t\t\t--pitch6-primary-channel:   #a0a0ff;\n\t\t\t\t\t--pitch6-secondary-note:    #8888d0;\n\t\t\t\t\t--pitch6-primary-note:      #d0d0ff;\n\t\t\t\t\t--pitch7-secondary-channel: #8AA100;\n\t\t\t\t\t--pitch7-primary-channel:   #DEFF25;\n\t\t\t\t\t--pitch7-secondary-note:\t  #AAC700;\n\t\t\t\t\t--pitch7-primary-note:\t\t\t#E6FF92;\n\t\t\t\t\t--pitch8-secondary-channel: #DF0019;\n\t\t\t\t\t--pitch8-primary-channel:   #FF98A4;\n\t\t\t\t\t--pitch8-secondary-note:    #FF4E63;\n\t\t\t\t\t--pitch8-primary-note:      #FFB2BB;\n\t\t\t\t\t--pitch9-secondary-channel: #00A170;\n\t\t\t\t\t--pitch9-primary-channel:   #50FFC9;\n\t\t\t\t\t--pitch9-secondary-note:    #00C78A;\n\t\t\t\t\t--pitch9-primary-note:\t\t\t#83FFD9;\n\t\t\t\t\t--pitch10-secondary-channel:#A11FFF;\n\t\t\t\t\t--pitch10-primary-channel:  #CE8BFF;\n\t\t\t\t\t--pitch10-secondary-note:   #B757FF;\n\t\t\t\t\t--pitch10-primary-note:     #DFACFF;\n\t\t\t\t\t--noise1-secondary-channel: #6f6f6f;\n\t\t\t\t\t--noise1-primary-channel:   #aaaaaa;\n\t\t\t\t\t--noise1-secondary-note:    #a7a7a7;\n\t\t\t\t\t--noise1-primary-note:      #e0e0e0;\n\t\t\t\t\t--noise2-secondary-channel: #996633;\n\t\t\t\t\t--noise2-primary-channel:   #ddaa77;\n\t\t\t\t\t--noise2-secondary-note:    #cc9966;\n\t\t\t\t\t--noise2-primary-note:      #f0d0bb;\n\t\t\t\t\t--noise3-secondary-channel: #4a6d8f;\n\t\t\t\t\t--noise3-primary-channel:   #77aadd;\n\t\t\t\t\t--noise3-secondary-note:    #6f9fcf;\n\t\t\t\t\t--noise3-primary-note:      #bbd7ff;\n\t\t\t\t\t--noise4-secondary-channel: #6B3E8E;\n\t\t\t\t\t--noise4-primary-channel:   #AF82D2;\n\t\t\t\t\t--noise4-secondary-note:    #9E71C1;\n\t\t\t\t\t--noise4-primary-note:      #D4C1EA;\n          --mod1-secondary-channel:   #339955;\n\t\t\t\t\t--mod1-primary-channel:     #77fc55;\n\t\t\t\t\t--mod1-secondary-note:      #77ff8a;\n\t\t\t\t\t--mod1-primary-note:        #cdffee;\n\t\t\t\t\t--mod2-secondary-channel:   #993355;\n\t\t\t\t\t--mod2-primary-channel:     #f04960;\n\t\t\t\t\t--mod2-secondary-note:      #f057a0;\n\t\t\t\t\t--mod2-primary-note:        #ffb8de;\n\t\t\t\t\t--mod3-secondary-channel:   #553399;\n\t\t\t\t\t--mod3-primary-channel:     #8855fc;\n\t\t\t\t\t--mod3-secondary-note:      #aa64ff;\n\t\t\t\t\t--mod3-primary-note:\t\t\t  #f8ddff;\n\t\t\t\t\t--mod4-secondary-channel:   #a86436;\n\t\t\t\t\t--mod4-primary-channel:     #c8a825;\n\t\t\t\t\t--mod4-secondary-note:      #e8ba46;\n\t\t\t\t\t--mod4-primary-note:        #fff6d3;\n\t\t\t\t\t--mod-label-primary:        #999;\n\t\t\t\t\t--mod-label-secondary-text: #333;\n\t\t\t\t\t--mod-label-primary-text:   black;\n\n\t\t\t\t}\n\t\t\t","dark competition":"\n\t\t\t\t:root {\n\t\t\t\t\t--page-margin: black;\n\t\t\t\t\t--editor-background: black;\n\t\t\t\t\t--hover-preview: #ddd;\n\t\t\t\t\t--playhead: #ddd;\n\t\t\t\t\t--primary-text: #ddd;\n\t\t\t\t\t--secondary-text: #8e695b;\n\t\t\t\t\t--inverted-text: black;\n\t\t\t\t\t--text-selection: rgba(169,0,255,0.99);\n\t\t\t\t\t--box-selection-fill: rgba(221,221,221,0.2);\n\t\t\t\t\t--loop-accent: #bf15ba;\n\t\t\t\t\t--link-accent: #f888ff;\n\t\t\t\t\t--ui-widget-background: #443a3a;\n\t\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t\t--pitch-background: #353333;\n\t\t\t\t\t--tonic: #884a44;\n\t\t\t\t\t--fifth-note: #415498;\n\t\t\t\t\t--white-piano-key: #bbb;\n\t\t\t\t\t--black-piano-key: #444;\n\t\t\t\t\t--use-color-formula: false;\n\t\t\t\t\t--track-editor-bg-pitch: #444;\n\t\t\t\t\t--track-editor-bg-pitch-dim: #333;\n\t\t\t\t\t--track-editor-bg-noise: #444;\n\t\t\t\t\t--track-editor-bg-noise-dim: #333;\n\t\t\t\t\t--track-editor-bg-mod: #234;\n\t\t\t\t\t--track-editor-bg-mod-dim: #123;\n\t\t\t\t\t--multiplicative-mod-slider: #456;\n\t\t\t\t\t--overwriting-mod-slider: #654;\n\t\t\t\t\t--indicator-primary: #74f;\n\t\t\t\t\t--indicator-secondary: #444;\n\t\t\t\t\t--select2-opt-group: #585858;\n\t\t\t\t\t--input-box-outline: #333;\n\t\t\t\t\t--mute-button-normal: #ffa033;\n\t\t\t\t\t--mute-button-mod: #9a6bff;\n\t\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t\t--pitch1-secondary-note:    #00bdc7;\n\t\t\t\t\t--pitch1-primary-note:      #92f9ff;\n\t\t\t\t\t--pitch2-secondary-channel: #a1a100;\n\t\t\t\t\t--pitch2-primary-channel:   #ffff25;\n\t\t\t\t\t--pitch2-secondary-note:    #c7c700;\n\t\t\t\t\t--pitch2-primary-note:      #ffff92;\n\t\t\t\t\t--pitch3-secondary-channel: #c75000;\n\t\t\t\t\t--pitch3-primary-channel:   #ff9752;\n\t\t\t\t\t--pitch3-secondary-note:    #ff771c;\n\t\t\t\t\t--pitch3-primary-note:      #ffcdab;\n\t\t\t\t\t--pitch4-secondary-channel: #00a100;\n\t\t\t\t\t--pitch4-primary-channel:   #50ff50;\n\t\t\t\t\t--pitch4-secondary-note:    #00c700;\n\t\t\t\t\t--pitch4-primary-note:      #a0ffa0;\n\t\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t\t--pitch5-primary-channel:   #ff90ff;\n\t\t\t\t\t--pitch5-secondary-note:    #e040e0;\n\t\t\t\t\t--pitch5-primary-note:      #ffc0ff;\n\t\t\t\t\t--pitch6-secondary-channel: #7777b0;\n\t\t\t\t\t--pitch6-primary-channel:   #a0a0ff;\n\t\t\t\t\t--pitch6-secondary-note:    #8888d0;\n\t\t\t\t\t--pitch6-primary-note:      #d0d0ff;\n\t\t\t\t\t--pitch7-secondary-channel: #8AA100;\n\t\t\t\t\t--pitch7-primary-channel:   #DEFF25;\n\t\t\t\t\t--pitch7-secondary-note:\t  #AAC700;\n\t\t\t\t\t--pitch7-primary-note:\t\t\t#E6FF92;\n\t\t\t\t\t--pitch8-secondary-channel: #DF0019;\n\t\t\t\t\t--pitch8-primary-channel:   #FF98A4;\n\t\t\t\t\t--pitch8-secondary-note:    #FF4E63;\n\t\t\t\t\t--pitch8-primary-note:      #FFB2BB;\n\t\t\t\t\t--pitch9-secondary-channel: #00A170;\n\t\t\t\t\t--pitch9-primary-channel:   #50FFC9;\n\t\t\t\t\t--pitch9-secondary-note:    #00C78A;\n\t\t\t\t\t--pitch9-primary-note:\t\t\t#83FFD9;\n\t\t\t\t\t--pitch10-secondary-channel:#A11FFF;\n\t\t\t\t\t--pitch10-primary-channel:  #CE8BFF;\n\t\t\t\t\t--pitch10-secondary-note:   #B757FF;\n\t\t\t\t\t--pitch10-primary-note:     #DFACFF;\n\t\t\t\t\t--noise1-secondary-channel: #6f6f6f;\n\t\t\t\t\t--noise1-primary-channel:   #aaaaaa;\n\t\t\t\t\t--noise1-secondary-note:    #a7a7a7;\n\t\t\t\t\t--noise1-primary-note:      #e0e0e0;\n\t\t\t\t\t--noise2-secondary-channel: #996633;\n\t\t\t\t\t--noise2-primary-channel:   #ddaa77;\n\t\t\t\t\t--noise2-secondary-note:    #cc9966;\n\t\t\t\t\t--noise2-primary-note:      #f0d0bb;\n\t\t\t\t\t--noise3-secondary-channel: #4a6d8f;\n\t\t\t\t\t--noise3-primary-channel:   #77aadd;\n\t\t\t\t\t--noise3-secondary-note:    #6f9fcf;\n\t\t\t\t\t--noise3-primary-note:      #bbd7ff;\n\t\t\t\t\t--noise4-secondary-channel: #6B3E8E;\n\t\t\t\t\t--noise4-primary-channel:   #AF82D2;\n\t\t\t\t\t--noise4-secondary-note:    #9E71C1;\n\t\t\t\t\t--noise4-primary-note:      #D4C1EA;\n          --mod1-secondary-channel:   #339955;\n\t\t\t\t\t--mod1-primary-channel:     #77fc55;\n\t\t\t\t\t--mod1-secondary-note:      #77ff8a;\n\t\t\t\t\t--mod1-primary-note:        #cdffee;\n\t\t\t\t\t--mod2-secondary-channel:   #993355;\n\t\t\t\t\t--mod2-primary-channel:     #f04960;\n\t\t\t\t\t--mod2-secondary-note:      #f057a0;\n\t\t\t\t\t--mod2-primary-note:        #ffb8de;\n\t\t\t\t\t--mod3-secondary-channel:   #553399;\n\t\t\t\t\t--mod3-primary-channel:     #8855fc;\n\t\t\t\t\t--mod3-secondary-note:      #aa64ff;\n\t\t\t\t\t--mod3-primary-note:\t\t\t  #f8ddff;\n\t\t\t\t\t--mod4-secondary-channel:   #a86436;\n\t\t\t\t\t--mod4-primary-channel:     #c8a825;\n\t\t\t\t\t--mod4-secondary-note:      #e8ba46;\n\t\t\t\t\t--mod4-primary-note:        #fff6d3;\n\t\t\t\t\t--mod-label-primary:        #999;\n\t\t\t\t\t--mod-label-secondary-text: #333;\n\t\t\t\t\t--mod-label-primary-text:   black;\n\n\t\t\t\t}\n\t\t\t","light classic":"\n\t\t\t\t:root {\n\t\t\t\t\t-webkit-text-stroke-width: 0.5px;\n\t\t\t\t\t--page-margin: #685d88;\n\t\t\t\t\t--editor-background: white;\n\t\t\t\t\t--hover-preview: black;\n\t\t\t\t\t--playhead: rgba(0,0,0,0.5);\n\t\t\t\t\t--primary-text: black;\n\t\t\t\t\t--secondary-text: #777;\n\t\t\t\t\t--inverted-text: white;\n\t\t\t\t\t--text-selection: rgba(200,170,255,0.99);\n\t\t\t\t\t--box-selection-fill: rgba(0,0,0,0.1);\n\t\t\t\t\t--loop-accent: #98f;\n\t\t\t\t\t--link-accent: #74f;\n\t\t\t\t\t--ui-widget-background: #ececec;\n\t\t\t\t\t--ui-widget-focus: #eee;\n\t\t\t\t\t--pitch-background: #ececec;\n\t\t\t\t\t--tonic: #f0d6b6;\n\t\t\t\t\t--fifth-note: #bbddf0;\n\t\t\t\t\t--white-piano-key: #eee;\n\t\t\t\t\t--black-piano-key: #666;\n\t\t\t\t\t--use-color-formula: false;\n\t\t\t\t\t--track-editor-bg-pitch: #ececec;\n\t\t\t\t\t--track-editor-bg-pitch-dim: #fdfdfd;\n\t\t\t\t\t--track-editor-bg-noise: #ececec;\n\t\t\t\t\t--track-editor-bg-noise-dim: #fdfdfd;\n\t\t\t\t\t--track-editor-bg-mod: #dbecfd;\n\t\t\t\t\t--track-editor-bg-mod-dim: #ecfdff;\n\t\t\t\t\t--multiplicative-mod-slider: #789;\n\t\t\t\t\t--overwriting-mod-slider: #987;\n\t\t\t\t\t--indicator-primary: #98f;\n\t\t\t\t\t--indicator-secondary: #cde;\n\t\t\t\t\t--select2-opt-group: #cecece;\n\t\t\t\t\t--input-box-outline: #ddd;\n\t\t\t\t\t--mute-button-normal: #c0b47f;\n\t\t\t\t\t--mute-button-mod: #bd7fc0;\n\t\t\t\t\t--pitch1-secondary-channel: #6CD9ED;\n\t\t\t\t\t--pitch1-primary-channel:   #00A0BD;\n\t\t\t\t\t--pitch1-secondary-note:    #34C2DC;\n\t\t\t\t\t--pitch1-primary-note:      #00758A;\n\t\t\t\t\t--pitch2-secondary-channel: #E3C941;\n\t\t\t\t\t--pitch2-primary-channel:   #B49700;\n\t\t\t\t\t--pitch2-secondary-note:    #D1B628;\n\t\t\t\t\t--pitch2-primary-note:      #836E00;\n\t\t\t\t\t--pitch3-secondary-channel: #FF9D61;\n\t\t\t\t\t--pitch3-primary-channel:   #E14E00;\n\t\t\t\t\t--pitch3-secondary-note:    #F67D3C;\n\t\t\t\t\t--pitch3-primary-note:      #B64000;\n\t\t\t\t\t--pitch4-secondary-channel: #4BE24B;\n\t\t\t\t\t--pitch4-primary-channel:   #00A800;\n\t\t\t\t\t--pitch4-secondary-note:    #2DC82D;\n\t\t\t\t\t--pitch4-primary-note:      #008000;\n\t\t\t\t\t--pitch5-secondary-channel: #FF90FF;\n\t\t\t\t\t--pitch5-primary-channel:   #E12EDF;\n\t\t\t\t\t--pitch5-secondary-note:    #EC6EEC;\n\t\t\t\t\t--pitch5-primary-note:      #A600A5;\n\t\t\t\t\t--pitch6-secondary-channel: #B5B5FE;\n\t\t\t\t\t--pitch6-primary-channel:   #6969FD;\n\t\t\t\t\t--pitch6-secondary-note:    #9393FE;\n\t\t\t\t\t--pitch6-primary-note:      #4A4AD7;\n\t\t\t\t\t--pitch7-secondary-channel: #CBE24B;\n\t\t\t\t\t--pitch7-primary-channel:   #8EA800;\n\t\t\t\t\t--pitch7-secondary-note:    #B0C82D;\n\t\t\t\t\t--pitch7-primary-note:      #6C8000;\n\t\t\t\t\t--pitch8-secondary-channel: #FF90A4;\n\t\t\t\t\t--pitch8-primary-channel:   #E12E4D;\n\t\t\t\t\t--pitch8-secondary-note:    #EC6E85;\n\t\t\t\t\t--pitch8-primary-note:      #A6001D;\n\t\t\t\t\t--pitch9-secondary-channel: #41E3B5;\n\t\t\t\t\t--pitch9-primary-channel:   #00B481;\n\t\t\t\t\t--pitch9-secondary-note:    #28D1A1;\n\t\t\t\t\t--pitch9-primary-note:      #00835E;\n\t\t\t\t\t--pitch10-secondary-channel:#CA77FF;\n\t\t\t\t\t--pitch10-primary-channel:  #9609FF;\n\t\t\t\t\t--pitch10-secondary-note:   #B54FFF;\n\t\t\t\t\t--pitch10-primary-note:     #8400E3;\n\t\t\t\t\t--noise1-secondary-channel: #C1C1C1;\n\t\t\t\t\t--noise1-primary-channel:   #898989;\n\t\t\t\t\t--noise1-secondary-note:    #ADADAD;\n\t\t\t\t\t--noise1-primary-note:      #6C6C6C;\n\t\t\t\t\t--noise2-secondary-channel: #E8BB8C;\n\t\t\t\t\t--noise2-primary-channel:   #BD7D3A;\n\t\t\t\t\t--noise2-secondary-note:    #D1A374;\n\t\t\t\t\t--noise2-primary-note:      #836342;\n\t\t\t\t\t--noise3-secondary-channel: #9BC4EB;\n\t\t\t\t\t--noise3-primary-channel:   #4481BE;\n\t\t\t\t\t--noise3-secondary-note:    #7CA7D3;\n\t\t\t\t\t--noise3-primary-note:      #476685;\n\t\t\t\t\t--noise4-secondary-channel: #C5A5E0;\n\t\t\t\t\t--noise4-primary-channel:   #8553AE;\n\t\t\t\t\t--noise4-secondary-note:    #AB87C8;\n\t\t\t\t\t--noise4-primary-note:      #684F7D;\n\t\t\t\t\t--mod1-secondary-channel:   #339955;\n\t\t\t\t\t--mod1-primary-channel:     #77dd55;\n\t\t\t\t\t--mod1-secondary-note:      #77ff8a;\n\t\t\t\t\t--mod1-primary-note:        #2ad84a;\n\t\t\t\t\t--mod2-secondary-channel:   #993355;\n\t\t\t\t\t--mod2-primary-channel:     #f04960;\n\t\t\t\t\t--mod2-secondary-note:      #f057a0;\n\t\t\t\t\t--mod2-primary-note:        #ba124a;\n\t\t\t\t\t--mod3-secondary-channel:   #553399;\n\t\t\t\t\t--mod3-primary-channel:     #8855fc;\n\t\t\t\t\t--mod3-secondary-note:      #aa64ff;\n\t\t\t\t\t--mod3-primary-note:        #7a1caa;\n\t\t\t\t\t--mod4-secondary-channel:   #a86436;\n\t\t\t\t\t--mod4-primary-channel:     #c8a825;\n\t\t\t\t\t--mod4-secondary-note:      #e8ba46;\n\t\t\t\t\t--mod4-primary-note:        #a86810;\n\t\t\t\t\t--mod-label-primary:        #dddddd;\n\t\t\t\t\t--mod-label-secondary-text: #777;\n\t\t\t\t\t--mod-label-primary-text:   black;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.beepboxEditor button, .beepboxEditor select {\n\t\t\t\t\tbox-shadow: inset 0 0 0 1px var(--secondary-text);\n\t\t\t\t}\n\n\t\t\t\t.select2-selection__rendered {\n\t\t\t\t\tbox-shadow: inset 0 0 0 1px var(--secondary-text);\n\t\t\t\t}\n\t\t\t","jummbox classic":"\n\t\t\t\t:root {\n\t\t\t\t\t--page-margin: #040410;\n\t\t\t\t\t--editor-background: #040410;\n\t\t\t\t\t--hover-preview: white;\n\t\t\t\t\t--playhead: rgba(255, 255, 255, 0.9);\n\t\t\t\t\t--primary-text: white;\n\t\t\t\t\t--secondary-text: #84859a;\n\t\t\t\t\t--inverted-text: black;\n\t\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t\t--box-selection-fill: #044b94;\n\t\t\t\t\t--loop-accent: #74f;\n\t\t\t\t\t--link-accent: #98f;\n\t\t\t\t\t--ui-widget-background: #393e4f;\n\t\t\t\t\t--ui-widget-focus: #6d6886;\n\t\t\t\t\t--pitch-background: #393e4f;\n\t\t\t\t\t--tonic: #725491;\n\t\t\t\t\t--fifth-note: #54547a;\n\t\t\t\t\t--white-piano-key: #eee;\n\t\t\t\t\t--black-piano-key: #666;\n\t\t\t\t\t--use-color-formula: true;\n\t\t\t\t\t--track-editor-bg-pitch: #393e4f;\n\t\t\t\t\t--track-editor-bg-pitch-dim: #1c1d28;\n\t\t\t\t\t--track-editor-bg-noise: #3d3535;\n\t\t\t\t\t--track-editor-bg-noise-dim: #161313;\n\t\t\t\t\t--track-editor-bg-mod: #283560;\n\t\t\t\t\t--track-editor-bg-mod-dim: #0a101f;\n\t\t\t\t\t--multiplicative-mod-slider: #606c9f;\n\t\t\t\t\t--overwriting-mod-slider: #6850b5;\n\t\t\t\t\t--indicator-primary: #9c64f7;\n\t\t\t\t\t--indicator-secondary: #393e4f;\n\t\t\t\t\t--select2-opt-group: #5d576f;\n\t\t\t\t\t--input-box-outline: #222;\n\t\t\t\t\t--mute-button-normal: #dda85d;\n\t\t\t\t\t--mute-button-mod: #886eae;\n\t\t\t\t\t--mod-label-primary: #282840;\n\t\t\t\t\t--mod-label-secondary-text: rgb(87, 86, 120);\n\t\t\t\t\t--mod-label-primary-text: white;\n\t\t\t\t\t--pitch-secondary-channel-hue: 0;\n\t\t\t\t\t--pitch-secondary-channel-hue-scale: 6.1;\n\t\t\t\t\t--pitch-secondary-channel-sat: 83.3;\n\t\t\t\t\t--pitch-secondary-channel-sat-scale: 0.1;\n\t\t\t\t\t--pitch-secondary-channel-lum: 40;\n\t\t\t\t\t--pitch-secondary-channel-lum-scale: 0.05;\n\t\t\t\t\t--pitch-primary-channel-hue: 0;\n\t\t\t\t\t--pitch-primary-channel-hue-scale: 6.1;\n\t\t\t\t\t--pitch-primary-channel-sat: 100;\n\t\t\t\t\t--pitch-primary-channel-sat-scale: 0.1;\n\t\t\t\t\t--pitch-primary-channel-lum: 67.5;\n\t\t\t\t\t--pitch-primary-channel-lum-scale: 0.05;\n\t\t\t\t\t--pitch-secondary-note-hue: 0;\n\t\t\t\t\t--pitch-secondary-note-hue-scale: 6.1;\n\t\t\t\t\t--pitch-secondary-note-sat: 93.9;\n\t\t\t\t\t--pitch-secondary-note-sat-scale: 0.1;\n\t\t\t\t\t--pitch-secondary-note-lum: 25;\n\t\t\t\t\t--pitch-secondary-note-lum-scale: 0.05;\n\t\t\t\t\t--pitch-primary-note-hue: 0;\n\t\t\t\t\t--pitch-primary-note-hue-scale: 6.1;\n\t\t\t\t\t--pitch-primary-note-sat: 100;\n\t\t\t\t\t--pitch-primary-note-sat-scale: 0.05;\n\t\t\t\t\t--pitch-primary-note-lum: 85.6;\n\t\t\t\t\t--pitch-primary-note-lum-scale: 0.025;\n\t\t\t\t\t--noise-secondary-channel-hue: 0;\n\t\t\t\t\t--noise-secondary-channel-hue-scale: 2;\n\t\t\t\t\t--noise-secondary-channel-sat: 25;\n\t\t\t\t\t--noise-secondary-channel-sat-scale: 0;\n\t\t\t\t\t--noise-secondary-channel-lum: 42;\n\t\t\t\t\t--noise-secondary-channel-lum-scale: 0;\n\t\t\t\t\t--noise-primary-channel-hue: 0;\n\t\t\t\t\t--noise-primary-channel-hue-scale: 2;\n\t\t\t\t\t--noise-primary-channel-sat: 33;\n\t\t\t\t\t--noise-primary-channel-sat-scale: 0;\n\t\t\t\t\t--noise-primary-channel-lum: 63.5;\n\t\t\t\t\t--noise-primary-channel-lum-scale: 0;\n\t\t\t\t\t--noise-secondary-note-hue: 0;\n\t\t\t\t\t--noise-secondary-note-hue-scale: 2;\n\t\t\t\t\t--noise-secondary-note-sat: 33.5;\n\t\t\t\t\t--noise-secondary-note-sat-scale: 0;\n\t\t\t\t\t--noise-secondary-note-lum: 55;\n\t\t\t\t\t--noise-secondary-note-lum-scale: 0;\n\t\t\t\t\t--noise-primary-note-hue: 0;\n\t\t\t\t\t--noise-primary-note-hue-scale: 2;\n\t\t\t\t\t--noise-primary-note-sat: 46.5;\n\t\t\t\t\t--noise-primary-note-sat-scale: 0;\n\t\t\t\t\t--noise-primary-note-lum: 74;\n\t\t\t\t\t--noise-primary-note-lum-scale: 0;\n\t\t\t\t\t--mod-secondary-channel-hue: 192;\n\t\t\t\t\t--mod-secondary-channel-hue-scale: 1.5;\n\t\t\t\t\t--mod-secondary-channel-sat: 88;\n\t\t\t\t\t--mod-secondary-channel-sat-scale: 0;\n\t\t\t\t\t--mod-secondary-channel-lum: 50;\n\t\t\t\t\t--mod-secondary-channel-lum-scale: 0;\n\t\t\t\t\t--mod-primary-channel-hue: 192;\n\t\t\t\t\t--mod-primary-channel-hue-scale: 1.5;\n\t\t\t\t\t--mod-primary-channel-sat: 96;\n\t\t\t\t\t--mod-primary-channel-sat-scale: 0;\n\t\t\t\t\t--mod-primary-channel-lum: 80;\n\t\t\t\t\t--mod-primary-channel-lum-scale: 0;\n\t\t\t\t\t--mod-secondary-note-hue: 192;\n\t\t\t\t\t--mod-secondary-note-hue-scale: 1.5;\n\t\t\t\t\t--mod-secondary-note-sat: 92;\n\t\t\t\t\t--mod-secondary-note-sat-scale: 0;\n\t\t\t\t\t--mod-secondary-note-lum: 45;\n\t\t\t\t\t--mod-secondary-note-lum-scale: 0;\n\t\t\t\t\t--mod-primary-note-hue: 192;\n\t\t\t\t\t--mod-primary-note-hue-scale: 1.5;\n\t\t\t\t\t--mod-primary-note-sat: 96;\n\t\t\t\t\t--mod-primary-note-sat-scale: 0;\n\t\t\t\t\t--mod-primary-note-lum: 85;\n\t\t\t\t\t--mod-primary-note-lum-scale: 0;\n\t\t\t\t}\n\t\t\t",forest:"\n\t\t\t\t:root {\n\t\t\t\t\t--page-margin: #010c03;\n\t\t\t\t\t--editor-background: #010c03;\n\t\t\t\t\t--hover-preview: #efe;\n\t\t\t\t\t--playhead: rgba(232, 255, 232, 0.9);\n\t\t\t\t\t--primary-text: #efe;\n\t\t\t\t\t--secondary-text: #70A070;\n\t\t\t\t\t--inverted-text: #280228;\n\t\t\t\t\t--text-selection: rgba(255,68,199,0.99);\n\t\t\t\t\t--box-selection-fill: #267aa3;\n\t\t\t\t\t--loop-accent: #ffe845;\n\t\t\t\t\t--link-accent: #9f8;\n\t\t\t\t\t--ui-widget-background: #203829;\n\t\t\t\t\t--ui-widget-focus: #487860;\n\t\t\t\t\t--pitch-background: #203829;\n\t\t\t\t\t--tonic: #2b8d20;\n\t\t\t\t\t--fifth-note: #385840;\n\t\t\t\t\t--white-piano-key: #bda;\n\t\t\t\t\t--black-piano-key: #573;\n\t\t\t\t\t--use-color-formula: true;\n\t\t\t\t\t--track-editor-bg-pitch: #254820;\n\t\t\t\t\t--track-editor-bg-pitch-dim: #102819;\n\t\t\t\t\t--track-editor-bg-noise: #304050;\n\t\t\t\t\t--track-editor-bg-noise-dim: #102030;\n\t\t\t\t\t--track-editor-bg-mod: #506030;\n\t\t\t\t\t--track-editor-bg-mod-dim: #2a300a;\n\t\t\t\t\t--multiplicative-mod-slider: #205c8f;\n\t\t\t\t\t--overwriting-mod-slider: #20ac6f;\n\t\t\t\t\t--indicator-primary: #dcd866;\n\t\t\t\t\t--indicator-secondary: #203829;\n\t\t\t\t\t--select2-opt-group: #1a6f5a;\n\t\t\t\t\t--input-box-outline: #242;\n\t\t\t\t\t--mute-button-normal: #49e980;\n\t\t\t\t\t--mute-button-mod: #c2e502;\n\t\t\t\t\t--mod-label-primary: #133613;\n\t\t\t\t\t--mod-label-secondary-text: rgb(27, 126, 40);\n\t\t\t\t\t--mod-label-primary-text: #efe;\n\t\t\t\t\t--pitch-secondary-channel-hue: 120;\n\t\t\t\t\t--pitch-secondary-channel-hue-scale: 8.1;\n\t\t\t\t\t--pitch-secondary-channel-sat: 59;\n\t\t\t\t\t--pitch-secondary-channel-sat-scale: 0.1;\n\t\t\t\t\t--pitch-secondary-channel-lum: 50;\n\t\t\t\t\t--pitch-secondary-channel-lum-scale: 0.04;\n\t\t\t\t\t--pitch-primary-channel-hue: 120;\n\t\t\t\t\t--pitch-primary-channel-hue-scale: 8.1;\n\t\t\t\t\t--pitch-primary-channel-sat: 86;\n\t\t\t\t\t--pitch-primary-channel-sat-scale: 0.1;\n\t\t\t\t\t--pitch-primary-channel-lum: 70;\n\t\t\t\t\t--pitch-primary-channel-lum-scale: 0.04;\n\t\t\t\t\t--pitch-secondary-note-hue: 120;\n\t\t\t\t\t--pitch-secondary-note-hue-scale: 8.1;\n\t\t\t\t\t--pitch-secondary-note-sat: 85;\n\t\t\t\t\t--pitch-secondary-note-sat-scale: 0.1;\n\t\t\t\t\t--pitch-secondary-note-lum: 30;\n\t\t\t\t\t--pitch-secondary-note-lum-scale: 0.04;\n\t\t\t\t\t--pitch-primary-note-hue: 120;\n\t\t\t\t\t--pitch-primary-note-hue-scale: 8.1;\n\t\t\t\t\t--pitch-primary-note-sat: 90;\n\t\t\t\t\t--pitch-primary-note-sat-scale: 0.05;\n\t\t\t\t\t--pitch-primary-note-lum: 80;\n\t\t\t\t\t--pitch-primary-note-lum-scale: 0.025;\n\t\t\t\t\t--noise-secondary-channel-hue: 200;\n\t\t\t\t\t--noise-secondary-channel-hue-scale: 1.1;\n\t\t\t\t\t--noise-secondary-channel-sat: 25;\n\t\t\t\t\t--noise-secondary-channel-sat-scale: 0;\n\t\t\t\t\t--noise-secondary-channel-lum: 22;\n\t\t\t\t\t--noise-secondary-channel-lum-scale: 0;\n\t\t\t\t\t--noise-primary-channel-hue: 200;\n\t\t\t\t\t--noise-primary-channel-hue-scale: 1.1;\n\t\t\t\t\t--noise-primary-channel-sat: 48;\n\t\t\t\t\t--noise-primary-channel-sat-scale: 0;\n\t\t\t\t\t--noise-primary-channel-lum: 65;\n\t\t\t\t\t--noise-primary-channel-lum-scale: 0;\n\t\t\t\t\t--noise-secondary-note-hue: 200;\n\t\t\t\t\t--noise-secondary-note-hue-scale: 1.1;\n\t\t\t\t\t--noise-secondary-note-sat: 33.5;\n\t\t\t\t\t--noise-secondary-note-sat-scale: 0;\n\t\t\t\t\t--noise-secondary-note-lum: 33;\n\t\t\t\t\t--noise-secondary-note-lum-scale: 0;\n\t\t\t\t\t--noise-primary-note-hue: 200;\n\t\t\t\t\t--noise-primary-note-hue-scale: 1.1;\n\t\t\t\t\t--noise-primary-note-sat: 46.5;\n\t\t\t\t\t--noise-primary-note-sat-scale: 0;\n\t\t\t\t\t--noise-primary-note-lum: 64;\n\t\t\t\t\t--noise-primary-note-lum-scale: 0;\n\t\t\t\t\t--mod-secondary-channel-hue: 40;\n\t\t\t\t\t--mod-secondary-channel-hue-scale: 1.8;\n\t\t\t\t\t--mod-secondary-channel-sat: 44;\n\t\t\t\t\t--mod-secondary-channel-sat-scale: 0;\n\t\t\t\t\t--mod-secondary-channel-lum: 50;\n\t\t\t\t\t--mod-secondary-channel-lum-scale: 0;\n\t\t\t\t\t--mod-primary-channel-hue: 40;\n\t\t\t\t\t--mod-primary-channel-hue-scale: 1.8;\n\t\t\t\t\t--mod-primary-channel-sat: 60;\n\t\t\t\t\t--mod-primary-channel-sat-scale: 0;\n\t\t\t\t\t--mod-primary-channel-lum: 80;\n\t\t\t\t\t--mod-primary-channel-lum-scale: 0;\n\t\t\t\t\t--mod-secondary-note-hue: 40;\n\t\t\t\t\t--mod-secondary-note-hue-scale: 1.8;\n\t\t\t\t\t--mod-secondary-note-sat: 62;\n\t\t\t\t\t--mod-secondary-note-sat-scale: 0;\n\t\t\t\t\t--mod-secondary-note-lum: 55;\n\t\t\t\t\t--mod-secondary-note-lum-scale: 0;\n\t\t\t\t\t--mod-primary-note-hue: 40;\n\t\t\t\t\t--mod-primary-note-hue-scale: 1.8;\n\t\t\t\t\t--mod-primary-note-sat: 66;\n\t\t\t\t\t--mod-primary-note-sat-scale: 0;\n\t\t\t\t\t--mod-primary-note-lum: 85;\n\t\t\t\t\t--mod-primary-note-lum-scale: 0;\n\t\t\t\t}\n\t\t\t",canyon:"\n\t\t\t\t:root {\n\t\t\t\t\t--page-margin: #0a0000;\n\t\t\t\t\t--editor-background: #0a0000;\n\t\t\t\t\t--hover-preview: white;\n\t\t\t\t\t--playhead: rgba(247, 172, 196, 0.9);\n\t\t\t\t\t--primary-text: #f5d6bf;\n\t\t\t\t\t--secondary-text: #934050;\n\t\t\t\t\t--inverted-text: #290505;\n\t\t\t\t\t--text-selection: rgba(255, 208, 68, 0.99);\n\t\t\t\t\t--box-selection-fill: #94044870;\n\t\t\t\t\t--loop-accent: #ff1e1e;\n\t\t\t\t\t--link-accent: #da7b76;\n\t\t\t\t\t--ui-widget-background: #533137;\n\t\t\t\t\t--ui-widget-focus: #743e4b;\n\t\t\t\t\t--pitch-background: #4f3939;\n\t\t\t\t\t--tonic: #9e4145;\n\t\t\t\t\t--fifth-note: #5b3e6b;\n\t\t\t\t\t--white-piano-key: #d89898;\n\t\t\t\t\t--black-piano-key: #572b29;\n\t\t\t\t\t--use-color-formula: true;\n\t\t\t\t\t--track-editor-bg-pitch: #5e3a41;\n\t\t\t\t\t--track-editor-bg-pitch-dim: #281d1c;\n\t\t\t\t\t--track-editor-bg-noise: #3a3551;\n\t\t\t\t\t--track-editor-bg-noise-dim: #272732;\n\t\t\t\t\t--track-editor-bg-mod: #552045;\n\t\t\t\t\t--track-editor-bg-mod-dim: #3e1442;\n\t\t\t\t\t--multiplicative-mod-slider: #9f6095;\n\t\t\t\t\t--overwriting-mod-slider: #b55050;\n\t\t\t\t\t--indicator-primary: #f2f764;\n\t\t\t\t\t--indicator-secondary: #4f3939;\n\t\t\t\t\t--select2-opt-group: #673030;\n\t\t\t\t\t--input-box-outline: #443131;\n\t\t\t\t\t--mute-button-normal: #d81833;\n\t\t\t\t\t--mute-button-mod: #9e2691;\n\t\t\t\t\t--mod-label-primary: #5f2b39;\n\t\t\t\t\t--mod-label-secondary-text: rgb(158, 66, 122);\n\t\t\t\t\t--mod-label-primary-text: #e6caed;\n\t\t\t\t\t--pitch-secondary-channel-hue: 0;\n\t\t\t\t\t--pitch-secondary-channel-hue-scale: 11.8;\n\t\t\t\t\t--pitch-secondary-channel-sat: 73.3;\n\t\t\t\t\t--pitch-secondary-channel-sat-scale: 0.1;\n\t\t\t\t\t--pitch-secondary-channel-lum: 40;\n\t\t\t\t\t--pitch-secondary-channel-lum-scale: 0.05;\n\t\t\t\t\t--pitch-primary-channel-hue: 0;\n\t\t\t\t\t--pitch-primary-channel-hue-scale: 11.8;\n\t\t\t\t\t--pitch-primary-channel-sat: 90;\n\t\t\t\t\t--pitch-primary-channel-sat-scale: 0.1;\n\t\t\t\t\t--pitch-primary-channel-lum: 67.5;\n\t\t\t\t\t--pitch-primary-channel-lum-scale: 0.05;\n\t\t\t\t\t--pitch-secondary-note-hue: 0;\n\t\t\t\t\t--pitch-secondary-note-hue-scale: 11.8;\n\t\t\t\t\t--pitch-secondary-note-sat: 83.9;\n\t\t\t\t\t--pitch-secondary-note-sat-scale: 0.1;\n\t\t\t\t\t--pitch-secondary-note-lum: 35;\n\t\t\t\t\t--pitch-secondary-note-lum-scale: 0.05;\n\t\t\t\t\t--pitch-primary-note-hue: 0;\n\t\t\t\t\t--pitch-primary-note-hue-scale: 11.8;\n\t\t\t\t\t--pitch-primary-note-sat: 100;\n\t\t\t\t\t--pitch-primary-note-sat-scale: 0.05;\n\t\t\t\t\t--pitch-primary-note-lum: 85.6;\n\t\t\t\t\t--pitch-primary-note-lum-scale: 0.025;\n\t\t\t\t\t--noise-secondary-channel-hue: 60;\n\t\t\t\t\t--noise-secondary-channel-hue-scale: 2;\n\t\t\t\t\t--noise-secondary-channel-sat: 25;\n\t\t\t\t\t--noise-secondary-channel-sat-scale: 0;\n\t\t\t\t\t--noise-secondary-channel-lum: 42;\n\t\t\t\t\t--noise-secondary-channel-lum-scale: 0;\n\t\t\t\t\t--noise-primary-channel-hue: 60;\n\t\t\t\t\t--noise-primary-channel-hue-scale: 2;\n\t\t\t\t\t--noise-primary-channel-sat: 33;\n\t\t\t\t\t--noise-primary-channel-sat-scale: 0;\n\t\t\t\t\t--noise-primary-channel-lum: 63.5;\n\t\t\t\t\t--noise-primary-channel-lum-scale: 0;\n\t\t\t\t\t--noise-secondary-note-hue: 60;\n\t\t\t\t\t--noise-secondary-note-hue-scale: 2;\n\t\t\t\t\t--noise-secondary-note-sat: 33.5;\n\t\t\t\t\t--noise-secondary-note-sat-scale: 0;\n\t\t\t\t\t--noise-secondary-note-lum: 55;\n\t\t\t\t\t--noise-secondary-note-lum-scale: 0;\n\t\t\t\t\t--noise-primary-note-hue: 60;\n\t\t\t\t\t--noise-primary-note-hue-scale: 2;\n\t\t\t\t\t--noise-primary-note-sat: 46.5;\n\t\t\t\t\t--noise-primary-note-sat-scale: 0;\n\t\t\t\t\t--noise-primary-note-lum: 74;\n\t\t\t\t\t--noise-primary-note-lum-scale: 0;\n\t\t\t\t\t--mod-secondary-channel-hue: 222;\n\t\t\t\t\t--mod-secondary-channel-hue-scale: 1.5;\n\t\t\t\t\t--mod-secondary-channel-sat: 88;\n\t\t\t\t\t--mod-secondary-channel-sat-scale: 0;\n\t\t\t\t\t--mod-secondary-channel-lum: 50;\n\t\t\t\t\t--mod-secondary-channel-lum-scale: 0;\n\t\t\t\t\t--mod-primary-channel-hue: 222;\n\t\t\t\t\t--mod-primary-channel-hue-scale: 1.5;\n\t\t\t\t\t--mod-primary-channel-sat: 96;\n\t\t\t\t\t--mod-primary-channel-sat-scale: 0;\n\t\t\t\t\t--mod-primary-channel-lum: 80;\n\t\t\t\t\t--mod-primary-channel-lum-scale: 0;\n\t\t\t\t\t--mod-secondary-note-hue: 222;\n\t\t\t\t\t--mod-secondary-note-hue-scale: 1.5;\n\t\t\t\t\t--mod-secondary-note-sat: 92;\n\t\t\t\t\t--mod-secondary-note-sat-scale: 0;\n\t\t\t\t\t--mod-secondary-note-lum: 54;\n\t\t\t\t\t--mod-secondary-note-lum-scale: 0;\n\t\t\t\t\t--mod-primary-note-hue: 222;\n\t\t\t\t\t--mod-primary-note-hue-scale: 1.5;\n\t\t\t\t\t--mod-primary-note-sat: 96;\n\t\t\t\t\t--mod-primary-note-sat-scale: 0;\n\t\t\t\t\t--mod-primary-note-lum: 75;\n\t\t\t\t\t--mod-primary-note-lum-scale: 0;\n\t\t\t\t}\n\t\t\t",midnight:"\n\t\t:root {\n\t\t\t--page-margin: #000;\n\t\t\t--editor-background: #000;\n\t\t\t--hover-preview: #757575;\n\t\t\t--playhead: #fff;\n\t\t\t--primary-text: #fff;\n\t\t\t--secondary-text: #acacac;\n\t\t\t--inverted-text: #290505;\n\t\t\t--text-selection: rgba(155, 155, 155, 0.99);\n\t\t\t--box-selection-fill: #79797970;\n\t\t\t--loop-accent: #646464;\n\t\t\t--link-accent: #707070;\n\t\t\t--ui-widget-background: #353535;\n\t\t\t--ui-widget-focus: #464646;\n\t\t\t--pitch-background: #222121;\n\t\t\t--tonic: #1a1818;\n\t\t\t--fifth-note: #555955;\n\t\t\t--white-piano-key: #a89e9e;\n\t\t\t--black-piano-key: #2d2424;\n\t\t\t--use-color-formula: true;\n\t\t\t--track-editor-bg-pitch: #373737;\n\t\t\t--track-editor-bg-pitch-dim: #131313;\n\t\t\t--track-editor-bg-noise: #484848;\n\t\t\t--track-editor-bg-noise-dim: #131313;\n\t\t\t--track-editor-bg-mod: #373737;\n\t\t\t--track-editor-bg-mod-dim: #131313;\n\t\t\t--multiplicative-mod-slider: #555;\n\t\t\t--overwriting-mod-slider: #464545;\n\t\t\t--indicator-primary: #e0e0e0;\n\t\t\t--indicator-secondary: #404040;\n\t\t\t--select2-opt-group: #3c3b3b;\n\t\t\t--input-box-outline: #757575;\n\t\t\t--mute-button-normal: #8e8d8d;\n\t\t\t--mute-button-mod: #ddd;\n\t\t\t--mod-label-primary: #262526;\n\t\t\t--mod-label-secondary-text: rgb(227, 222, 225);\n\t\t\t--mod-label-primary-text: #b9b9b9;\n\t\t\t--pitch-secondary-channel-hue: 240;\n\t\t\t--pitch-secondary-channel-hue-scale: 228;\n\t\t\t--pitch-secondary-channel-sat: 73.3;\n\t\t\t--pitch-secondary-channel-sat-scale: 0.1;\n\t\t\t--pitch-secondary-channel-lum: 25;\n\t\t\t--pitch-secondary-channel-lum-scale: 0.05;\n\t\t\t--pitch-primary-channel-hue: 240;\n\t\t\t--pitch-primary-channel-hue-scale: 228;\n\t\t\t--pitch-primary-channel-sat: 80;\n\t\t\t--pitch-primary-channel-sat-scale: 0.1;\n\t\t\t--pitch-primary-channel-lum: 60.5;\n\t\t\t--pitch-primary-channel-lum-scale: 0.05;\n\t\t\t--pitch-secondary-note-hue: 240;\n\t\t\t--pitch-secondary-note-hue-scale: 228;\n\t\t\t--pitch-secondary-note-sat: 73.9;\n\t\t\t--pitch-secondary-note-sat-scale: 0.1;\n\t\t\t--pitch-secondary-note-lum: 32;\n\t\t\t--pitch-secondary-note-lum-scale: 0.05;\n\t\t\t--pitch-primary-note-hue: 240;\n\t\t\t--pitch-primary-note-hue-scale: 228;\n\t\t\t--pitch-primary-note-sat: 90;\n\t\t\t--pitch-primary-note-sat-scale: 0.05;\n\t\t\t--pitch-primary-note-lum: 80.6;\n\t\t\t--pitch-primary-note-lum-scale: 0.025;\n\t\t\t--noise-secondary-channel-hue: 160;\n\t\t\t--noise-secondary-channel-hue-scale: 2;\n\t\t\t--noise-secondary-channel-sat: 25;\n\t\t\t--noise-secondary-channel-sat-scale: 0;\n\t\t\t--noise-secondary-channel-lum: 42;\n\t\t\t--noise-secondary-channel-lum-scale: 0;\n\t\t\t--noise-primary-channel-hue: 160;\n\t\t\t--noise-primary-channel-hue-scale: 2;\n\t\t\t--noise-primary-channel-sat: 33;\n\t\t\t--noise-primary-channel-sat-scale: 0;\n\t\t\t--noise-primary-channel-lum: 63.5;\n\t\t\t--noise-primary-channel-lum-scale: 0;\n\t\t\t--noise-secondary-note-hue: 160;\n\t\t\t--noise-secondary-note-hue-scale: 2;\n\t\t\t--noise-secondary-note-sat: 33.5;\n\t\t\t--noise-secondary-note-sat-scale: 0;\n\t\t\t--noise-secondary-note-lum: 55;\n\t\t\t--noise-secondary-note-lum-scale: 0;\n\t\t\t--noise-primary-note-hue: 160;\n\t\t\t--noise-primary-note-hue-scale: 2;\n\t\t\t--noise-primary-note-sat: 46.5;\n\t\t\t--noise-primary-note-sat-scale: 0;\n\t\t\t--noise-primary-note-lum: 74;\n\t\t\t--noise-primary-note-lum-scale: 0;\n\t\t\t--mod-secondary-channel-hue: 62;\n\t\t\t--mod-secondary-channel-hue-scale: 1.5;\n\t\t\t--mod-secondary-channel-sat: 88;\n\t\t\t--mod-secondary-channel-sat-scale: 0;\n\t\t\t--mod-secondary-channel-lum: 30;\n\t\t\t--mod-secondary-channel-lum-scale: 0;\n\t\t\t--mod-primary-channel-hue: 62;\n\t\t\t--mod-primary-channel-hue-scale: 1.5;\n\t\t\t--mod-primary-channel-sat: 96;\n\t\t\t--mod-primary-channel-sat-scale: 0;\n\t\t\t--mod-primary-channel-lum: 80;\n\t\t\t--mod-primary-channel-lum-scale: 0;\n\t\t\t--mod-secondary-note-hue: 62;\n\t\t\t--mod-secondary-note-hue-scale: 1.5;\n\t\t\t--mod-secondary-note-sat: 92;\n\t\t\t--mod-secondary-note-sat-scale: 0;\n\t\t\t--mod-secondary-note-lum: 34;\n\t\t\t--mod-secondary-note-lum-scale: 0;\n\t\t\t--mod-primary-note-hue: 62;\n\t\t\t--mod-primary-note-hue-scale: 1.5;\n\t\t\t--mod-primary-note-sat: 96;\n\t\t\t--mod-primary-note-sat-scale: 0;\n\t\t\t--mod-primary-note-lum: 75;\n\t\t\t--mod-primary-note-lum-scale: 0;\n\t\t}\n\t","jummbox light":"\n\t\t\t\t:root {\n\t\t\t\t\t-webkit-text-stroke-width: 0.5px;\n\t\t\t\t\t--page-margin: #fefdff;\n\t\t\t\t\t--editor-background: #fefdff;\n\t\t\t\t\t--hover-preview: #302880;\n\t\t\t\t\t--playhead: rgba(62, 32, 120, 0.9);\n\t\t\t\t\t--primary-text: #401890;\n\t\t\t\t\t--secondary-text: #8769af;\n\t\t\t\t\t--inverted-text: #fefdff;\n\t\t\t\t\t--text-selection: rgba(255,160,235,0.99);\n\t\t\t\t\t--box-selection-fill: rgba(30,62,220,0.5);\n\t\t\t\t\t--loop-accent: #4c35d4;\n\t\t\t\t\t--link-accent: #7af;\n\t\t\t\t\t--ui-widget-background: #bf9cec;\n\t\t\t\t\t--ui-widget-focus: #e9c4ff;\n\t\t\t\t\t--pitch-background: #e2d9f9;\n\t\t\t\t\t--tonic: #c288cc;\n\t\t\t\t\t--fifth-note: #d8c9fd;\n\t\t\t\t\t--white-piano-key: #e2e2ff;\n\t\t\t\t\t--black-piano-key: #66667a;\n\t\t\t\t\t--use-color-formula: true;\n\t\t\t\t\t--track-editor-bg-pitch: #d9e5ec;\n\t\t\t\t\t--track-editor-bg-pitch-dim: #eaeef5;\n\t\t\t\t\t--track-editor-bg-noise: #ffc3ae;\n\t\t\t\t\t--track-editor-bg-noise-dim: #ffe0cf;\n\t\t\t\t\t--track-editor-bg-mod: #c9accc;\n\t\t\t\t\t--track-editor-bg-mod-dim: #ebe3ef;\n\t\t\t\t\t--multiplicative-mod-slider: #807caf;\n\t\t\t\t\t--overwriting-mod-slider: #909cdf;\n\t\t\t\t\t--indicator-primary: #ae38ff;\n\t\t\t\t\t--indicator-secondary: #bbd4ec;\n\t\t\t\t\t--select2-opt-group: #c1b7f1;\n\t\t\t\t\t--input-box-outline: #bbb;\n\t\t\t\t\t--mute-button-normal: #e9b752;\n\t\t\t\t\t--mute-button-mod: #9558ee;\n\t\t\t\t\t--mod-label-primary: #ececff;\n\t\t\t\t\t--mod-label-secondary-text: rgb(197, 145, 247);\n\t\t\t\t\t--mod-label-primary-text: #302880;\n\t\t\t\t\t--pitch-secondary-channel-hue: 0;\n\t\t\t\t\t--pitch-secondary-channel-hue-scale: 8.1;\n\t\t\t\t\t--pitch-secondary-channel-sat: 53.3;\n\t\t\t\t\t--pitch-secondary-channel-sat-scale: -0.1;\n\t\t\t\t\t--pitch-secondary-channel-lum: 72;\n\t\t\t\t\t--pitch-secondary-channel-lum-scale: -0.05;\n\t\t\t\t\t--pitch-primary-channel-hue: 0;\n\t\t\t\t\t--pitch-primary-channel-hue-scale: 8.1;\n\t\t\t\t\t--pitch-primary-channel-sat: 97;\n\t\t\t\t\t--pitch-primary-channel-sat-scale: -0.1;\n\t\t\t\t\t--pitch-primary-channel-lum: 45.5;\n\t\t\t\t\t--pitch-primary-channel-lum-scale: -0.05;\n\t\t\t\t\t--pitch-secondary-note-hue: 0;\n\t\t\t\t\t--pitch-secondary-note-hue-scale: 8.1;\n\t\t\t\t\t--pitch-secondary-note-sat: 93.9;\n\t\t\t\t\t--pitch-secondary-note-sat-scale: -0.1;\n\t\t\t\t\t--pitch-secondary-note-lum: 95;\n\t\t\t\t\t--pitch-secondary-note-lum-scale: -0.05;\n\t\t\t\t\t--pitch-primary-note-hue: 0;\n\t\t\t\t\t--pitch-primary-note-hue-scale: 8.1;\n\t\t\t\t\t--pitch-primary-note-sat: 100;\n\t\t\t\t\t--pitch-primary-note-sat-scale: 0.05;\n\t\t\t\t\t--pitch-primary-note-lum: 43.6;\n\t\t\t\t\t--pitch-primary-note-lum-scale: -0.025;\n\t\t\t\t\t--noise-secondary-channel-hue: 220;\n\t\t\t\t\t--noise-secondary-channel-hue-scale: 2;\n\t\t\t\t\t--noise-secondary-channel-sat: 25;\n\t\t\t\t\t--noise-secondary-channel-sat-scale: 0;\n\t\t\t\t\t--noise-secondary-channel-lum: 62;\n\t\t\t\t\t--noise-secondary-channel-lum-scale: -0.1;\n\t\t\t\t\t--noise-primary-channel-hue: 220;\n\t\t\t\t\t--noise-primary-channel-hue-scale: 2;\n\t\t\t\t\t--noise-primary-channel-sat: 53;\n\t\t\t\t\t--noise-primary-channel-sat-scale: 0;\n\t\t\t\t\t--noise-primary-channel-lum: 53.5;\n\t\t\t\t\t--noise-primary-channel-lum-scale: -0.1;\n\t\t\t\t\t--noise-secondary-note-hue: 220;\n\t\t\t\t\t--noise-secondary-note-hue-scale: 2;\n\t\t\t\t\t--noise-secondary-note-sat: 58.5;\n\t\t\t\t\t--noise-secondary-note-sat-scale: 0;\n\t\t\t\t\t--noise-secondary-note-lum: 85;\n\t\t\t\t\t--noise-secondary-note-lum-scale: -1;\n\t\t\t\t\t--noise-primary-note-hue: 220;\n\t\t\t\t\t--noise-primary-note-hue-scale: 2;\n\t\t\t\t\t--noise-primary-note-sat: 56.5;\n\t\t\t\t\t--noise-primary-note-sat-scale: 0;\n\t\t\t\t\t--noise-primary-note-lum: 54;\n\t\t\t\t\t--noise-primary-note-lum-scale: -1;\n\t\t\t\t\t--mod-secondary-channel-hue: 90;\n\t\t\t\t\t--mod-secondary-channel-hue-scale: 1.5;\n\t\t\t\t\t--mod-secondary-channel-sat: 88;\n\t\t\t\t\t--mod-secondary-channel-sat-scale: 0;\n\t\t\t\t\t--mod-secondary-channel-lum: 60;\n\t\t\t\t\t--mod-secondary-channel-lum-scale: 0;\n\t\t\t\t\t--mod-primary-channel-hue: 90;\n\t\t\t\t\t--mod-primary-channel-hue-scale: 1.5;\n\t\t\t\t\t--mod-primary-channel-sat: 100;\n\t\t\t\t\t--mod-primary-channel-sat-scale: 0;\n\t\t\t\t\t--mod-primary-channel-lum: 65;\n\t\t\t\t\t--mod-primary-channel-lum-scale: 0;\n\t\t\t\t\t--mod-secondary-note-hue: 90;\n\t\t\t\t\t--mod-secondary-note-hue-scale: 1.5;\n\t\t\t\t\t--mod-secondary-note-sat: 92;\n\t\t\t\t\t--mod-secondary-note-sat-scale: 0;\n\t\t\t\t\t--mod-secondary-note-lum: 95;\n\t\t\t\t\t--mod-secondary-note-lum-scale: 0;\n\t\t\t\t\t--mod-primary-note-hue: 90;\n\t\t\t\t\t--mod-primary-note-hue-scale: 1.5;\n\t\t\t\t\t--mod-primary-note-sat: 96;\n\t\t\t\t\t--mod-primary-note-sat-scale: 0;\n\t\t\t\t\t--mod-primary-note-lum: 55;\n\t\t\t\t\t--mod-primary-note-lum-scale: 0;\n\t\t\t\t}\n\n\t\t\t\t.beepboxEditor button, .beepboxEditor select {\n\t\t\t\t\tbox-shadow: inset 0 0 0 1px var(--secondary-text);\n\t\t\t\t}\n\n\t\t\t\t.select2-selection__rendered {\n\t\t\t\t\tbox-shadow: inset 0 0 0 1px var(--secondary-text);\n\t\t\t\t}\n\t\t\t"},z.pageMargin="var(--page-margin)",z.editorBackground="var(--editor-background)",z.hoverPreview="var(--hover-preview)",z.playhead="var(--playhead)",z.primaryText="var(--primary-text)",z.secondaryText="var(--secondary-text)",z.invertedText="var(--inverted-text)",z.textSelection="var(--text-selection)",z.boxSelectionFill="var(--box-selection-fill)",z.loopAccent="var(--loop-accent)",z.linkAccent="var(--link-accent)",z.uiWidgetBackground="var(--ui-widget-background)",z.uiWidgetFocus="var(--ui-widget-focus)",z.pitchBackground="var(--pitch-background)",z.tonic="var(--tonic)",z.fifthNote="var(--fifth-note)",z.whitePianoKey="var(--white-piano-key)",z.blackPianoKey="var(--black-piano-key)",z.useColorFormula="var(--use-color-formula)",z.pitchSecondaryChannelHue="var(--pitch-secondary-channel-hue)",z.pitchSecondaryChannelHueScale="var(--pitch-secondary-channel-hue-scale)",z.pitchSecondaryChannelSat="var(--pitch-secondary-channel-sat)",z.pitchSecondaryChannelSatScale="var(--pitch-secondary-channel-sat-scale)",z.pitchSecondaryChannelLum="var(--pitch-secondary-channel-lum)",z.pitchSecondaryChannelLumScale="var(--pitch-secondary-channel-lum-scale)",z.pitchPrimaryChannelHue="var(--pitch-primary-channel-hue)",z.pitchPrimaryChannelHueScale="var(--pitch-primary-channel-hue-scale)",z.pitchPrimaryChannelSat="var(--pitch-primary-channel-sat)",z.pitchPrimaryChannelSatScale="var(--pitch-primary-channel-sat-scale)",z.pitchPrimaryChannelLum="var(--pitch-primary-channel-lum)",z.pitchPrimaryChannelLumScale="var(--pitch-primary-channel-lum-scale)",z.pitchSecondaryNoteHue="var(--pitch-secondary-note-hue)",z.pitchSecondaryNoteHueScale="var(--pitch-secondary-note-hue-scale)",z.pitchSecondaryNoteSat="var(--pitch-secondary-note-sat)",z.pitchSecondaryNoteSatScale="var(--pitch-secondary-note-sat-scale)",z.pitchSecondaryNoteLum="var(--pitch-secondary-note-lum)",z.pitchSecondaryNoteLumScale="var(--pitch-secondary-note-lum-scale)",z.pitchPrimaryNoteHue="var(--pitch-primary-note-hue)",z.pitchPrimaryNoteHueScale="var(--pitch-primary-note-hue-scale)",z.pitchPrimaryNoteSat="var(--pitch-primary-note-sat)",z.pitchPrimaryNoteSatScale="var(--pitch-primary-note-sat-scale)",z.pitchPrimaryNoteLum="var(--pitch-primary-note-lum)",z.pitchPrimaryNoteLumScale="var(--pitch-primary-note-lum-scale)",z.modSecondaryChannelHue="var(--mod-secondary-channel-hue)",z.modSecondaryChannelHueScale="var(--mod-secondary-channel-hue-scale)",z.modSecondaryChannelSat="var(--mod-secondary-channel-sat)",z.modSecondaryChannelSatScale="var(--mod-secondary-channel-sat-scale)",z.modSecondaryChannelLum="var(--mod-secondary-channel-lum)",z.modSecondaryChannelLumScale="var(--mod-secondary-channel-lum-scale)",z.modPrimaryChannelHue="var(--mod-primary-channel-hue)",z.modPrimaryChannelHueScale="var(--mod-primary-channel-hue-scale)",z.modPrimaryChannelSat="var(--mod-primary-channel-sat)",z.modPrimaryChannelSatScale="var(--mod-primary-channel-sat-scale)",z.modPrimaryChannelLum="var(--mod-primary-channel-lum)",z.modPrimaryChannelLumScale="var(--mod-primary-channel-lum-scale)",z.modSecondaryNoteHue="var(--mod-secondary-note-hue)",z.modSecondaryNoteHueScale="var(--mod-secondary-note-hue-scale)",z.modSecondaryNoteSat="var(--mod-secondary-note-sat)",z.modSecondaryNoteSatScale="var(--mod-secondary-note-sat-scale)",z.modSecondaryNoteLum="var(--mod-secondary-note-lum)",z.modSecondaryNoteLumScale="var(--mod-secondary-note-lum-scale)",z.modPrimaryNoteHue="var(--mod-primary-note-hue)",z.modPrimaryNoteHueScale="var(--mod-primary-note-hue-scale)",z.modPrimaryNoteSat="var(--mod-primary-note-sat)",z.modPrimaryNoteSatScale="var(--mod-primary-note-sat-scale)",z.modPrimaryNoteLum="var(--mod-primary-note-lum)",z.modPrimaryNoteLumScale="var(--mod-primary-note-lum-scale)",z.noiseSecondaryChannelHue="var(--noise-secondary-channel-hue)",z.noiseSecondaryChannelHueScale="var(--noise-secondary-channel-hue-scale)",z.noiseSecondaryChannelSat="var(--noise-secondary-channel-sat)",z.noiseSecondaryChannelSatScale="var(--noise-secondary-channel-sat-scale)",z.noiseSecondaryChannelLum="var(--noise-secondary-channel-lum)",z.noiseSecondaryChannelLumScale="var(--noise-secondary-channel-lum-scale)",z.noisePrimaryChannelHue="var(--noise-primary-channel-hue)",z.noisePrimaryChannelHueScale="var(--noise-primary-channel-hue-scale)",z.noisePrimaryChannelSat="var(--noise-primary-channel-sat)",z.noisePrimaryChannelSatScale="var(--noise-primary-channel-sat-scale)",z.noisePrimaryChannelLum="var(--noise-primary-channel-lum)",z.noisePrimaryChannelLumScale="var(--noise-primary-channel-lum-scale)",z.noiseSecondaryNoteHue="var(--noise-secondary-note-hue)",z.noiseSecondaryNoteHueScale="var(--noise-secondary-note-hue-scale)",z.noiseSecondaryNoteSat="var(--noise-secondary-note-sat)",z.noiseSecondaryNoteSatScale="var(--noise-secondary-note-sat-scale)",z.noiseSecondaryNoteLum="var(--noise-secondary-note-lum)",z.noiseSecondaryNoteLumScale="var(--noise-secondary-note-lum-scale)",z.noisePrimaryNoteHue="var(--noise-primary-note-hue)",z.noisePrimaryNoteHueScale="var(--noise-primary-note-hue-scale)",z.noisePrimaryNoteSat="var(--noise-primary-note-sat)",z.noisePrimaryNoteSatScale="var(--noise-primary-note-sat-scale)",z.noisePrimaryNoteLum="var(--noise-primary-note-lum)",z.noisePrimaryNoteLumScale="var(--noise-primary-note-lum-scale)",z.trackEditorBgPitch="var(--track-editor-bg-pitch)",z.trackEditorBgPitchDim="var(--track-editor-bg-pitch-dim)",z.trackEditorBgNoise="var(--track-editor-bg-noise)",z.trackEditorBgNoiseDim="var(--track-editor-bg-noise-dim)",z.trackEditorBgMod="var(--track-editor-bg-mod)",z.trackEditorBgModDim="var(--track-editor-bg-mod-dim)",z.multiplicativeModSlider="var(--multiplicative-mod-slider)",z.overwritingModSlider="var(--overwriting-mod-slider)",z.indicatorPrimary="var(--indicator-primary)",z.indicatorSecondary="var(--indicator-secondary)",z.select2OptGroup="var(--select2-opt-group)",z.inputBoxOutline="var(--input-box-outline)",z.muteButtonNormal="var(--mute-button-normal)",z.muteButtonMod="var(--mute-button-mod)",z.modLabelPrimary="var(--mod-label-primary)",z.modLabelSecondaryText="var(--mod-label-secondary-text)",z.modLabelPrimaryText="var(--mod-label-primary-text)",z.pitchChannels=m([{name:"pitch1",secondaryChannel:"var(--pitch1-secondary-channel)",primaryChannel:"var(--pitch1-primary-channel)",secondaryNote:"var(--pitch1-secondary-note)",primaryNote:"var(--pitch1-primary-note)"},{name:"pitch2",secondaryChannel:"var(--pitch2-secondary-channel)",primaryChannel:"var(--pitch2-primary-channel)",secondaryNote:"var(--pitch2-secondary-note)",primaryNote:"var(--pitch2-primary-note)"},{name:"pitch3",secondaryChannel:"var(--pitch3-secondary-channel)",primaryChannel:"var(--pitch3-primary-channel)",secondaryNote:"var(--pitch3-secondary-note)",primaryNote:"var(--pitch3-primary-note)"},{name:"pitch4",secondaryChannel:"var(--pitch4-secondary-channel)",primaryChannel:"var(--pitch4-primary-channel)",secondaryNote:"var(--pitch4-secondary-note)",primaryNote:"var(--pitch4-primary-note)"},{name:"pitch5",secondaryChannel:"var(--pitch5-secondary-channel)",primaryChannel:"var(--pitch5-primary-channel)",secondaryNote:"var(--pitch5-secondary-note)",primaryNote:"var(--pitch5-primary-note)"},{name:"pitch6",secondaryChannel:"var(--pitch6-secondary-channel)",primaryChannel:"var(--pitch6-primary-channel)",secondaryNote:"var(--pitch6-secondary-note)",primaryNote:"var(--pitch6-primary-note)"},{name:"pitch7",secondaryChannel:"var(--pitch7-secondary-channel)",primaryChannel:"var(--pitch7-primary-channel)",secondaryNote:"var(--pitch7-secondary-note)",primaryNote:"var(--pitch7-primary-note)"},{name:"pitch8",secondaryChannel:"var(--pitch8-secondary-channel)",primaryChannel:"var(--pitch8-primary-channel)",secondaryNote:"var(--pitch8-secondary-note)",primaryNote:"var(--pitch8-primary-note)"},{name:"pitch9",secondaryChannel:"var(--pitch9-secondary-channel)",primaryChannel:"var(--pitch9-primary-channel)",secondaryNote:"var(--pitch9-secondary-note)",primaryNote:"var(--pitch9-primary-note)"},{name:"pitch10",secondaryChannel:"var(--pitch10-secondary-channel)",primaryChannel:"var(--pitch10-primary-channel)",secondaryNote:"var(--pitch10-secondary-note)",primaryNote:"var(--pitch10-primary-note)"}]),z.noiseChannels=m([{name:"noise1",secondaryChannel:"var(--noise1-secondary-channel)",primaryChannel:"var(--noise1-primary-channel)",secondaryNote:"var(--noise1-secondary-note)",primaryNote:"var(--noise1-primary-note)"},{name:"noise2",secondaryChannel:"var(--noise2-secondary-channel)",primaryChannel:"var(--noise2-primary-channel)",secondaryNote:"var(--noise2-secondary-note)",primaryNote:"var(--noise2-primary-note)"},{name:"noise3",secondaryChannel:"var(--noise3-secondary-channel)",primaryChannel:"var(--noise3-primary-channel)",secondaryNote:"var(--noise3-secondary-note)",primaryNote:"var(--noise3-primary-note)"},{name:"noise4",secondaryChannel:"var(--noise4-secondary-channel)",primaryChannel:"var(--noise4-primary-channel)",secondaryNote:"var(--noise4-secondary-note)",primaryNote:"var(--noise4-primary-note)"}]),z.modChannels=m([{name:"mod1",secondaryChannel:"var(--mod1-secondary-channel)",primaryChannel:"var(--mod1-primary-channel)",secondaryNote:"var(--mod1-secondary-note)",primaryNote:"var(--mod1-primary-note)"},{name:"mod2",secondaryChannel:"var(--mod2-secondary-channel)",primaryChannel:"var(--mod2-primary-channel)",secondaryNote:"var(--mod2-secondary-note)",primaryNote:"var(--mod2-primary-note)"},{name:"mod3",secondaryChannel:"var(--mod3-secondary-channel)",primaryChannel:"var(--mod3-primary-channel)",secondaryNote:"var(--mod3-secondary-note)",primaryNote:"var(--mod3-primary-note)"},{name:"mod4",secondaryChannel:"var(--mod4-secondary-channel)",primaryChannel:"var(--mod4-primary-channel)",secondaryNote:"var(--mod4-secondary-note)",primaryNote:"var(--mod4-primary-note)"}]),z.l=document.head.appendChild(M.style({type:"text/css"}));/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|android|ipad|playbook|silk/i.test(navigator.userAgent);class R{static valueToPreset(t){const e=t>>6,n=63&t;return R.presetCategories[e].presets[n]}static midiProgramToPresetValue(t){for(let e=0;e<R.presetCategories.length;e++){const n=R.presetCategories[e];for(let i=0;i<n.presets.length;i++){const a=n.presets[i];if(a.generalMidi&&a.midiProgram==t)return(e<<6)+i}}return null}static nameToPresetValue(t){for(let e=0;e<R.presetCategories.length;e++){const n=R.presetCategories[e];for(let i=0;i<n.presets.length;i++){if(n.presets[i].name==t)return(e<<6)+i}}return null}}function A(t,e){for(let n=0;n<t.length;n++)t[n]*=e}function T(t){if(!function(t){return!(!t||t&t-1)}(t))throw new Error("FFT array length must be a power of 2.");return Math.round(Math.log(t)/Math.log(2))}function H(t,e){const n=T(e);if(e<4)throw new Error("FFT array length must be at least 4.");for(let i=n-1;i>=2;i--){const n=1<<i,a=n>>1,r=n<<1,s=2*Math.PI/r,o=Math.cos(s),l=Math.sin(s),c=2*o;for(let i=0;i<e;i+=r){const e=i,r=e+a,s=e+n,h=s+a,m=s+n,d=t[e],f=t[s];t[e]=d+f,t[r]*=2,t[s]=d-f,t[h]*=2;let p=o,u=-l,y=1,v=0;for(let n=1;n<a;n++){const i=e+n,a=s-n,r=s+n,o=m-n,l=t[i],h=t[a],d=t[r],f=t[o],g=l-h,b=d+f;t[i]=l+h,t[a]=f-d,t[r]=g*p-b*u,t[o]=b*p+g*u;const k=c*p-y,w=c*u-v;y=p,v=u,p=k,u=w}}}for(let n=0;n<e;n+=4){const e=n+1,i=n+2,a=n+3,r=t[n],s=2*t[e],o=t[i],l=2*t[a],c=r+o,h=r-o;t[n]=c+s,t[e]=c-s,t[i]=h+l,t[a]=h-l}!function(t,e){const n=T(e);if(n>16)throw new Error("FFT array length must not be greater than 2^16.");const i=16-n;for(let n=0;n<e;n++){let e;if(e=(43690&n)>>1|(21845&n)<<1,e=(52428&e)>>2|(13107&e)<<2,e=(61680&e)>>4|(3855&e)<<4,e=(e>>8|(255&e)<<8)>>i,e>n){let i=t[n];t[n]=t[e],t[e]=i}}}(t,e)}R.version="2.3",R.versionDisplayName="JummBox "+R.version,R.presetCategories=m([{name:"Custom Instruments",presets:m([{name:"chip wave",customType:0},{name:"FM (expert)",customType:1},{name:"basic noise",customType:2},{name:"spectrum",customType:3},{name:"drumset",customType:4},{name:"harmonics",customType:5},{name:"pulse width",customType:6},{name:"custom chip",customType:7}])},{name:"Retro Presets",presets:m([{name:"square wave",midiProgram:80,settings:{type:"chip",transition:"seamless",effects:"none",chord:"arpeggio",filterCutoffHz:4e3,filterResonance:0,filterEnvelope:"steady",wave:"square",interval:"union",vibrato:"none"}},{name:"triangle wave",midiProgram:71,settings:{type:"chip",transition:"seamless",effects:"none",chord:"arpeggio",filterCutoffHz:4e3,filterResonance:0,filterEnvelope:"steady",wave:"triangle",interval:"union",vibrato:"none"}},{name:"square lead",midiProgram:80,generalMidi:!0,settings:{type:"chip",transition:"hard",effects:"reverb",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"steady",wave:"square",interval:"hum",vibrato:"none"}},{name:"sawtooth lead 1",midiProgram:81,generalMidi:!0,settings:{type:"chip",transition:"hard",effects:"reverb",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"steady",wave:"sawtooth",interval:"shimmer",vibrato:"none"}},{name:"sawtooth lead 2",midiProgram:81,settings:{type:"chip",effects:"reverb",transition:"medium fade",chord:"harmony",filterCutoffHz:5657,filterResonance:29,filterEnvelope:"steady",wave:"sawtooth",interval:"hum",vibrato:"light"}},{name:"chip noise",midiProgram:116,isNoise:!0,settings:{type:"noise",transition:"hard",effects:"none",chord:"arpeggio",filterCutoffHz:4e3,filterResonance:0,filterEnvelope:"steady",wave:"retro"}},{name:"FM twang",midiProgram:32,settings:{type:"FM",transition:"hard",effects:"none",chord:"harmony",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"1⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:15,envelope:"twang 2"},{frequency:"1×",amplitude:0,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"FM bass",midiProgram:36,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"custom interval",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"2×",amplitude:11,envelope:"custom"},{frequency:"1×",amplitude:7,envelope:"twang 2"},{frequency:"1×",amplitude:9,envelope:"twang 3"},{frequency:"20×",amplitude:3,envelope:"twang 2"}]}},{name:"FM flute",midiProgram:73,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"1⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:6,envelope:"twang 2"},{frequency:"1×",amplitude:0,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"FM organ",midiProgram:16,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"custom interval",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"delayed",algorithm:"1←3 2←4",feedbackType:"1⟲ 2⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:7,envelope:"custom"},{frequency:"2×",amplitude:7,envelope:"custom"},{frequency:"1×",amplitude:11,envelope:"steady"},{frequency:"2×",amplitude:11,envelope:"steady"}]}},{name:"NES Pulse",midiProgram:80,settings:{type:"custom chip",transition:"hard",effects:"none",chord:"arpeggio",filterCutoffHz:4e3,filterResonance:0,filterEnvelope:"steady",interval:"union",vibrato:"none",customChipWave:[-24,-24,-24,-24,-23,-23,-23,-23,-22,-22,-22,-22,-21,-21,-21,-21,-20,-20,-20,-20,-19,-19,-19,-19,-18,-18,-18,-18,-17,-17,-17,-17,24,24,24,24,23,23,23,23,22,22,22,22,21,21,21,21,20,20,20,20,19,19,19,19,18,18,18,18,17,17,17,17]}},{name:"Gameboy Pulse",midiProgram:80,settings:{type:"custom chip",transition:"hard",effects:"none",chord:"arpeggio",filterCutoffHz:4e3,filterResonance:0,filterEnvelope:"steady",interval:"union",vibrato:"none",customChipWave:[-24,-20,-17,-15,-13,-13,-11,-11,-11,-9,-9,-9,-9,-7,-7,-7,-7,-7,-5,-5,-5,-5,-5,-5,-3,-3,-3,-3,-3,-3,-3,-3,24,20,17,15,13,13,11,11,11,9,9,9,9,7,7,7,7,7,5,5,5,5,5,5,3,3,3,3,3,3,3,3]}},{name:"VRC6 Sawtooth",midiProgram:81,settings:{type:"custom chip",transition:"hard",effects:"none",chord:"arpeggio",filterCutoffHz:4e3,filterResonance:0,filterEnvelope:"steady",interval:"union",vibrato:"none",customChipWave:[-24,-20,-16,-13,-10,-8,-6,-5,-4,-4,0,0,0,0,4,4,4,4,4,4,8,8,8,8,8,8,8,8,12,12,12,12,12,12,12,12,16,16,16,16,16,16,16,16,20,20,20,20,20,20,20,20,24,24,24,24,24,24,24,24,24,24,24,24]}},{name:"Atari Square",midiProgram:80,settings:{type:"custom chip",effects:"none",transition:"seamless",chord:"arpeggio",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",interval:"union",vibrato:"none",customChipWave:[-24,-24,-24,-23,-23,-23,-22,-22,-22,-21,-21,-21,-20,-20,-20,-19,-19,-19,-18,-18,-18,-17,-17,-17,-16,-16,-16,-15,-15,-15,-14,-14,-14,-13,-13,-13,24,24,24,23,23,23,22,22,22,21,21,21,20,20,20,19,19,19,18,18,18,17,17,17,16,16,15,15]}},{name:"Atari Bass",midiProgram:36,settings:{type:"custom chip",effects:"none",transition:"seamless",chord:"arpeggio",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",interval:"union",vibrato:"none",customChipWave:[-24,-24,-24,-24,-24,-24,-24,-24,-24,24,24,24,24,24,24,-24,-24,-24,24,24,24,-24,-24,-24,24,24,24,-24,-24,-24,24,24,-24,-24,-24,-24,-24,-24,-24,-24,-24,24,24,24,24,24,24,-24,-24,24,24,24,24,24,-24,-24,-24,-24,24,24,-24,-24,24,24]}}])},{name:"Keyboard Presets",presets:m([{name:"grand piano 1",midiProgram:0,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:1414,filterResonance:14,filterEnvelope:"twang 3",interval:"piano",vibrato:"none",harmonics:[100,100,86,86,86,71,71,71,0,86,71,71,71,57,57,71,57,14,57,57,57,57,57,57,57,57,29,57]}},{name:"bright piano",midiProgram:1,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"twang 3",interval:"piano",vibrato:"none",harmonics:[100,100,86,86,71,71,0,71,86,86,71,71,71,14,57,57,57,57,57,57,29,57,57,57,57,57,57,57]}},{name:"electric grand",midiProgram:2,generalMidi:!0,settings:{type:"chip",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"twang 3",wave:"1/8 pulse",interval:"shimmer",vibrato:"none"}},{name:"honky-tonk piano",midiProgram:3,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:5657,filterResonance:29,filterEnvelope:"twang 2",interval:"honky tonk",vibrato:"none",harmonics:[100,100,86,71,86,71,43,71,43,43,57,57,57,29,57,43,43,43,43,43,29,43,43,43,29,29,29,29]}},{name:"electric piano 1",midiProgram:4,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"twang 2",interval:"union",vibrato:"none",harmonics:[86,100,100,71,71,57,57,43,43,43,29,29,29,14,14,14,0,0,0,0,0,57,0,0,0,0,0,0]}},{name:"electric piano 2",midiProgram:5,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:2828,filterResonance:0,filterEnvelope:"twang 3",vibrato:"none",algorithm:"1←3 2←4",feedbackType:"1⟲ 2⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:12,envelope:"custom"},{frequency:"1×",amplitude:6,envelope:"custom"},{frequency:"1×",amplitude:9,envelope:"steady"},{frequency:"16×",amplitude:6,envelope:"twang 3"}]}},{name:"harpsichord",midiProgram:6,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"twang 2",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"4⟲",feedbackAmplitude:9,feedbackEnvelope:"twang 2",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"4×",amplitude:8,envelope:"steady"},{frequency:"3×",amplitude:6,envelope:"steady"},{frequency:"5×",amplitude:7,envelope:"steady"}]}},{name:"clavinet",midiProgram:7,generalMidi:!0,settings:{type:"FM",transition:"hard",effects:"reverb",chord:"harmony",filterCutoffHz:5657,filterResonance:0,filterEnvelope:"twang 2",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"3⟲",feedbackAmplitude:6,feedbackEnvelope:"twang 2",operators:[{frequency:"3×",amplitude:15,envelope:"custom"},{frequency:"~1×",amplitude:6,envelope:"steady"},{frequency:"8×",amplitude:4,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"dulcimer",midiProgram:15,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:5657,filterResonance:14,filterEnvelope:"twang 2",interval:"piano",vibrato:"none",harmonics:[100,100,100,86,100,86,57,100,100,86,100,86,100,86,100,71,57,71,71,100,86,71,86,86,100,86,86,86]}},{name:"grand piano 2",midiProgram:0,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:1414,filterResonance:43,filterEnvelope:"twang 3",interval:"shimmer",vibrato:"none",harmonics:[100,86,86,86,86,71,71,57,0,57,29,43,57,57,57,43,43,0,29,43,43,43,43,43,43,29,0,29]}}])},{name:"Idiophone Presets",presets:m([{name:"celesta",midiProgram:8,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:5657,filterResonance:14,filterEnvelope:"twang 2",vibrato:"none",algorithm:"(1 2)←(3 4)",feedbackType:"1⟲ 2⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"~1×",amplitude:11,envelope:"custom"},{frequency:"8×",amplitude:6,envelope:"custom"},{frequency:"20×",amplitude:3,envelope:"twang 1"},{frequency:"3×",amplitude:1,envelope:"twang 2"}]}},{name:"glockenspiel",midiProgram:9,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:5657,filterResonance:14,filterEnvelope:"twang 2",vibrato:"none",algorithm:"(1 2 3)←4",feedbackType:"1⟲ 2⟲ 3⟲",feedbackAmplitude:2,feedbackEnvelope:"decay 1",operators:[{frequency:"1×",amplitude:7,envelope:"custom"},{frequency:"5×",amplitude:11,envelope:"custom"},{frequency:"8×",amplitude:7,envelope:"custom"},{frequency:"20×",amplitude:2,envelope:"twang 1"}]}},{name:"music box 1",midiProgram:10,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"twang 2",interval:"union",vibrato:"none",harmonics:[100,0,0,100,0,0,0,0,0,0,100,0,0,0,0,0,0,0,0,86,0,0,0,0,0,0,71,0]}},{name:"music box 2",midiProgram:10,settings:{type:"harmonics",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"twang 1",interval:"union",vibrato:"none",harmonics:[100,57,57,0,0,0,0,0,0,57,0,0,0,14,14,14,14,14,14,43,14,14,14,14,14,14,14,14]}},{name:"vibraphone",midiProgram:11,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"twang 2",vibrato:"none",algorithm:"1 2 3 4",feedbackType:"1→2→3→4",feedbackAmplitude:3,feedbackEnvelope:"twang 1",operators:[{frequency:"1×",amplitude:9,envelope:"custom"},{frequency:"~1×",amplitude:9,envelope:"custom"},{frequency:"9×",amplitude:3,envelope:"custom"},{frequency:"4×",amplitude:9,envelope:"custom"}]}},{name:"marimba",midiProgram:12,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2e3,filterResonance:29,filterEnvelope:"decay 1",vibrato:"none",algorithm:"1 2←(3 4)",feedbackType:"1⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:10,envelope:"custom"},{frequency:"4×",amplitude:6,envelope:"custom"},{frequency:"13×",amplitude:6,envelope:"twang 1"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"kalimba",midiProgram:108,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"decay 1",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"1⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:11,envelope:"custom"},{frequency:"5×",amplitude:3,envelope:"twang 2"},{frequency:"20×",amplitude:3,envelope:"twang 1"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"xylophone",midiProgram:13,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"twang 1",vibrato:"none",algorithm:"(1 2 3)←4",feedbackType:"1⟲ 2⟲ 3⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:9,envelope:"custom"},{frequency:"6×",amplitude:9,envelope:"custom"},{frequency:"11×",amplitude:9,envelope:"custom"},{frequency:"20×",amplitude:6,envelope:"twang 1"}]}},{name:"tubular bell",midiProgram:14,generalMidi:!0,midiSubharmonicOctaves:1,settings:{type:"harmonics",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"twang 3",interval:"hum",vibrato:"none",harmonics:[43,71,0,100,0,100,0,86,0,0,86,0,14,71,14,14,57,14,14,43,14,14,43,14,14,43,14,14]}},{name:"bell synth",midiProgram:14,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2e3,filterResonance:29,filterEnvelope:"twang 3",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"1⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"~2×",amplitude:10,envelope:"custom"},{frequency:"7×",amplitude:6,envelope:"twang 3"},{frequency:"20×",amplitude:1,envelope:"twang 1"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"rain drop",midiProgram:96,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"twang 1",vibrato:"none",algorithm:"(1 2)←(3 4)",feedbackType:"1⟲ 2⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:12,envelope:"custom"},{frequency:"6×",amplitude:4,envelope:"custom"},{frequency:"20×",amplitude:3,envelope:"twang 1"},{frequency:"1×",amplitude:6,envelope:"tremolo1"}]}},{name:"crystal",midiProgram:98,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"twang 2",vibrato:"delayed",algorithm:"1 2 3 4",feedbackType:"1⟲ 2⟲ 3⟲ 4⟲",feedbackAmplitude:4,feedbackEnvelope:"twang 1",operators:[{frequency:"1×",amplitude:10,envelope:"custom"},{frequency:"3×",amplitude:7,envelope:"custom"},{frequency:"6×",amplitude:4,envelope:"custom"},{frequency:"13×",amplitude:4,envelope:"custom"}]}},{name:"tinkle bell",midiProgram:112,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"twang 2",vibrato:"none",algorithm:"1 2 3 4",feedbackType:"1→2→3→4",feedbackAmplitude:5,feedbackEnvelope:"twang 3",operators:[{frequency:"~2×",amplitude:7,envelope:"custom"},{frequency:"5×",amplitude:7,envelope:"custom"},{frequency:"7×",amplitude:7,envelope:"custom"},{frequency:"16×",amplitude:7,envelope:"custom"}]}},{name:"agogo",midiProgram:113,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"decay 1",vibrato:"none",algorithm:"1 2 3 4",feedbackType:"1→4",feedbackAmplitude:15,feedbackEnvelope:"decay 1",operators:[{frequency:"2×",amplitude:9,envelope:"custom"},{frequency:"5×",amplitude:6,envelope:"custom"},{frequency:"8×",amplitude:9,envelope:"custom"},{frequency:"13×",amplitude:11,envelope:"custom"}]}}])},{name:"Guitar Presets",presets:m([{name:"nylon guitar",midiProgram:24,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:5657,filterResonance:14,filterEnvelope:"twang 1",vibrato:"none",algorithm:"1←2←3←4",feedbackType:"3⟲",feedbackAmplitude:6,feedbackEnvelope:"twang 1",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:6,envelope:"steady"},{frequency:"5×",amplitude:2,envelope:"steady"},{frequency:"7×",amplitude:4,envelope:"steady"}]}},{name:"steel guitar",midiProgram:25,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:5657,filterResonance:14,filterEnvelope:"twang 2",interval:"union",vibrato:"none",harmonics:[100,100,86,71,71,71,86,86,71,57,43,43,43,57,57,57,57,57,43,43,43,43,43,43,43,43,43,43]}},{name:"jazz guitar",midiProgram:26,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"twang 2",interval:"union",vibrato:"none",harmonics:[100,100,86,71,57,71,71,43,57,71,57,43,29,29,29,29,29,29,29,29,14,14,14,14,14,14,14,0]}},{name:"clean guitar",midiProgram:27,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"twang 2",interval:"union",vibrato:"none",harmonics:[86,100,100,100,86,57,86,100,100,100,71,57,43,71,86,71,57,57,71,71,71,71,57,57,57,57,57,43]}},{name:"muted guitar",midiProgram:28,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"twang 1",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1⟲",feedbackAmplitude:7,feedbackEnvelope:"twang 2",operators:[{frequency:"1×",amplitude:13,envelope:"custom"},{frequency:"1×",amplitude:4,envelope:"twang 3"},{frequency:"4×",amplitude:4,envelope:"twang 2"},{frequency:"16×",amplitude:4,envelope:"twang 1"}]}}])},{name:"Picked Bass Presets",presets:m([{name:"acoustic bass",midiProgram:32,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"twang 1",interval:"union",vibrato:"none",harmonics:[100,86,71,71,71,71,57,57,57,57,43,43,43,43,43,29,29,29,29,29,29,14,14,14,14,14,14,14]}},{name:"fingered bass",midiProgram:33,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"twang 1",interval:"union",vibrato:"none",harmonics:[100,86,71,57,71,43,57,29,29,29,29,29,29,14,14,14,14,14,14,14,14,14,14,14,14,14,14,0]}},{name:"picked bass",midiProgram:34,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2828,filterResonance:0,filterEnvelope:"twang 1",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"3⟲",feedbackAmplitude:4,feedbackEnvelope:"twang 1",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:5,envelope:"steady"},{frequency:"11×",amplitude:1,envelope:"twang 3"},{frequency:"1×",amplitude:9,envelope:"steady"}]}},{name:"fretless bass",midiProgram:35,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:1e3,filterResonance:14,filterEnvelope:"flare 2",interval:"union",vibrato:"none",harmonics:[100,100,86,71,71,57,57,71,71,71,57,57,57,57,57,57,57,43,43,43,43,43,43,43,43,29,29,14]}},{name:"slap bass 1",midiProgram:36,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:4e3,filterResonance:0,filterEnvelope:"twang 1",interval:"union",vibrato:"none",harmonics:[100,100,100,100,86,71,57,29,29,43,43,57,71,57,29,29,43,57,57,57,43,43,43,57,71,71,71,71]}},{name:"slap bass 2",midiProgram:37,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:5657,filterResonance:0,filterEnvelope:"twang 1",vibrato:"none",algorithm:"1←2←3←4",feedbackType:"3⟲",feedbackAmplitude:4,feedbackEnvelope:"steady",operators:[{frequency:"3×",amplitude:13,envelope:"custom"},{frequency:"1×",amplitude:7,envelope:"steady"},{frequency:"13×",amplitude:3,envelope:"steady"},{frequency:"1×",amplitude:11,envelope:"steady"}]}},{name:"bass synth 1",midiProgram:38,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:4e3,filterResonance:43,filterEnvelope:"twang 2",vibrato:"none",algorithm:"1←3 2←4",feedbackType:"3⟲ 4⟲",feedbackAmplitude:9,feedbackEnvelope:"twang 2",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:10,envelope:"custom"},{frequency:"1×",amplitude:14,envelope:"twang 1"},{frequency:"~1×",amplitude:13,envelope:"twang 2"}]}},{name:"bass synth 2",midiProgram:39,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:1e3,filterResonance:57,filterEnvelope:"punch",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"1→2",feedbackAmplitude:4,feedbackEnvelope:"twang 3",operators:[{frequency:"1×",amplitude:9,envelope:"custom"},{frequency:"1×",amplitude:9,envelope:"steady"},{frequency:"3×",amplitude:0,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"bass & lead",midiProgram:87,generalMidi:!0,settings:{type:"chip",transition:"hard",effects:"reverb",chord:"harmony",filterCutoffHz:4e3,filterResonance:86,filterEnvelope:"twang 2",wave:"sawtooth",interval:"shimmer",vibrato:"none"}}])},{name:"Picked String Presets",presets:m([{name:"pizzicato strings",midiProgram:45,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"medium fade",chord:"harmony",filterCutoffHz:1e3,filterResonance:14,filterEnvelope:"twang 1",vibrato:"none",algorithm:"(1 2 3)←4",feedbackType:"1⟲ 2⟲ 3⟲ 4⟲",feedbackAmplitude:7,feedbackEnvelope:"twang 1",operators:[{frequency:"1×",amplitude:14,envelope:"custom"},{frequency:"3×",amplitude:11,envelope:"custom"},{frequency:"6×",amplitude:9,envelope:"custom"},{frequency:"~1×",amplitude:10,envelope:"steady"}]}},{name:"harp",midiProgram:46,generalMidi:!0,settings:{type:"FM",transition:"hard fade",effects:"reverb",chord:"strum",filterCutoffHz:2828,filterResonance:0,filterEnvelope:"twang 1",vibrato:"none",algorithm:"1←3 2←4",feedbackType:"3⟲",feedbackAmplitude:6,feedbackEnvelope:"twang 2",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"4×",amplitude:6,envelope:"custom"},{frequency:"~2×",amplitude:3,envelope:"steady"},{frequency:"1×",amplitude:6,envelope:"steady"}]}},{name:"sitar",midiProgram:104,generalMidi:!0,settings:{type:"FM",transition:"hard fade",effects:"reverb",chord:"strum",filterCutoffHz:8e3,filterResonance:57,filterEnvelope:"twang 2",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"1⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:14,envelope:"twang 3"},{frequency:"9×",amplitude:3,envelope:"twang 3"},{frequency:"16×",amplitude:9,envelope:"swell 3"}]}},{name:"banjo",midiProgram:105,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"twang 2",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"2⟲",feedbackAmplitude:4,feedbackEnvelope:"steady",operators:[{frequency:"4×",amplitude:14,envelope:"custom"},{frequency:"1×",amplitude:10,envelope:"steady"},{frequency:"11×",amplitude:3,envelope:"twang 3"},{frequency:"1×",amplitude:11,envelope:"steady"}]}},{name:"ukulele",midiProgram:105,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2e3,filterResonance:0,filterEnvelope:"twang 1",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"3⟲",feedbackAmplitude:5,feedbackEnvelope:"twang 1",operators:[{frequency:"2×",amplitude:14,envelope:"custom"},{frequency:"1×",amplitude:6,envelope:"steady"},{frequency:"9×",amplitude:4,envelope:"twang 2"},{frequency:"1×",amplitude:11,envelope:"steady"}]}},{name:"shamisen",midiProgram:106,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:8e3,filterResonance:14,filterEnvelope:"twang 1",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"3⟲",feedbackAmplitude:9,feedbackEnvelope:"twang 3",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:12,envelope:"steady"},{frequency:"16×",amplitude:4,envelope:"twang 3"},{frequency:"1×",amplitude:7,envelope:"steady"}]}},{name:"koto",midiProgram:107,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"twang 2",vibrato:"none",algorithm:"1←3 2←4",feedbackType:"1⟲ 2⟲",feedbackAmplitude:5,feedbackEnvelope:"twang 2",operators:[{frequency:"~1×",amplitude:12,envelope:"custom"},{frequency:"6×",amplitude:10,envelope:"custom"},{frequency:"4×",amplitude:8,envelope:"twang 3"},{frequency:"~2×",amplitude:8,envelope:"twang 3"}]}}])},{name:"Distortion Presets",presets:m([{name:"overdrive guitar",midiProgram:29,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1→2",feedbackAmplitude:2,feedbackEnvelope:"steady",operators:[{frequency:"~1×",amplitude:13,envelope:"custom"},{frequency:"1×",amplitude:12,envelope:"steady"},{frequency:"1×",amplitude:7,envelope:"twang 3"},{frequency:"1×",amplitude:4,envelope:"swell 3"}]}},{name:"distortion guitar",midiProgram:30,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:2828,filterResonance:57,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1→2",feedbackAmplitude:4,feedbackEnvelope:"steady",operators:[{frequency:"~1×",amplitude:13,envelope:"custom"},{frequency:"1×",amplitude:11,envelope:"steady"},{frequency:"1×",amplitude:9,envelope:"swell 1"},{frequency:"~2×",amplitude:5,envelope:"swell 3"}]}},{name:"charango synth",midiProgram:84,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:5657,filterResonance:0,filterEnvelope:"twang 3",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1→2→3→4",feedbackAmplitude:8,feedbackEnvelope:"twang 3",operators:[{frequency:"3×",amplitude:13,envelope:"custom"},{frequency:"~1×",amplitude:5,envelope:"steady"},{frequency:"4×",amplitude:6,envelope:"steady"},{frequency:"3×",amplitude:7,envelope:"steady"}]}},{name:"guitar harmonics",midiProgram:31,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:2e3,filterResonance:29,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3)←4",feedbackType:"1⟲",feedbackAmplitude:2,feedbackEnvelope:"steady",operators:[{frequency:"4×",amplitude:12,envelope:"custom"},{frequency:"16×",amplitude:5,envelope:"swell 1"},{frequency:"1×",amplitude:2,envelope:"punch"},{frequency:"~1×",amplitude:12,envelope:"twang 1"}]}},{name:"distorted synth 1",midiProgram:30,settings:{type:"PWM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:4e3,filterResonance:29,filterEnvelope:"steady",pulseWidth:18,pulseEnvelope:"punch",vibrato:"none"}},{name:"distorted synth 2",midiProgram:30,settings:{type:"FM",effects:"reverb",transition:"seamless",chord:"strum",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"1⟲",feedbackAmplitude:7,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:13,envelope:"steady"},{frequency:"1×",amplitude:11,envelope:"swell 1"},{frequency:"1×",amplitude:0,envelope:"flare 1"}]}},{name:"distorted synth 3",midiProgram:30,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"delayed",algorithm:"1←(2 3 4)",feedbackType:"1→2",feedbackAmplitude:3,feedbackEnvelope:"steady",operators:[{frequency:"~1×",amplitude:13,envelope:"custom"},{frequency:"1×",amplitude:11,envelope:"steady"},{frequency:"1×",amplitude:12,envelope:"swell 1"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"distorted synth 4",midiProgram:30,settings:{type:"PWM",effects:"reverb",transition:"hard",chord:"strum",filterCutoffHz:2828,filterResonance:57,filterEnvelope:"steady",pulseWidth:50,pulseEnvelope:"swell 1",vibrato:"delayed"}}])},{name:"Bellows Presets",presets:m([{name:"drawbar organ 1",midiProgram:16,generalMidi:!0,midiSubharmonicOctaves:1,settings:{type:"harmonics",effects:"reverb",transition:"hard",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"steady",interval:"union",vibrato:"none",harmonics:[86,86,0,86,0,0,0,86,0,0,0,0,0,0,0,86,0,0,0,0,0,0,0,0,0,0,0,0]}},{name:"drawbar organ 2",midiProgram:16,midiSubharmonicOctaves:1,settings:{type:"harmonics",effects:"reverb",transition:"hard",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"steady",interval:"union",vibrato:"none",harmonics:[86,29,71,86,71,14,0,100,0,0,0,86,0,0,0,71,0,0,0,57,0,0,0,29,0,0,0,0]}},{name:"percussive organ",midiProgram:17,generalMidi:!0,midiSubharmonicOctaves:1,settings:{type:"FM",transition:"hard",effects:"reverb",chord:"harmony",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"punch",vibrato:"light",algorithm:"1 2 3 4",feedbackType:"1→3 2→4",feedbackAmplitude:7,feedbackEnvelope:"decay 1",operators:[{frequency:"1×",amplitude:7,envelope:"custom"},{frequency:"2×",amplitude:7,envelope:"custom"},{frequency:"3×",amplitude:8,envelope:"custom"},{frequency:"4×",amplitude:8,envelope:"custom"}]}},{name:"rock organ",midiProgram:18,generalMidi:!0,midiSubharmonicOctaves:1,settings:{type:"FM",effects:"chorus & reverb",transition:"hard",chord:"harmony",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"punch",vibrato:"delayed",algorithm:"(1 2 3)←4",feedbackType:"1⟲ 2⟲ 3⟲",feedbackAmplitude:2,feedbackEnvelope:"flare 1",operators:[{frequency:"1×",amplitude:9,envelope:"custom"},{frequency:"4×",amplitude:9,envelope:"custom"},{frequency:"6×",amplitude:9,envelope:"custom"},{frequency:"2×",amplitude:5,envelope:"steady"}]}},{name:"pipe organ",midiProgram:19,generalMidi:!0,midiSubharmonicOctaves:1,settings:{type:"FM",transition:"cross fade",effects:"reverb",chord:"harmony",filterCutoffHz:5657,filterResonance:43,filterEnvelope:"steady",vibrato:"none",algorithm:"1 2 3 4",feedbackType:"1⟲ 2⟲ 3⟲ 4⟲",feedbackAmplitude:5,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:8,envelope:"custom"},{frequency:"2×",amplitude:9,envelope:"custom"},{frequency:"4×",amplitude:9,envelope:"custom"},{frequency:"8×",amplitude:8,envelope:"custom"}]}},{name:"reed organ",midiProgram:20,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2e3,filterResonance:29,filterEnvelope:"steady",interval:"union",vibrato:"none",harmonics:[71,86,100,86,71,100,57,71,71,71,43,43,43,71,43,71,57,57,57,57,57,57,57,29,43,29,29,14]}},{name:"accordion",midiProgram:21,generalMidi:!0,settings:{type:"chip",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:5657,filterResonance:0,filterEnvelope:"swell 1",wave:"double saw",interval:"honky tonk",vibrato:"none"}},{name:"bandoneon",midiProgram:23,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:4e3,filterResonance:29,filterEnvelope:"swell 1",interval:"hum",vibrato:"none",harmonics:[86,86,86,57,71,86,57,71,71,71,57,43,57,43,71,43,71,57,57,43,43,43,57,43,43,29,29,29]}},{name:"bagpipe",midiProgram:109,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:5657,filterResonance:43,filterEnvelope:"punch",interval:"hum",vibrato:"none",harmonics:[71,86,86,100,100,86,57,100,86,71,71,71,57,57,57,71,57,71,57,71,43,57,57,43,43,43,43,43]}}])},{name:"String Presets",presets:m([{name:"violin 1",midiProgram:40,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2828,filterResonance:43,filterEnvelope:"steady",vibrato:"delayed",algorithm:"(1 2)←(3 4)",feedbackType:"4⟲",feedbackAmplitude:5,feedbackEnvelope:"twang 3",operators:[{frequency:"4×",amplitude:9,envelope:"custom"},{frequency:"3×",amplitude:9,envelope:"custom"},{frequency:"2×",amplitude:7,envelope:"steady"},{frequency:"7×",amplitude:5,envelope:"swell 1"}]}},{name:"viola",midiProgram:41,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:29,filterEnvelope:"steady",vibrato:"delayed",algorithm:"(1 2 3)←4",feedbackType:"1⟲ 2⟲ 3⟲",feedbackAmplitude:8,feedbackEnvelope:"swell 1",operators:[{frequency:"2×",amplitude:11,envelope:"custom"},{frequency:"7×",amplitude:7,envelope:"custom"},{frequency:"13×",amplitude:4,envelope:"custom"},{frequency:"1×",amplitude:5,envelope:"steady"}]}},{name:"cello",midiProgram:42,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2828,filterResonance:29,filterEnvelope:"steady",vibrato:"delayed",algorithm:"(1 2 3)←4",feedbackType:"1⟲ 2⟲ 3⟲",feedbackAmplitude:6,feedbackEnvelope:"swell 1",operators:[{frequency:"1×",amplitude:11,envelope:"custom"},{frequency:"3×",amplitude:9,envelope:"custom"},{frequency:"8×",amplitude:7,envelope:"custom"},{frequency:"1×",amplitude:6,envelope:"steady"}]}},{name:"contrabass",midiProgram:43,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:29,filterEnvelope:"steady",vibrato:"delayed",algorithm:"(1 2)←3←4",feedbackType:"1⟲ 2⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"16×",amplitude:5,envelope:"custom"},{frequency:"1×",amplitude:10,envelope:"custom"},{frequency:"1×",amplitude:10,envelope:"steady"},{frequency:"6×",amplitude:3,envelope:"swell 1"}]}},{name:"fiddle",midiProgram:110,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2828,filterResonance:29,filterEnvelope:"steady",vibrato:"delayed",algorithm:"(1 2)←(3 4)",feedbackType:"3⟲ 4⟲",feedbackAmplitude:5,feedbackEnvelope:"twang 1",operators:[{frequency:"2×",amplitude:10,envelope:"custom"},{frequency:"8×",amplitude:8,envelope:"custom"},{frequency:"1×",amplitude:8,envelope:"steady"},{frequency:"16×",amplitude:3,envelope:"steady"}]}},{name:"tremolo strings",midiProgram:44,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"medium fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:0,filterEnvelope:"tremolo4",vibrato:"none",algorithm:"1 2 3 4",feedbackType:"1→2→3→4",feedbackAmplitude:12,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:8,envelope:"custom"},{frequency:"~2×",amplitude:8,envelope:"custom"},{frequency:"4×",amplitude:8,envelope:"custom"},{frequency:"7×",amplitude:8,envelope:"custom"}]}},{name:"strings",midiProgram:48,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2828,filterResonance:43,filterEnvelope:"steady",vibrato:"none",algorithm:"(1 2)←(3 4)",feedbackType:"4⟲",feedbackAmplitude:5,feedbackEnvelope:"twang 3",operators:[{frequency:"4×",amplitude:9,envelope:"custom"},{frequency:"3×",amplitude:9,envelope:"custom"},{frequency:"2×",amplitude:7,envelope:"steady"},{frequency:"7×",amplitude:3,envelope:"swell 1"}]}},{name:"slow strings",midiProgram:49,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"soft fade",chord:"harmony",filterCutoffHz:1414,filterResonance:0,filterEnvelope:"swell 2",vibrato:"none",algorithm:"(1 2)←(3 4)",feedbackType:"4⟲",feedbackAmplitude:6,feedbackEnvelope:"flare 3",operators:[{frequency:"4×",amplitude:10,envelope:"custom"},{frequency:"3×",amplitude:10,envelope:"custom"},{frequency:"2×",amplitude:7,envelope:"steady"},{frequency:"7×",amplitude:4,envelope:"swell 1"}]}},{name:"strings synth 1",midiProgram:50,generalMidi:!0,settings:{type:"chip",transition:"soft fade",effects:"chorus & reverb",chord:"harmony",filterCutoffHz:1414,filterResonance:43,filterEnvelope:"steady",wave:"sawtooth",interval:"hum",vibrato:"delayed"}},{name:"strings synth 2",midiProgram:51,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"soft fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:43,filterEnvelope:"steady",vibrato:"none",algorithm:"1 2 3 4",feedbackType:"1⟲ 2⟲ 3⟲ 4⟲",feedbackAmplitude:12,feedbackEnvelope:"swell 1",operators:[{frequency:"3×",amplitude:6,envelope:"custom"},{frequency:"2×",amplitude:7,envelope:"custom"},{frequency:"1×",amplitude:8,envelope:"custom"},{frequency:"1×",amplitude:9,envelope:"custom"}]}},{name:"orchestra hit 1",midiProgram:55,generalMidi:!0,midiSubharmonicOctaves:1,settings:{type:"FM",effects:"chorus & reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:8e3,filterResonance:14,filterEnvelope:"custom",vibrato:"none",algorithm:"1 2 3 4",feedbackType:"1⟲ 2⟲ 3⟲ 4⟲",feedbackAmplitude:14,feedbackEnvelope:"twang 3",operators:[{frequency:"1×",amplitude:15,envelope:"twang 3"},{frequency:"2×",amplitude:15,envelope:"flare 3"},{frequency:"4×",amplitude:15,envelope:"flare 2"},{frequency:"8×",amplitude:15,envelope:"flare 1"}]}},{name:"violin 2",midiProgram:40,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2828,filterResonance:43,filterEnvelope:"steady",vibrato:"light",algorithm:"(1 2)←(3 4)",feedbackType:"4⟲",feedbackAmplitude:5,feedbackEnvelope:"twang 3",operators:[{frequency:"4×",amplitude:15,envelope:"custom"},{frequency:"3×",amplitude:13,envelope:"custom"},{frequency:"2×",amplitude:7,envelope:"steady"},{frequency:"7×",amplitude:8,envelope:"swell 1"}]}},{name:"orchestra hit 2",midiProgram:55,midiSubharmonicOctaves:1,settings:{type:"FM",effects:"chorus & reverb",transition:"medium fade",chord:"harmony",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"decay 1",vibrato:"delayed",algorithm:"1 2 3 4",feedbackType:"1⟲ 2⟲ 3⟲ 4⟲",feedbackAmplitude:14,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:12,envelope:"custom"},{frequency:"2×",amplitude:14,envelope:"custom"},{frequency:"3×",amplitude:12,envelope:"custom"},{frequency:"4×",amplitude:14,envelope:"custom"}]}}])},{name:"Vocal Presets",presets:m([{name:"choir soprano",midiProgram:94,generalMidi:!0,settings:{type:"harmonics",effects:"chorus & reverb",transition:"soft fade",chord:"harmony",filterCutoffHz:2828,filterResonance:57,filterEnvelope:"steady",interval:"union",vibrato:"shaky",harmonics:[86,100,86,43,14,14,57,71,57,14,14,14,14,14,43,57,43,14,14,14,14,14,14,14,0,0,0,0]}},{name:"choir tenor",midiProgram:52,generalMidi:!0,settings:{type:"harmonics",effects:"chorus & reverb",transition:"soft fade",chord:"harmony",filterCutoffHz:2828,filterResonance:86,filterEnvelope:"steady",interval:"union",vibrato:"shaky",harmonics:[86,100,100,86,71,57,29,14,14,14,29,43,43,43,29,14,14,14,0,0,0,0,0,0,0,0,0,0]}},{name:"choir bass",midiProgram:52,settings:{type:"harmonics",effects:"chorus & reverb",transition:"soft fade",chord:"harmony",filterCutoffHz:2828,filterResonance:86,filterEnvelope:"steady",interval:"union",vibrato:"shaky",harmonics:[71,86,86,100,86,100,57,43,14,14,14,14,29,29,43,43,43,43,43,29,29,29,29,14,14,14,0,0]}},{name:"solo soprano",midiProgram:85,settings:{type:"harmonics",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2828,filterResonance:71,filterEnvelope:"steady",interval:"union",vibrato:"shaky",harmonics:[86,100,86,43,14,14,57,71,57,14,14,14,14,14,43,57,43,14,14,14,14,14,14,14,0,0,0,0]}},{name:"solo tenor",midiProgram:85,settings:{type:"harmonics",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2828,filterResonance:86,filterEnvelope:"steady",interval:"union",vibrato:"shaky",harmonics:[86,100,100,86,71,57,29,14,14,14,29,43,43,43,29,14,14,14,0,0,0,0,0,0,0,0,0,0]}},{name:"solo bass",midiProgram:85,settings:{type:"harmonics",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2828,filterResonance:86,filterEnvelope:"steady",interval:"union",vibrato:"shaky",harmonics:[71,86,86,100,86,100,57,43,14,14,14,14,29,29,43,43,43,43,43,29,29,29,29,14,14,14,0,0]}},{name:"voice ooh",midiProgram:53,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:1414,filterResonance:57,filterEnvelope:"steady",interval:"union",vibrato:"shaky",harmonics:[100,57,43,43,14,14,0,0,0,14,29,29,14,0,14,29,29,14,0,0,0,0,0,0,0,0,0,0]}},{name:"voice synth",midiProgram:54,generalMidi:!0,settings:{type:"chip",transition:"medium fade",effects:"chorus & reverb",chord:"harmony",filterCutoffHz:4e3,filterResonance:57,filterEnvelope:"steady",wave:"rounded",interval:"union",vibrato:"light"}},{name:"vox synth lead",midiProgram:85,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"steady",vibrato:"light",algorithm:"(1 2 3)←4",feedbackType:"1→2→3→4",feedbackAmplitude:2,feedbackEnvelope:"punch",operators:[{frequency:"2×",amplitude:10,envelope:"custom"},{frequency:"9×",amplitude:5,envelope:"custom"},{frequency:"20×",amplitude:1,envelope:"custom"},{frequency:"~1×",amplitude:4,envelope:"steady"}]}},{name:"tiny robot",midiProgram:85,settings:{type:"FM",transition:"slide",effects:"reverb",chord:"harmony",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"delayed",algorithm:"1←(2 3 4)",feedbackType:"1⟲",feedbackAmplitude:2,feedbackEnvelope:"twang 3",operators:[{frequency:"2×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:7,envelope:"punch"},{frequency:"~1×",amplitude:7,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"yowie",midiProgram:85,settings:{type:"FM",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:86,filterEnvelope:"tremolo5",vibrato:"none",algorithm:"1←2←(3 4)",feedbackType:"1⟲",feedbackAmplitude:12,feedbackEnvelope:"tremolo3",operators:[{frequency:"2×",amplitude:12,envelope:"custom"},{frequency:"16×",amplitude:5,envelope:"steady"},{frequency:"1×",amplitude:5,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"mouse",midiProgram:85,settings:{type:"FM",effects:"reverb",transition:"slide",chord:"harmony",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"light",algorithm:"1 2 3 4",feedbackType:"1⟲ 2⟲",feedbackAmplitude:5,feedbackEnvelope:"flare 2",operators:[{frequency:"2×",amplitude:13,envelope:"custom"},{frequency:"5×",amplitude:12,envelope:"custom"},{frequency:"1×",amplitude:0,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"gumdrop",midiProgram:85,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"harmony",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"none",algorithm:"(1 2 3)←4",feedbackType:"1⟲ 2⟲ 3⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"2×",amplitude:15,envelope:"punch"},{frequency:"4×",amplitude:15,envelope:"punch"},{frequency:"7×",amplitude:15,envelope:"punch"},{frequency:"1×",amplitude:10,envelope:"twang 1"}]}},{name:"echo drop",midiProgram:102,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"hard",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"punch",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1⟲",feedbackAmplitude:2,feedbackEnvelope:"steady",operators:[{frequency:"~2×",amplitude:11,envelope:"custom"},{frequency:"~1×",amplitude:5,envelope:"steady"},{frequency:"11×",amplitude:2,envelope:"steady"},{frequency:"16×",amplitude:5,envelope:"swell 3"}]}},{name:"dark choir",midiProgram:85,settings:{type:"spectrum",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:4e3,filterResonance:29,filterEnvelope:"swell 1",spectrum:[43,14,14,14,14,14,14,100,14,14,14,57,14,14,100,14,43,14,43,14,14,43,14,29,14,29,14,14,29,0]}}])},{name:"Brass Presets",presets:m([{name:"trumpet",midiProgram:56,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2828,filterResonance:43,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"1⟲",feedbackAmplitude:9,feedbackEnvelope:"swell 1",operators:[{frequency:"1×",amplitude:14,envelope:"custom"},{frequency:"1×",amplitude:8,envelope:"steady"},{frequency:"1×",amplitude:5,envelope:"flare 2"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"trombone",midiProgram:57,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2e3,filterResonance:43,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"2⟲",feedbackAmplitude:7,feedbackEnvelope:"swell 1",operators:[{frequency:"1×",amplitude:14,envelope:"custom"},{frequency:"1×",amplitude:8,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"tuba",midiProgram:58,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2e3,filterResonance:43,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"2⟲",feedbackAmplitude:8,feedbackEnvelope:"swell 1",operators:[{frequency:"1×",amplitude:14,envelope:"custom"},{frequency:"1×",amplitude:6,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"muted trumpet",midiProgram:59,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2828,filterResonance:29,filterEnvelope:"swell 1",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1⟲",feedbackAmplitude:5,feedbackEnvelope:"flare 2",operators:[{frequency:"1×",amplitude:13,envelope:"custom"},{frequency:"1×",amplitude:5,envelope:"steady"},{frequency:"9×",amplitude:5,envelope:"steady"},{frequency:"13×",amplitude:9,envelope:"swell 1"}]}},{name:"french horn",midiProgram:60,generalMidi:!0,settings:{type:"FM",transition:"soft",effects:"reverb",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"steady",vibrato:"none",algorithm:"1←3 2←4",feedbackType:"1⟲ 2⟲",feedbackAmplitude:3,feedbackEnvelope:"swell 1",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:12,envelope:"custom"},{frequency:"1×",amplitude:10,envelope:"swell 1"},{frequency:"~1×",amplitude:8,envelope:"flare 2"}]}},{name:"brass section",midiProgram:61,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"punch",vibrato:"none",algorithm:"1←3 2←4",feedbackType:"1⟲ 2⟲",feedbackAmplitude:6,feedbackEnvelope:"swell 1",operators:[{frequency:"1×",amplitude:14,envelope:"custom"},{frequency:"1×",amplitude:12,envelope:"custom"},{frequency:"1×",amplitude:10,envelope:"swell 1"},{frequency:"~1×",amplitude:10,envelope:"swell 1"}]}},{name:"brass synth 1",midiProgram:62,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:4e3,filterResonance:29,filterEnvelope:"steady",vibrato:"none",algorithm:"1←3 2←4",feedbackType:"1⟲ 2⟲",feedbackAmplitude:11,feedbackEnvelope:"swell 1",operators:[{frequency:"1×",amplitude:14,envelope:"custom"},{frequency:"1×",amplitude:14,envelope:"custom"},{frequency:"1×",amplitude:12,envelope:"flare 1"},{frequency:"~1×",amplitude:8,envelope:"flare 2"}]}},{name:"brass synth 2",midiProgram:63,generalMidi:!0,settings:{type:"FM",transition:"soft",effects:"reverb",chord:"harmony",filterCutoffHz:4e3,filterResonance:43,filterEnvelope:"twang 3",vibrato:"none",algorithm:"1←3 2←4",feedbackType:"1⟲ 2⟲",feedbackAmplitude:9,feedbackEnvelope:"swell 1",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:10,envelope:"flare 1"},{frequency:"~1×",amplitude:7,envelope:"flare 1"}]}},{name:"pulse brass",midiProgram:62,settings:{type:"PWM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:4e3,filterResonance:29,filterEnvelope:"swell 1",pulseWidth:50,pulseEnvelope:"flare 3",vibrato:"none"}}])},{name:"Reed Presets",presets:m([{name:"soprano sax",midiProgram:64,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2e3,filterResonance:29,filterEnvelope:"steady",vibrato:"none",algorithm:"1←2←3←4",feedbackType:"4⟲",feedbackAmplitude:5,feedbackEnvelope:"swell 1",operators:[{frequency:"1×",amplitude:13,envelope:"custom"},{frequency:"4×",amplitude:4,envelope:"swell 1"},{frequency:"1×",amplitude:7,envelope:"steady"},{frequency:"5×",amplitude:4,envelope:"punch"}]}},{name:"alto sax",midiProgram:65,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2e3,filterResonance:43,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1⟲",feedbackAmplitude:4,feedbackEnvelope:"punch",operators:[{frequency:"1×",amplitude:13,envelope:"custom"},{frequency:"1×",amplitude:6,envelope:"steady"},{frequency:"4×",amplitude:6,envelope:"swell 1"},{frequency:"1×",amplitude:12,envelope:"steady"}]}},{name:"tenor sax",midiProgram:66,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2828,filterResonance:29,filterEnvelope:"steady",vibrato:"none",algorithm:"1←2←3←4",feedbackType:"1⟲",feedbackAmplitude:6,feedbackEnvelope:"swell 1",operators:[{frequency:"2×",amplitude:12,envelope:"custom"},{frequency:"3×",amplitude:7,envelope:"steady"},{frequency:"1×",amplitude:3,envelope:"steady"},{frequency:"8×",amplitude:3,envelope:"steady"}]}},{name:"baritone sax",midiProgram:67,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2828,filterResonance:0,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1⟲",feedbackAmplitude:2,feedbackEnvelope:"swell 2",operators:[{frequency:"1×",amplitude:12,envelope:"custom"},{frequency:"8×",amplitude:4,envelope:"steady"},{frequency:"4×",amplitude:5,envelope:"steady"},{frequency:"1×",amplitude:4,envelope:"punch"}]}},{name:"sax synth",midiProgram:64,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"light",algorithm:"1←(2 3 4)",feedbackType:"1⟲ 2⟲",feedbackAmplitude:4,feedbackEnvelope:"steady",operators:[{frequency:"4×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:15,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"shehnai",midiProgram:111,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"light",algorithm:"1←(2 3 4)",feedbackType:"1⟲",feedbackAmplitude:3,feedbackEnvelope:"steady",operators:[{frequency:"4×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:8,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"oboe",midiProgram:68,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"swell 1",vibrato:"none",algorithm:"1 2←(3 4)",feedbackType:"2⟲",feedbackAmplitude:2,feedbackEnvelope:"tremolo5",operators:[{frequency:"1×",amplitude:7,envelope:"custom"},{frequency:"4×",amplitude:12,envelope:"custom"},{frequency:"1×",amplitude:6,envelope:"steady"},{frequency:"6×",amplitude:2,envelope:"steady"}]}},{name:"english horn",midiProgram:69,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"steady",vibrato:"none",algorithm:"1 2←(3 4)",feedbackType:"2⟲",feedbackAmplitude:2,feedbackEnvelope:"steady",operators:[{frequency:"4×",amplitude:12,envelope:"custom"},{frequency:"2×",amplitude:10,envelope:"custom"},{frequency:"1×",amplitude:8,envelope:"punch"},{frequency:"8×",amplitude:4,envelope:"steady"}]}},{name:"bassoon",midiProgram:70,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:707,filterResonance:57,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1⟲",feedbackAmplitude:2,feedbackEnvelope:"steady",operators:[{frequency:"2×",amplitude:11,envelope:"custom"},{frequency:"1×",amplitude:6,envelope:"steady"},{frequency:"6×",amplitude:6,envelope:"swell 1"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"clarinet",midiProgram:71,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:1414,filterResonance:14,filterEnvelope:"steady",interval:"union",vibrato:"none",harmonics:[100,43,86,57,86,71,86,71,71,71,71,71,71,43,71,71,57,57,57,57,57,57,43,43,43,29,14,0]}},{name:"harmonica",midiProgram:22,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:5657,filterResonance:29,filterEnvelope:"swell 1",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1⟲",feedbackAmplitude:9,feedbackEnvelope:"tremolo5",operators:[{frequency:"2×",amplitude:14,envelope:"custom"},{frequency:"1×",amplitude:15,envelope:"steady"},{frequency:"~2×",amplitude:2,envelope:"twang 3"},{frequency:"1×",amplitude:0,envelope:"steady"}]}}])},{name:"Flute Presets",presets:m([{name:"flute 1",midiProgram:73,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:5657,filterResonance:14,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"4⟲",feedbackAmplitude:7,feedbackEnvelope:"decay 2",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"2×",amplitude:4,envelope:"steady"},{frequency:"1×",amplitude:3,envelope:"steady"},{frequency:"~1×",amplitude:1,envelope:"punch"}]}},{name:"recorder",midiProgram:74,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:4e3,filterResonance:29,filterEnvelope:"swell 2",interval:"union",vibrato:"none",harmonics:[100,43,57,43,57,43,43,43,43,43,43,43,43,29,29,29,29,29,29,29,14,14,14,14,14,14,14,0]}},{name:"whistle",midiProgram:78,generalMidi:!0,settings:{type:"harmonics",effects:"chorus & reverb",transition:"soft",chord:"harmony",filterCutoffHz:2e3,filterResonance:43,filterEnvelope:"steady",interval:"union",vibrato:"delayed",harmonics:[100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},{name:"ocarina",midiProgram:79,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:2828,filterResonance:43,filterEnvelope:"steady",interval:"union",vibrato:"none",harmonics:[100,14,57,14,29,14,14,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},{name:"piccolo",midiProgram:72,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:5657,filterResonance:43,filterEnvelope:"steady",vibrato:"none",algorithm:"1←3 2←4",feedbackType:"4⟲",feedbackAmplitude:15,feedbackEnvelope:"twang 1",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:10,envelope:"custom"},{frequency:"~2×",amplitude:3,envelope:"punch"},{frequency:"~1×",amplitude:5,envelope:"punch"}]}},{name:"shakuhachi",midiProgram:77,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"soft",chord:"harmony",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"steady",vibrato:"delayed",algorithm:"1←(2 3←4)",feedbackType:"3→4",feedbackAmplitude:15,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"2×",amplitude:3,envelope:"punch"},{frequency:"~1×",amplitude:4,envelope:"twang 1"},{frequency:"20×",amplitude:15,envelope:"steady"}]}},{name:"pan flute",midiProgram:75,generalMidi:!0,settings:{type:"spectrum",effects:"reverb",transition:"soft",chord:"harmony",filterCutoffHz:8e3,filterResonance:43,filterEnvelope:"steady",spectrum:[100,0,0,0,0,0,0,14,0,0,0,71,0,0,14,0,57,0,29,14,29,14,14,29,14,29,14,14,29,14]}},{name:"blown bottle",midiProgram:76,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:5657,filterResonance:57,filterEnvelope:"steady",vibrato:"none",algorithm:"1 2 3 4",feedbackType:"1⟲ 2⟲ 3⟲ 4⟲",feedbackAmplitude:7,feedbackEnvelope:"twang 1",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"3×",amplitude:4,envelope:"custom"},{frequency:"6×",amplitude:2,envelope:"custom"},{frequency:"11×",amplitude:2,envelope:"custom"}]}},{name:"calliope",midiProgram:82,generalMidi:!0,settings:{type:"spectrum",transition:"cross fade",effects:"reverb",chord:"harmony",filterCutoffHz:5657,filterResonance:14,filterEnvelope:"steady",spectrum:[100,0,0,0,0,0,0,86,0,0,0,71,0,0,57,0,43,0,29,14,14,29,14,14,14,14,14,14,14,14]}},{name:"chiffer",midiProgram:83,generalMidi:!0,settings:{type:"spectrum",effects:"reverb",transition:"hard",chord:"harmony",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"punch",spectrum:[86,0,0,0,0,0,0,71,0,0,0,71,0,0,57,0,57,0,43,14,14,43,14,29,14,29,29,29,29,14]}},{name:"breath noise",midiProgram:121,generalMidi:!0,settings:{type:"spectrum",effects:"reverb",transition:"cross fade",chord:"strum",filterCutoffHz:5657,filterResonance:14,filterEnvelope:"twang 1",spectrum:[71,0,0,0,0,0,0,29,0,0,0,71,0,0,29,0,100,29,14,29,100,29,100,14,14,71,0,29,0,0]}},{name:"flute 2",midiProgram:73,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"seamless",chord:"harmony",filterCutoffHz:1414,filterResonance:14,filterEnvelope:"steady",interval:"union",vibrato:"delayed",harmonics:[100,43,86,57,86,71,86,71,71,71,71,71,71,43,71,71,57,57,57,57,57,57,43,43,43,29,14,0]}}])},{name:"Pad Presets",presets:m([{name:"new age pad",midiProgram:88,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:8e3,filterResonance:43,filterEnvelope:"twang 3",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1⟲ 2⟲",feedbackAmplitude:3,feedbackEnvelope:"swell 3",operators:[{frequency:"2×",amplitude:14,envelope:"custom"},{frequency:"~1×",amplitude:4,envelope:"swell 2"},{frequency:"6×",amplitude:3,envelope:"twang 3"},{frequency:"13×",amplitude:3,envelope:"steady"}]}},{name:"warm pad",midiProgram:89,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"soft fade",chord:"harmony",filterCutoffHz:2828,filterResonance:29,filterEnvelope:"swell 3",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"1⟲",feedbackAmplitude:7,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:14,envelope:"custom"},{frequency:"1×",amplitude:6,envelope:"swell 1"},{frequency:"1×",amplitude:0,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"polysynth pad",midiProgram:90,generalMidi:!0,settings:{type:"chip",transition:"hard fade",effects:"chorus & reverb",chord:"harmony",filterCutoffHz:2828,filterResonance:43,filterEnvelope:"twang 3",wave:"sawtooth",interval:"hum",vibrato:"delayed"}},{name:"space voice pad",midiProgram:91,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"medium fade",chord:"harmony",filterCutoffHz:4e3,filterResonance:71,filterEnvelope:"steady",vibrato:"none",algorithm:"(1 2 3)←4",feedbackType:"1⟲ 2⟲ 3⟲ 4⟲",feedbackAmplitude:5,feedbackEnvelope:"swell 2",operators:[{frequency:"1×",amplitude:10,envelope:"custom"},{frequency:"2×",amplitude:8,envelope:"custom"},{frequency:"3×",amplitude:7,envelope:"custom"},{frequency:"11×",amplitude:1,envelope:"punch"}]}},{name:"bowed glass pad",midiProgram:92,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"soft fade",chord:"harmony",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"twang 3",vibrato:"none",algorithm:"1←3 2←4",feedbackType:"1⟲ 2⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:10,envelope:"custom"},{frequency:"2×",amplitude:12,envelope:"custom"},{frequency:"3×",amplitude:7,envelope:"twang 3"},{frequency:"7×",amplitude:4,envelope:"flare 3"}]}},{name:"metallic pad",midiProgram:93,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"medium fade",chord:"harmony",filterCutoffHz:5657,filterResonance:14,filterEnvelope:"twang 3",vibrato:"none",algorithm:"1←3 2←4",feedbackType:"1⟲ 2⟲",feedbackAmplitude:13,feedbackEnvelope:"twang 3",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"~1×",amplitude:9,envelope:"custom"},{frequency:"1×",amplitude:7,envelope:"swell 2"},{frequency:"11×",amplitude:7,envelope:"steady"}]}},{name:"sweep pad",midiProgram:95,generalMidi:!0,settings:{type:"chip",effects:"chorus & reverb",transition:"soft fade",chord:"harmony",filterCutoffHz:4e3,filterResonance:86,filterEnvelope:"flare 3",wave:"sawtooth",interval:"hum",vibrato:"none"}},{name:"atmosphere",midiProgram:99,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"hard fade",chord:"strum",filterCutoffHz:4e3,filterResonance:29,filterEnvelope:"steady",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"3⟲ 4⟲",feedbackAmplitude:3,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:14,envelope:"custom"},{frequency:"1×",amplitude:10,envelope:"swell 3"},{frequency:"3×",amplitude:7,envelope:"twang 2"},{frequency:"1×",amplitude:7,envelope:"twang 3"}]}},{name:"brightness",midiProgram:100,generalMidi:!0,settings:{type:"harmonics",effects:"chorus & reverb",transition:"medium fade",chord:"harmony",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"twang 3",interval:"octave",vibrato:"none",harmonics:[100,86,86,86,43,57,43,71,43,43,43,57,43,43,57,71,57,43,29,43,57,57,43,29,29,29,29,14]}},{name:"goblins",midiProgram:101,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"soft fade",chord:"harmony",filterCutoffHz:1414,filterResonance:14,filterEnvelope:"swell 2",vibrato:"none",algorithm:"1←2←3←4",feedbackType:"1⟲",feedbackAmplitude:10,feedbackEnvelope:"flare 3",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"4×",amplitude:5,envelope:"swell 3"},{frequency:"1×",amplitude:10,envelope:"tremolo1"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"sci-fi",midiProgram:103,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"medium fade",chord:"harmony",filterCutoffHz:5657,filterResonance:14,filterEnvelope:"twang 3",vibrato:"none",algorithm:"(1 2)←3←4",feedbackType:"1⟲ 2⟲ 3⟲ 4⟲",feedbackAmplitude:8,feedbackEnvelope:"twang 3",operators:[{frequency:"~1×",amplitude:13,envelope:"custom"},{frequency:"2×",amplitude:10,envelope:"custom"},{frequency:"5×",amplitude:5,envelope:"twang 3"},{frequency:"11×",amplitude:8,envelope:"tremolo5"}]}},{name:"flutter pad",midiProgram:90,settings:{type:"FM",effects:"chorus & reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:4e3,filterResonance:86,filterEnvelope:"twang 3",vibrato:"delayed",algorithm:"(1 2)←(3 4)",feedbackType:"1⟲ 2⟲ 3⟲",feedbackAmplitude:9,feedbackEnvelope:"steady",operators:[{frequency:"1×",amplitude:13,envelope:"custom"},{frequency:"5×",amplitude:7,envelope:"custom"},{frequency:"7×",amplitude:5,envelope:"tremolo1"},{frequency:"~1×",amplitude:6,envelope:"punch"}]}},{name:"feedback pad",midiProgram:89,settings:{type:"FM",effects:"reverb",transition:"soft fade",chord:"custom interval",filterCutoffHz:8e3,filterResonance:0,filterEnvelope:"steady",vibrato:"none",algorithm:"1 2 3 4",feedbackType:"1⟲ 2⟲ 3⟲ 4⟲",feedbackAmplitude:7,feedbackEnvelope:"swell 2",operators:[{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"1×",amplitude:15,envelope:"custom"},{frequency:"~1×",amplitude:15,envelope:"custom"}]}}])},{name:"Drum Presets",presets:m([{name:"standard drumset",midiProgram:116,isNoise:!0,settings:{type:"drumset",effects:"reverb",drums:[{filterEnvelope:"twang 1",spectrum:[57,71,71,86,86,86,71,71,71,71,57,57,57,57,43,43,43,43,29,29,29,29,29,29,29,29,29,29,29,29]},{filterEnvelope:"twang 1",spectrum:[0,0,0,100,71,71,57,86,57,57,57,71,43,43,57,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43]},{filterEnvelope:"twang 1",spectrum:[0,0,0,0,100,57,43,43,29,57,43,29,71,43,43,43,43,57,43,43,43,43,43,43,43,43,29,43,43,43]},{filterEnvelope:"twang 1",spectrum:[0,0,0,0,0,71,57,43,43,43,57,57,43,29,57,43,43,43,29,43,57,43,43,43,43,43,43,29,43,43]},{filterEnvelope:"decay 2",spectrum:[0,14,29,43,86,71,29,43,43,43,43,29,71,29,71,29,43,43,43,43,57,43,43,57,43,43,43,57,57,57]},{filterEnvelope:"decay 1",spectrum:[0,0,14,14,14,14,29,29,29,43,43,43,57,57,57,71,71,71,71,71,71,71,71,57,57,57,57,43,43,43]},{filterEnvelope:"twang 3",spectrum:[43,43,43,71,29,29,43,43,43,29,43,43,43,29,29,43,43,29,29,29,57,14,57,43,43,57,43,43,57,57]},{filterEnvelope:"decay 3",spectrum:[29,43,43,43,43,29,29,43,29,29,43,29,14,29,43,29,43,29,57,29,43,57,43,71,43,71,57,57,71,71]},{filterEnvelope:"twang 3",spectrum:[43,29,29,43,29,29,29,57,29,29,29,57,43,43,29,29,57,43,43,43,71,43,43,71,57,71,71,71,71,71]},{filterEnvelope:"decay 3",spectrum:[57,57,57,43,57,57,43,43,57,43,43,43,71,57,43,57,86,71,57,86,71,57,86,100,71,86,86,86,86,86]},{filterEnvelope:"flare 1",spectrum:[0,0,14,14,14,14,29,29,29,43,43,43,57,57,71,71,86,86,100,100,100,100,100,100,100,100,86,57,29,0]},{filterEnvelope:"decay 2",spectrum:[14,14,14,14,29,14,14,29,14,43,14,43,57,86,57,57,100,57,43,43,57,100,57,43,29,14,0,0,0,0]}]}},{name:"steel pan",midiProgram:114,generalMidi:!0,settings:{type:"FM",effects:"chorus & reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:2828,filterResonance:0,filterEnvelope:"decay 2",vibrato:"none",algorithm:"1←(2 3←4)",feedbackType:"1⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"~1×",amplitude:14,envelope:"custom"},{frequency:"7×",amplitude:3,envelope:"flare 1"},{frequency:"3×",amplitude:5,envelope:"flare 2"},{frequency:"4×",amplitude:4,envelope:"swell 2"}]}},{name:"steel pan synth",midiProgram:114,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"harmony",filterCutoffHz:2828,filterResonance:0,filterEnvelope:"twang 1",vibrato:"none",algorithm:"1 2 3←4",feedbackType:"1⟲",feedbackAmplitude:5,feedbackEnvelope:"flare 1",operators:[{frequency:"~1×",amplitude:12,envelope:"custom"},{frequency:"2×",amplitude:15,envelope:"custom"},{frequency:"4×",amplitude:14,envelope:"flare 1"},{frequency:"~1×",amplitude:3,envelope:"flare 2"}]}},{name:"timpani",midiProgram:47,generalMidi:!0,settings:{type:"spectrum",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:4e3,filterResonance:29,filterEnvelope:"twang 2",spectrum:[100,0,0,0,86,0,0,71,0,14,43,14,43,43,0,29,43,29,29,29,43,29,43,29,43,43,43,43,43,43]}},{name:"dark strike",midiProgram:47,settings:{type:"spectrum",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:4e3,filterResonance:29,filterEnvelope:"twang 2",spectrum:[0,0,0,0,14,14,14,29,29,43,43,86,43,43,43,29,86,29,29,29,86,29,14,14,14,14,0,0,0,0]}},{name:"woodblock",midiProgram:115,generalMidi:!0,isNoise:!0,midiSubharmonicOctaves:-2.5,settings:{type:"spectrum",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2828,filterResonance:14,filterEnvelope:"twang 1",spectrum:[0,14,29,43,43,57,86,86,71,57,57,43,43,57,86,86,43,43,71,57,57,57,57,57,86,86,71,71,71,71]}},{name:"taiko drum",midiProgram:116,generalMidi:!0,isNoise:!0,midiSubharmonicOctaves:-.5,settings:{type:"spectrum",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2828,filterResonance:29,filterEnvelope:"twang 1",spectrum:[71,100,100,43,43,71,71,43,43,43,43,43,43,57,29,57,43,57,43,43,57,43,43,43,43,43,43,43,43,43]}},{name:"melodic drum",midiProgram:117,generalMidi:!0,isNoise:!0,midiSubharmonicOctaves:-1.5,settings:{type:"spectrum",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2828,filterResonance:43,filterEnvelope:"twang 1",spectrum:[100,71,71,57,57,43,43,71,43,43,43,57,43,43,57,43,43,43,43,29,29,29,29,29,29,29,29,29,29,29]}},{name:"drum synth",midiProgram:118,generalMidi:!0,isNoise:!0,midiSubharmonicOctaves:-2,settings:{type:"spectrum",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:4e3,filterResonance:43,filterEnvelope:"decay 1",spectrum:[100,86,71,57,43,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29]}},{name:"tom-tom",midiProgram:116,isNoise:!0,midiSubharmonicOctaves:-1,settings:{type:"spectrum",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"twang 1",spectrum:[100,29,14,0,0,86,14,43,29,86,29,14,29,57,43,43,43,43,57,43,43,43,29,57,43,43,43,43,43,43]}},{name:"metal pipe",midiProgram:117,isNoise:!0,midiSubharmonicOctaves:-1.5,settings:{type:"spectrum",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:8e3,filterResonance:14,filterEnvelope:"twang 2",spectrum:[29,43,86,43,43,43,43,43,100,29,14,14,100,14,14,0,0,0,0,0,14,29,29,14,0,0,14,29,0,0]}}])},{name:"Novelty Presets",presets:m([{name:"guitar fret noise",midiProgram:120,generalMidi:!0,settings:{type:"spectrum",effects:"reverb",transition:"hard",chord:"harmony",filterCutoffHz:8e3,filterResonance:86,filterEnvelope:"flare 1",spectrum:[0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,29,14,0,0,43,0,43,0,71,43,0,57,0]}},{name:"fifth saw lead",midiProgram:86,generalMidi:!0,midiSubharmonicOctaves:1,settings:{type:"chip",effects:"chorus & reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:2828,filterResonance:57,filterEnvelope:"twang 3",wave:"sawtooth",interval:"fifth",vibrato:"none"}},{name:"fifth swell",midiProgram:86,midiSubharmonicOctaves:1,settings:{type:"chip",effects:"chorus & reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:57,filterEnvelope:"swell 3",wave:"sawtooth",interval:"fifth",vibrato:"none"}},{name:"soundtrack",midiProgram:97,generalMidi:!0,settings:{type:"chip",effects:"chorus & reverb",transition:"soft fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"flare 3",wave:"sawtooth",interval:"fifth",vibrato:"none"}},{name:"reverse cymbal",midiProgram:119,generalMidi:!0,isNoise:!0,midiSubharmonicOctaves:-3,settings:{type:"spectrum",effects:"none",transition:"soft",chord:"harmony",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"swell 3",spectrum:[29,57,57,29,57,57,29,29,43,29,29,43,29,29,57,57,14,57,14,57,71,71,57,86,57,100,86,86,86,86]}},{name:"seashore",midiProgram:122,generalMidi:!0,isNoise:!0,midiSubharmonicOctaves:-3,settings:{type:"spectrum",transition:"soft fade",effects:"reverb",chord:"harmony",filterCutoffHz:2828,filterResonance:0,filterEnvelope:"swell 3",spectrum:[14,14,29,29,43,43,43,57,57,57,57,57,57,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,57]}},{name:"bird tweet",midiProgram:123,generalMidi:!0,settings:{type:"harmonics",effects:"reverb",transition:"soft",chord:"strum",filterCutoffHz:2828,filterResonance:0,filterEnvelope:"decay 1",interval:"hum",vibrato:"heavy",harmonics:[0,0,14,100,14,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},{name:"telephone ring",midiProgram:124,generalMidi:!0,settings:{type:"FM",effects:"reverb",transition:"hard",chord:"arpeggio",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"tremolo4",vibrato:"none",algorithm:"1←(2 3 4)",feedbackType:"1⟲",feedbackAmplitude:2,feedbackEnvelope:"steady",operators:[{frequency:"2×",amplitude:12,envelope:"custom"},{frequency:"1×",amplitude:4,envelope:"tremolo1"},{frequency:"20×",amplitude:1,envelope:"steady"},{frequency:"1×",amplitude:0,envelope:"steady"}]}},{name:"helicopter",midiProgram:125,generalMidi:!0,isNoise:!0,midiSubharmonicOctaves:-.5,settings:{type:"spectrum",effects:"reverb",transition:"seamless",chord:"arpeggio",filterCutoffHz:1414,filterResonance:14,filterEnvelope:"tremolo4",spectrum:[14,43,43,57,57,57,71,71,71,71,86,86,86,86,86,86,86,86,86,86,86,71,71,71,71,71,71,71,57,57]}},{name:"applause",midiProgram:126,generalMidi:!0,isNoise:!0,midiSubharmonicOctaves:-3,settings:{type:"spectrum",effects:"reverb",transition:"soft fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"swell 3",spectrum:[14,14,29,29,29,43,43,57,71,71,86,86,86,71,71,57,57,57,71,86,86,86,86,86,71,71,57,57,57,57]}},{name:"gunshot",midiProgram:127,generalMidi:!0,isNoise:!0,midiSubharmonicOctaves:-2,settings:{type:"spectrum",effects:"reverb",transition:"hard fade",chord:"strum",filterCutoffHz:1414,filterResonance:29,filterEnvelope:"twang 1",spectrum:[14,29,43,43,57,57,57,71,71,71,86,86,86,86,86,86,86,86,86,86,86,71,71,71,71,57,57,57,57,43]}},{name:"scoot",midiProgram:92,settings:{type:"chip",transition:"hard",effects:"reverb",chord:"harmony",filterCutoffHz:707,filterResonance:86,filterEnvelope:"flare 1",wave:"sawtooth",interval:"shimmer",vibrato:"none"}},{name:"buzz saw",midiProgram:30,settings:{type:"FM",effects:"reverb",transition:"soft",chord:"custom interval",filterCutoffHz:2e3,filterResonance:0,filterEnvelope:"steady",vibrato:"none",algorithm:"1←2←3←4",feedbackType:"1⟲",feedbackAmplitude:0,feedbackEnvelope:"steady",operators:[{frequency:"5×",amplitude:13,envelope:"custom"},{frequency:"1×",amplitude:10,envelope:"steady"},{frequency:"~1×",amplitude:6,envelope:"steady"},{frequency:"11×",amplitude:12,envelope:"steady"}]}},{name:"mosquito",midiProgram:93,settings:{type:"PWM",effects:"reverb",transition:"cross fade",chord:"harmony",filterCutoffHz:2828,filterResonance:57,filterEnvelope:"steady",pulseWidth:4,pulseEnvelope:"tremolo6",vibrato:"shaky"}},{name:"breathing",midiProgram:126,isNoise:!0,midiSubharmonicOctaves:-1,settings:{type:"spectrum",effects:"reverb",transition:"hard fade",chord:"harmony",filterCutoffHz:2e3,filterResonance:14,filterEnvelope:"swell 2",spectrum:[14,14,14,29,29,29,29,29,43,29,29,43,43,43,29,29,71,43,86,86,57,100,86,86,86,86,71,86,71,57]}},{name:"klaxon synth",midiProgram:125,isNoise:!0,midiSubharmonicOctaves:-1,settings:{type:"noise",effects:"reverb",transition:"slide",chord:"harmony",filterCutoffHz:2e3,filterResonance:86,filterEnvelope:"steady",wave:"buzz"}},{name:"theremin",midiProgram:40,settings:{type:"harmonics",effects:"reverb",transition:"slide",chord:"harmony",filterCutoffHz:4e3,filterResonance:14,filterEnvelope:"steady",interval:"union",vibrato:"heavy",harmonics:[100,71,57,43,29,29,14,14,14,14,14,14,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},{name:"sonar ping",midiProgram:121,settings:{type:"spectrum",effects:"reverb",transition:"medium fade",chord:"harmony",filterCutoffHz:1414,filterResonance:14,filterEnvelope:"twang 2",spectrum:[100,43,29,29,14,14,14,14,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}])}]);class B{constructor(){this.h=1,this.m=[void 0],this.p=0,this.u=0,this.v=0}pushFront(t){this.v>=this.h&&this.g(),this.u=this.u-1&this.p,this.m[this.u]=t,this.v++}pushBack(t){this.v>=this.h&&this.g(),this.m[this.u+this.v&this.p]=t,this.v++}popFront(){if(this.v<=0)throw new Error("No elements left to pop.");const t=this.m[this.u];return this.m[this.u]=void 0,this.u=this.u+1&this.p,this.v--,t}popBack(){if(this.v<=0)throw new Error("No elements left to pop.");this.v--;const t=this.u+this.v&this.p,e=this.m[t];return this.m[t]=void 0,e}peakFront(){if(this.v<=0)throw new Error("No elements left to pop.");return this.m[this.u]}peakBack(){if(this.v<=0)throw new Error("No elements left to pop.");return this.m[this.u+this.v-1&this.p]}count(){return this.v}set(t,e){if(t<0||t>=this.v)throw new Error("Invalid index");this.m[this.u+t&this.p]=e}get(t){if(t<0||t>=this.v)throw new Error("Invalid index");return this.m[this.u+t&this.p]}remove(t){if(t<0||t>=this.v)throw new Error("Invalid index");if(t<=this.v>>1){for(;t>0;)this.set(t,this.get(t-1)),t--;this.popFront()}else{for(t++;t<this.v;)this.set(t-1,this.get(t)),t++;this.popBack()}}g(){if(this.h>=1073741824)throw new Error("Capacity too big.");this.h=this.h<<1;const t=this.m,e=new Array(this.h),n=0|this.v,i=0|this.u;for(let a=0;a<n;a++)e[a]=t[i+a&this.p];for(let t=n;t<this.h;t++)e[t]=void 0;this.u=0,this.m=e,this.p=this.h-1}}const D=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,45,95],N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,62,0,0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0,0,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,0,0,0,0,63,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,0,0,0,0,0];class O{constructor(t,e,n){this.k=[],this.M=0;for(let i=e;i<n;i++){const e=N[t.charCodeAt(i)];this.k.push(e>>5&1),this.k.push(e>>4&1),this.k.push(e>>3&1),this.k.push(e>>2&1),this.k.push(e>>1&1),this.k.push(1&e)}}read(t){let e=0;for(;t>0;)e<<=1,e+=this.k[this.M++],t--;return e}readLongTail(t,e){let n=t,i=e;for(;this.k[this.M++];)n+=1<<i,i++;for(;i>0;)i--,this.k[this.M++]&&(n+=1<<i);return n}readPartDuration(){return this.readLongTail(1,3)}readLegacyPartDuration(){return this.readLongTail(1,2)}readPinCount(){return this.readLongTail(1,0)}readPitchInterval(){return this.read(1)?-this.readLongTail(1,3):this.readLongTail(1,3)}}class I{constructor(){this.q=0,this.k=[]}clear(){this.q=0}write(t,e){for(t--;t>=0;)this.k[this.q++]=e>>>t&1,t--}writeLongTail(t,e,n){if(n<t)throw new Error("value out of bounds");n-=t;let i=e;for(;n>=1<<i;)this.k[this.q++]=1,n-=1<<i,i++;for(this.k[this.q++]=0;i>0;)i--,this.k[this.q++]=n>>>i&1}writePartDuration(t){this.writeLongTail(1,3,t)}writePinCount(t){this.writeLongTail(1,0,t)}writePitchInterval(t){t<0?(this.write(1,1),this.writeLongTail(1,3,-t)):(this.write(1,0),this.writeLongTail(1,3,t))}concat(t){for(let e=0;e<t.q;e++)this.k[this.q++]=t.k[e]}encodeBase64(t){for(let e=0;e<this.q;e+=6){const n=this.k[e]<<5|this.k[e+1]<<4|this.k[e+2]<<3|this.k[e+3]<<2|this.k[e+4]<<1|this.k[e+5];t.push(D[n])}return t}lengthBase64(){return Math.ceil(this.q/6)}}function L(t,e,n){return{interval:t,time:e,volume:n}}function W(t,e,n){return n<=(e-=1)?n>=t?n:t:e}function V(t,e,n){if(t<=n&&n<=e)return n;throw new Error(`Value ${n} not in range [${t}, ${e}]`)}class U{constructor(t,e,n,i,a=!1){this.pitches=[t],this.pins=[L(0,0,i),L(0,n-e,a?0:i)],this.start=e,this.end=n}pickMainInterval(){let t=0,e=0;for(let n=1;n<this.pins.length;n++){const i=this.pins[n-1],a=this.pins[n];if(i.interval==a.interval){const n=a.time-i.time;t<n&&(t=n,e=i.interval)}}if(0==t){let t=0;for(let n=0;n<this.pins.length;n++){const i=this.pins[n];t<i.volume&&(t=i.volume,e=i.interval)}}return e}clone(){const t=new U(-1,this.start,this.end,6);t.pitches=this.pitches.concat(),t.pins=[];for(const e of this.pins)t.pins.push(L(e.interval,e.time,e.volume));return t}}class j{constructor(){this.notes=[],this.instrument=0}cloneNotes(){const t=[];for(const e of this.notes)t.push(e.clone());return t}reset(){this.notes.length=0,this.instrument=0}}class ${constructor(t){this.frequency=0,this.amplitude=0,this.envelope=0,this.waveform=0,this.reset(t)}reset(t){this.frequency=0,this.amplitude=t<=1?e.operatorAmplitudeMax:0,this.envelope=0==t?0:1,this.waveform=0}copy(t){this.frequency=t.frequency,this.amplitude=t.amplitude,this.envelope=t.envelope,this.waveform=t.waveform}}class G{constructor(t){this.spectrum=[],this.P=null,this.S=!1,this.reset(t)}reset(t){for(let n=0;n<e.spectrumControlPoints;n++)if(t)this.spectrum[n]=Math.round(e.spectrumMax*(1/Math.sqrt(1+n/3)));else{const t=0==n||7==n||11==n||14==n||16==n||18==n||21==n||23==n||n>=25;this.spectrum[n]=t?Math.max(0,Math.round(e.spectrumMax*(1-n/30))):0}this.S=!1}markCustomWaveDirty(){this.S=!1}getCustomWave(t){if(!this.S||null==this.P){let i=e.chipNoiseLength;null!=this.P&&this.P.length==i+1||(this.P=new Float32Array(i+1));const a=this.P;for(let t=0;t<i;t++)a[t]=0;const s=14,o=.25,l=[0,1/7,Math.log(5/4)/Math.LN2,3/7,Math.log(1.5)/Math.LN2,5/7,6/7];function n(n){return t+Math.floor(n/e.spectrumControlPointsPerOctave)+l[(n+e.spectrumControlPointsPerOctave)%e.spectrumControlPointsPerOctave]}let c=1;for(let t=0;t<e.spectrumControlPoints+1;t++){const i=t<=0?0:this.spectrum[t-1],l=t>=e.spectrumControlPoints?this.spectrum[e.spectrumControlPoints-1]:this.spectrum[t],h=n(t-1);let m=n(t);t>=e.spectrumControlPoints&&(m=s+(m-s)*o),0==i&&0==l||(c+=.02*r(a,h,m,i/e.spectrumMax,l/e.spectrumMax,-.5))}this.spectrum[e.spectrumControlPoints-1]>0&&(c+=.02*r(a,s+(n(e.spectrumControlPoints)-s)*o,s,this.spectrum[e.spectrumControlPoints-1]/e.spectrumMax,0,-.5)),H(a,i),A(a,5/(Math.sqrt(i)*Math.pow(c,.75))),a[i]=a[0],this.S=!0}return this.P}}class K{constructor(){this.harmonics=[],this.P=null,this.S=!1,this.reset()}reset(){for(let t=0;t<e.harmonicsControlPoints;t++)this.harmonics[t]=0;this.harmonics[0]=e.harmonicsMax,this.harmonics[3]=e.harmonicsMax,this.harmonics[6]=e.harmonicsMax,this.S=!1}markCustomWaveDirty(){this.S=!1}getCustomWave(){if(!this.S||null==this.P){let t=e.harmonicsWavelength;const n=a(0);null!=this.P&&this.P.length==t+1||(this.P=new Float32Array(t+1));const i=this.P;for(let e=0;e<t;e++)i[e]=0;const r=-.25;let s=1;for(let a=0;a<e.harmonicsRendered;a++){const o=a+1;let l=a<e.harmonicsControlPoints?this.harmonics[a]:this.harmonics[e.harmonicsControlPoints-1];a>=e.harmonicsControlPoints&&(l*=1-(a-e.harmonicsControlPoints)/(e.harmonicsRendered-e.harmonicsControlPoints));const c=l/e.harmonicsMax;let h=Math.pow(2,l-e.harmonicsMax+1)*Math.sqrt(c);a<e.harmonicsControlPoints&&(s+=h),h*=Math.pow(o,r),h*=n[a+589],i[t-o]=h}H(i,t);const o=1/Math.pow(s,.7);let l=0,c=0;for(let t=0;t<i.length;t++)l+=c,c=i[t]*o,i[t]=l;i[t]=i[0],this.S=!0}return this.P}}class _{constructor(t,n){if(this.type=0,this.preset=0,this.chipWave=2,this.chipNoise=1,this.filterCutoff=12,this.filterResonance=0,this.filterEnvelope=1,this.transition=1,this.vibrato=0,this.vibratoDepth=0,this.vibratoSpeed=10,this.vibratoDelay=0,this.vibratoType=0,this.interval=0,this.effects=0,this.chord=1,this.volume=0,this.pan=e.panCenter,this.panDelay=10,this.arpeggioSpeed=12,this.fastTwoNoteArp=!1,this.tieNoteTransition=!1,this.clicklessTransition=!1,this.detune=0,this.pulseWidth=e.pulseWidthRange,this.pulseEnvelope=1,this.algorithm=0,this.feedbackType=0,this.feedbackAmplitude=0,this.feedbackEnvelope=1,this.LFOtime=0,this.nextLFOtime=0,this.arpTime=0,this.customChipWave=new Float64Array(64),this.customChipWaveIntegral=new Float64Array(65),this.operators=[],this.harmonicsWave=new K,this.drumsetEnvelopes=[],this.drumsetSpectrumWaves=[],this.modChannels=[],this.modStatuses=[],this.modInstruments=[],this.modSettings=[],n)for(let t=0;t<e.modCount;t++)this.modChannels.push(0),this.modStatuses.push(Q.msNone),this.modInstruments.push(0),this.modSettings.push(J.mstNone);this.spectrumWave=new G(t);for(let t=0;t<e.operatorCount;t++)this.operators[t]=new $(t);for(let t=0;t<e.drumCount;t++)this.drumsetEnvelopes[t]=e.envelopes.dictionary["twang 2"].index,this.drumsetSpectrumWaves[t]=new G(!0);for(let t=0;t<64;t++)this.customChipWave[t]=24-Math.floor(.75*t);let i=0;for(let t=0;t<this.customChipWave.length;t++)i+=this.customChipWave[t];const a=i/this.customChipWave.length;let r=0,s=0;for(let t=0;t<this.customChipWave.length;t++)r+=s,s=this.customChipWave[t]-a,this.customChipWaveIntegral[t]=r;this.customChipWaveIntegral[64]=0}setTypeAndReset(t,n,i){switch(i&&(t=8),this.type=t,this.preset=t,this.volume=0,this.pan=e.panCenter,this.panDelay=10,this.arpeggioSpeed=12,this.detune=0,this.tieNoteTransition=!1,this.clicklessTransition=!1,t){case 0:this.chipWave=2,this.filterCutoff=6,this.filterResonance=0,this.filterEnvelope=e.envelopes.dictionary.steady.index,this.transition=1,this.vibrato=0,this.interval=0,this.effects=1,this.chord=2;break;case 7:this.chipWave=2,this.filterCutoff=6,this.filterResonance=0,this.filterEnvelope=e.envelopes.dictionary.steady.index,this.transition=1,this.vibrato=0,this.interval=0,this.effects=1,this.chord=2;for(let t=0;t<64;t++)this.customChipWave[t]=24-Math.floor(.75*t);let i=0;for(let t=0;t<this.customChipWave.length;t++)i+=this.customChipWave[t];const a=i/this.customChipWave.length;let r=0,s=0;for(let t=0;t<this.customChipWave.length;t++)r+=s,s=this.customChipWave[t]-a,this.customChipWaveIntegral[t]=r;this.customChipWaveIntegral[64]=0;break;case 1:this.transition=1,this.vibrato=0,this.effects=1,this.chord=3,this.filterCutoff=10,this.filterResonance=0,this.filterEnvelope=1,this.algorithm=0,this.feedbackType=0,this.feedbackAmplitude=0,this.feedbackEnvelope=e.envelopes.dictionary.steady.index;for(let t=0;t<this.operators.length;t++)this.operators[t].reset(t);break;case 2:this.chipNoise=1,this.transition=1,this.effects=0,this.chord=2,this.filterCutoff=10,this.filterResonance=0,this.filterEnvelope=e.envelopes.dictionary.steady.index;break;case 3:this.transition=1,this.effects=1,this.chord=0,this.filterCutoff=10,this.filterResonance=0,this.filterEnvelope=e.envelopes.dictionary.steady.index,this.spectrumWave.reset(n);break;case 4:this.effects=0;for(let t=0;t<e.drumCount;t++)this.drumsetEnvelopes[t]=e.envelopes.dictionary["twang 2"].index,null==this.drumsetSpectrumWaves[t]&&(this.drumsetSpectrumWaves[t]=new G(!0)),this.drumsetSpectrumWaves[t].reset(n);break;case 5:this.filterCutoff=10,this.filterResonance=0,this.filterEnvelope=e.envelopes.dictionary.steady.index,this.transition=1,this.vibrato=0,this.interval=0,this.effects=1,this.chord=0,this.harmonicsWave.reset();break;case 6:this.filterCutoff=10,this.filterResonance=0,this.filterEnvelope=e.envelopes.dictionary.steady.index,this.transition=1,this.vibrato=0,this.interval=0,this.effects=1,this.chord=2,this.pulseWidth=e.pulseWidthRange,this.pulseEnvelope=e.envelopes.dictionary["twang 2"].index;break;case 8:this.transition=0,this.vibrato=0,this.interval=0,this.effects=0,this.chord=0,this.modChannels=[],this.modStatuses=[],this.modInstruments=[],this.modSettings=[];for(let t=0;t<e.modCount;t++)this.modChannels.push(0),this.modStatuses.push(Q.msNone),this.modInstruments.push(0),this.modSettings.push(J.mstNone);break;default:throw new Error("Unrecognized instrument type: "+t)}}toJsonObject(){const t={type:e.instrumentTypeNames[this.type],volume:this.volume,pan:100*(this.pan-e.panCenter)/e.panCenter,panDelay:this.panDelay,arpeggioSpeed:this.arpeggioSpeed,fastTwoNoteArp:this.fastTwoNoteArp,tieNoteTransition:this.tieNoteTransition,clicklessTransition:this.clicklessTransition,vibrato:this.vibrato,vibratoDepth:this.vibratoDepth,vibratoDelay:this.vibratoDelay,vibratoSpeed:this.vibratoSpeed,vibratoType:this.vibratoType,detune:this.detune,effects:e.effectsNames[this.effects]};if(this.preset!=this.type&&(t.preset=this.preset),4!=this.type&&(t.transition=e.transitions[this.transition].name,t.chord=this.getChord().name,t.filterCutoffHz=Math.round(e.filterCutoffMaxHz*Math.pow(2,this.getFilterCutoffOctaves())),t.filterResonance=Math.round(100*this.filterResonance/(e.filterResonanceRange-1)),t.filterEnvelope=this.getFilterEnvelope().name),2==this.type)t.wave=e.chipNoises[this.chipNoise].name;else if(3==this.type){t.spectrum=[];for(let n=0;n<e.spectrumControlPoints;n++)t.spectrum[n]=Math.round(100*this.spectrumWave.spectrum[n]/e.spectrumMax)}else if(4==this.type){t.drums=[];for(let n=0;n<e.drumCount;n++){const i=[];for(let t=0;t<e.spectrumControlPoints;t++)i[t]=Math.round(100*this.drumsetSpectrumWaves[n].spectrum[t]/e.spectrumMax);t.drums[n]={filterEnvelope:this.getDrumsetEnvelope(n).name,spectrum:i}}}else if(0==this.type)t.wave=e.chipWaves[this.chipWave].name,t.interval=e.intervals[this.interval].name,5!=this.vibrato?t.vibrato=e.vibratos[this.vibrato].name:t.vibrato="custom";else if(7==this.type){t.wave=e.chipWaves[this.chipWave].name,t.interval=e.intervals[this.interval].name,5!=this.vibrato?t.vibrato=e.vibratos[this.vibrato].name:t.vibrato="custom",t.customChipWave=new Float64Array(64),t.customChipWaveIntegral=new Float64Array(65);for(let e=0;e<this.customChipWave.length;e++)t.customChipWave[e]=this.customChipWave[e];t.customChipWaveIntegral[64]=0}else if(6==this.type)t.pulseWidth=this.pulseWidth,t.pulseEnvelope=e.envelopes[this.pulseEnvelope].name,5!=this.vibrato?t.vibrato=e.vibratos[this.vibrato].name:t.vibrato="custom";else if(5==this.type){t.interval=e.intervals[this.interval].name,5!=this.vibrato?t.vibrato=e.vibratos[this.vibrato].name:t.vibrato="custom",t.harmonics=[];for(let n=0;n<e.harmonicsControlPoints;n++)t.harmonics[n]=Math.round(100*this.harmonicsWave.harmonics[n]/e.harmonicsMax)}else if(1==this.type){const n=[];for(const t of this.operators)n.push({frequency:e.operatorFrequencies[t.frequency].name,amplitude:t.amplitude,envelope:e.envelopes[t.envelope].name,waveform:e.operatorWaves[t.waveform].name});5!=this.vibrato?t.vibrato=e.vibratos[this.vibrato].name:t.vibrato="custom",t.algorithm=e.algorithms[this.algorithm].name,t.feedbackType=e.feedbacks[this.feedbackType].name,t.feedbackAmplitude=this.feedbackAmplitude,t.feedbackEnvelope=e.envelopes[this.feedbackEnvelope].name,t.operators=n}else{if(8!=this.type)throw new Error("Unrecognized instrument type");t.modChannels=[],t.modInstruments=[],t.modSettings=[],t.modStatuses=[];for(let n=0;n<e.modCount;n++)t.modChannels[n]=this.modChannels[n],t.modInstruments[n]=this.modInstruments[n],t.modSettings[n]=this.modSettings[n],t.modStatuses[n]=this.modStatuses[n]}return t}fromJsonObject(t,n,i,a,r){null==t&&(t={});let s=e.instrumentTypeNames.indexOf(t.type);-1==s&&(s=i?8:n?2:0),this.setTypeAndReset(s,n,i),null!=t.preset&&(this.preset=t.preset>>>0),null!=t.volume?this.volume=W(-e.volumeRange/2,e.volumeRange/2,0|t.volume):this.volume=0,null!=t.pan?this.pan=W(0,e.panMax+1,Math.round(e.panCenter+(0|t.pan)*e.panCenter/100)):this.pan=e.panCenter,null!=t.panDelay?this.panDelay=0|t.panDelay:this.panDelay=10,null!=t.detune?this.detune=W(e.detuneMin,e.detuneMax+1,0|t.detune):this.detune=0;const o={binary:0,sudden:1,smooth:2},l=t.transition||t.envelope;if(this.transition=null!=o[l]?o[l]:e.transitions.findIndex((t=>t.name==l)),-1==this.transition&&(this.transition=1),this.effects=e.effectsNames.indexOf(t.effects),-1==this.effects&&(this.effects=2==this.type?0:1),null!=t.filterCutoffHz?this.filterCutoff=W(0,e.filterCutoffRange,Math.round(e.filterCutoffRange-1+2*Math.log((0|t.filterCutoffHz)/e.filterCutoffMaxHz)/Math.LN2)):this.filterCutoff=0==this.type?6:10,null!=t.filterResonance?this.filterResonance=W(0,e.filterResonanceRange,Math.round((e.filterResonanceRange-1)*(0|t.filterResonance)/100)):this.filterResonance=0,this.filterEnvelope=e.envelopes.findIndex((e=>e.name==t.filterEnvelope)),-1==this.filterEnvelope&&(this.filterEnvelope=e.envelopes.dictionary.steady.index),null!=t.filter){const e=[20,12,6,0,16,10,4],n=[1,1,1,1,18,19,20],i=["none","bright","medium","soft","decay bright","decay medium","decay soft"],a={"sustain sharp":1,"sustain medium":2,"sustain soft":3,"decay sharp":4};let r=null!=a[t.filter]?a[t.filter]:i.indexOf(t.filter);-1==r&&(r=0),this.filterCutoff=e[r],this.filterEnvelope=n[r],this.filterResonance=0}const c=["none","vibrato light","vibrato delayed","vibrato heavy"];if(2==this.type)this.chipNoise=e.chipNoises.findIndex((e=>e.name==t.wave)),-1==this.chipNoise&&(this.chipNoise=1),this.chord=e.chords.findIndex((e=>e.name==t.chord)),-1==this.chord&&(this.chord=2);else if(3==this.type){if(null!=t.spectrum)for(let n=0;n<e.spectrumControlPoints;n++)this.spectrumWave.spectrum[n]=Math.max(0,Math.min(e.spectrumMax,Math.round(e.spectrumMax*+t.spectrum[n]/100)));this.chord=e.chords.findIndex((e=>e.name==t.chord)),-1==this.chord&&(this.chord=0)}else if(4==this.type){if(null!=t.drums)for(let n=0;n<e.drumCount;n++){const i=t.drums[n];if(null!=i&&(null!=i.filterEnvelope&&(this.drumsetEnvelopes[n]=e.envelopes.findIndex((t=>t.name==i.filterEnvelope)),-1==this.drumsetEnvelopes[n]&&(this.drumsetEnvelopes[n]=e.envelopes.dictionary["twang 2"].index)),null!=i.spectrum))for(let t=0;t<e.spectrumControlPoints;t++)this.drumsetSpectrumWaves[n].spectrum[t]=Math.max(0,Math.min(e.spectrumMax,Math.round(e.spectrumMax*+i.spectrum[t]/100)))}}else if(5==this.type){if(null!=t.harmonics)for(let n=0;n<e.harmonicsControlPoints;n++)this.harmonicsWave.harmonics[n]=Math.max(0,Math.min(e.harmonicsMax,Math.round(e.harmonicsMax*+t.harmonics[n]/100)));null!=t.interval&&(this.interval=e.intervals.findIndex((e=>e.name==t.interval)),-1==this.interval&&(this.interval=0)),null!=t.vibrato&&(this.vibrato=e.vibratos.findIndex((e=>e.name==t.vibrato)),-1==this.vibrato&&(this.vibrato=e.vibratos.length),this.vibrato==e.vibratos.length?(this.vibratoDepth=t.vibratoDepth,this.vibratoSpeed=t.vibratoSpeed,this.vibratoDelay=t.vibratoDelay,this.vibratoType=t.vibratoType):(this.vibratoDepth=e.vibratos[this.vibrato].amplitude,this.vibratoDelay=e.vibratos[this.vibrato].delayParts,this.vibratoSpeed=10,this.vibratoType=e.vibratos[this.vibrato].type)),this.chord=e.chords.findIndex((e=>e.name==t.chord)),-1==this.chord&&(this.chord=0)}else if(6==this.type)null!=t.pulseWidth?this.pulseWidth=W(0,e.pulseWidthRange+1,Math.round(t.pulseWidth)):this.pulseWidth=e.pulseWidthRange,null!=t.pulseEnvelope&&(this.pulseEnvelope=e.envelopes.findIndex((e=>e.name==t.pulseEnvelope)),-1==this.pulseEnvelope&&(this.pulseEnvelope=e.envelopes.dictionary.steady.index)),null!=t.vibrato&&(this.vibrato=e.vibratos.findIndex((e=>e.name==t.vibrato)),-1==this.vibrato&&(this.vibrato=e.vibratos.length),this.vibrato==e.vibratos.length?(this.vibratoDepth=t.vibratoDepth,this.vibratoSpeed=t.vibratoSpeed,this.vibratoDelay=t.vibratoDelay,this.vibratoType=t.vibratoType):(this.vibratoDepth=e.vibratos[this.vibrato].amplitude,this.vibratoDelay=e.vibratos[this.vibrato].delayParts,this.vibratoSpeed=10,this.vibratoType=e.vibratos[this.vibrato].type)),this.chord=e.chords.findIndex((e=>e.name==t.chord)),-1==this.chord&&(this.chord=0);else if(0==this.type){const n={triangle:1,square:2,"pulse wide":3,"pulse narrow":4,sawtooth:5,"double saw":6,"double pulse":7,spiky:8,plateau:0};if(this.chipWave=null!=n[t.wave]?n[t.wave]:e.chipWaves.findIndex((e=>e.name==t.wave)),-1==this.chipWave&&(this.chipWave=1),null!=t.interval)this.interval=e.intervals.findIndex((e=>e.name==t.interval)),-1==this.interval&&(this.interval=0);else if(null!=t.chorus){const n={fifths:5,octaves:6};this.interval=null!=n[t.chorus]?n[t.chorus]:e.intervals.findIndex((e=>e.name==t.chorus)),-1==this.interval&&(this.interval=0)}null!=t.vibrato?(this.vibrato=e.vibratos.findIndex((e=>e.name==t.vibrato)),-1==this.vibrato&&(this.vibrato=e.vibratos.length),this.vibrato==e.vibratos.length?(this.vibratoDepth=t.vibratoDepth,this.vibratoSpeed=t.vibratoSpeed,this.vibratoDelay=t.vibratoDelay,this.vibratoType=t.vibratoType):(this.vibratoDepth=e.vibratos[this.vibrato].amplitude,this.vibratoDelay=e.vibratos[this.vibrato].delayParts,this.vibratoSpeed=10,this.vibratoType=e.vibratos[this.vibrato].type)):null!=t.effect&&(this.vibrato=c.indexOf(t.effect),-1==this.vibrato&&(this.vibrato=0)),this.chord=e.chords.findIndex((e=>e.name==t.chord)),-1==this.chord&&(this.chord=2),"custom harmony"==t.chorus&&(this.interval=2,this.chord=3)}else if(1==this.type){null!=t.vibrato?(this.vibrato=e.vibratos.findIndex((e=>e.name==t.vibrato)),-1==this.vibrato&&(this.vibrato=e.vibratos.length),this.vibrato==e.vibratos.length?(this.vibratoDepth=t.vibratoDepth,this.vibratoSpeed=t.vibratoSpeed,this.vibratoDelay=t.vibratoDelay,this.vibratoType=t.vibratoType):(this.vibratoDepth=e.vibratos[this.vibrato].amplitude,this.vibratoDelay=e.vibratos[this.vibrato].delayParts,this.vibratoSpeed=10,this.vibratoType=e.vibratos[this.vibrato].type)):null!=t.effect&&(this.vibrato=c.indexOf(t.effect),-1==this.vibrato&&(this.vibrato=0)),this.chord=e.chords.findIndex((e=>e.name==t.chord)),-1==this.chord&&(this.chord=3),this.algorithm=e.algorithms.findIndex((e=>e.name==t.algorithm)),-1==this.algorithm&&(this.algorithm=0),this.feedbackType=e.feedbacks.findIndex((e=>e.name==t.feedbackType)),-1==this.feedbackType&&(this.feedbackType=0),null!=t.feedbackAmplitude?this.feedbackAmplitude=W(0,e.operatorAmplitudeMax+1,0|t.feedbackAmplitude):this.feedbackAmplitude=0;const n={"pluck 1":6,"pluck 2":7,"pluck 3":8};this.feedbackEnvelope=null!=n[t.feedbackEnvelope]?n[t.feedbackEnvelope]:e.envelopes.findIndex((e=>e.name==t.feedbackEnvelope)),-1==this.feedbackEnvelope&&(this.feedbackEnvelope=0);for(let i=0;i<e.operatorCount;i++){const a=this.operators[i];let r=void 0;t.operators&&(r=t.operators[i]),null==r&&(r={}),a.frequency=e.operatorFrequencies.findIndex((t=>t.name==r.frequency)),-1==a.frequency&&(a.frequency=0),null!=r.amplitude?a.amplitude=W(0,e.operatorAmplitudeMax+1,0|r.amplitude):a.amplitude=0,null!=r.waveform?a.waveform=e.operatorWaves.findIndex((t=>t.name==r.waveform)):a.waveform=0,a.envelope=null!=n[r.envelope]?n[r.envelope]:e.envelopes.findIndex((t=>t.name==r.envelope)),-1==a.envelope&&(a.envelope=0)}}else if(7==this.type){if(null!=t.interval)this.interval=e.intervals.findIndex((e=>e.name==t.interval)),-1==this.interval&&(this.interval=0);else if(null!=t.chorus){const n={fifths:5,octaves:6};this.interval=null!=n[t.chorus]?n[t.chorus]:e.intervals.findIndex((e=>e.name==t.chorus)),-1==this.interval&&(this.interval=0)}if(null!=t.vibrato?(this.vibrato=e.vibratos.findIndex((e=>e.name==t.vibrato)),-1==this.vibrato&&(this.vibrato=e.vibratos.length),this.vibrato==e.vibratos.length?(this.vibratoDepth=t.vibratoDepth,this.vibratoSpeed=t.vibratoSpeed,this.vibratoDelay=t.vibratoDelay,this.vibratoType=t.vibratoType):(this.vibratoDepth=e.vibratos[this.vibrato].amplitude,this.vibratoDelay=e.vibratos[this.vibrato].delayParts,this.vibratoSpeed=10,this.vibratoType=e.vibratos[this.vibrato].type)):null!=t.effect&&(this.vibrato=c.indexOf(t.effect),-1==this.vibrato&&(this.vibrato=0)),this.chord=e.chords.findIndex((e=>e.name==t.chord)),-1==this.chord&&(this.chord=2),"custom harmony"==t.chorus&&(this.interval=2,this.chord=3),t.customChipWave){for(let e=0;e<64;e++)this.customChipWave[e]=t.customChipWave[e];let e=0;for(let t=0;t<this.customChipWave.length;t++)e+=this.customChipWave[t];const n=e/this.customChipWave.length;let i=0,a=0;for(let t=0;t<this.customChipWave.length;t++)i+=a,a=this.customChipWave[t]-n,this.customChipWaveIntegral[t]=i;this.customChipWaveIntegral[64]=0}}else{if(8!=this.type)throw new Error("Unrecognized instrument type.");if(null!=t.modChannels)for(let n=0;n<e.modCount;n++)this.modChannels[n]=t.modChannels[n],this.modInstruments[n]=t.modInstruments[n],this.modSettings[n]=t.modSettings[n],this.modStatuses[n]=t.modStatuses[n]}8!=this.type&&(2==this.chord&&null!=t.arpeggioSpeed?this.arpeggioSpeed=t.arpeggioSpeed:this.arpeggioSpeed=a?9:12,null!=t.fastTwoNoteArp?this.fastTwoNoteArp=t.fastTwoNoteArp:this.fastTwoNoteArp=r,null!=t.tieNoteTransition?this.tieNoteTransition=t.tieNoteTransition:this.tieNoteTransition=!1,null!=t.clicklessTransition?this.clicklessTransition=t.clicklessTransition:this.clicklessTransition=!1)}static frequencyFromPitch(t){return 440*Math.pow(2,(t-69)/12)}static drumsetIndexReferenceDelta(t){return _.frequencyFromPitch(e.spectrumBasePitch+6*t)/44100}static R(t){return 15+Math.log(_.drumsetIndexReferenceDelta(t))/Math.LN2}warmUp(){if(this.LFOtime=0,this.nextLFOtime=0,this.arpTime=0,2==this.type)a(this.chipNoise,H,A);else if(5==this.type)this.harmonicsWave.getCustomWave();else if(3==this.type)this.spectrumWave.getCustomWave(8);else if(4==this.type)for(let t=0;t<e.drumCount;t++)this.drumsetSpectrumWaves[t].getCustomWave(_.R(t))}getDrumWave(){if(2==this.type)return a(this.chipNoise,H,A);if(3==this.type)return this.spectrumWave.getCustomWave(8);throw new Error("Unhandled instrument type in getDrumWave")}getDrumsetWave(t){if(4==this.type)return this.drumsetSpectrumWaves[t].getCustomWave(_.R(t));throw new Error("Unhandled instrument type in getDrumWave")}getTransition(){return 4==this.type?e.transitions.dictionary["hard fade"]:8==this.type?e.transitions.dictionary.seamless:e.transitions[this.transition]}getChord(){return 4==this.type?e.chords.dictionary.harmony:e.chords[this.chord]}getFilterCutoffOctaves(){return 4==this.type?0:.5*(this.filterCutoff-(e.filterCutoffRange-1))}getFilterIsFirstOrder(){return 4!=this.type&&0==this.filterResonance}getFilterResonance(){return 4==this.type?1:this.filterResonance}getFilterEnvelope(){if(4==this.type)throw new Error("Can't getFilterEnvelope() for drumset.");return e.envelopes[this.filterEnvelope]}getDrumsetEnvelope(t){if(4!=this.type)throw new Error("Can't getDrumsetEnvelope() for non-drumset.");return e.envelopes[this.drumsetEnvelopes[t]]}}var Q,J;!function(t){t[t.msForPitch=0]="msForPitch",t[t.msForNoise=1]="msForNoise",t[t.msForSong=2]="msForSong",t[t.msNone=3]="msNone"}(Q||(Q={})),function(t){t[t.mstNone=0]="mstNone",t[t.mstSongVolume=1]="mstSongVolume",t[t.mstTempo=2]="mstTempo",t[t.mstReverb=3]="mstReverb",t[t.mstNextBar=4]="mstNextBar",t[t.mstInsVolume=5]="mstInsVolume",t[t.mstPan=6]="mstPan",t[t.mstFilterCut=7]="mstFilterCut",t[t.mstFilterPeak=8]="mstFilterPeak",t[t.mstFMSlider1=9]="mstFMSlider1",t[t.mstFMSlider2=10]="mstFMSlider2",t[t.mstFMSlider3=11]="mstFMSlider3",t[t.mstFMSlider4=12]="mstFMSlider4",t[t.mstFMFeedback=13]="mstFMFeedback",t[t.mstPulseWidth=14]="mstPulseWidth",t[t.mstDetune=15]="mstDetune",t[t.mstVibratoDepth=16]="mstVibratoDepth",t[t.mstSongDetune=17]="mstSongDetune",t[t.mstVibratoSpeed=18]="mstVibratoSpeed",t[t.mstVibratoDelay=19]="mstVibratoDelay",t[t.mstArpeggioSpeed=20]="mstArpeggioSpeed",t[t.mstPanDelay=21]="mstPanDelay",t[t.mstResetArpeggio=22]="mstResetArpeggio",t[t.mstMaxValue=23]="mstMaxValue"}(J||(J={}));class Z{constructor(){this.octave=0,this.instruments=[],this.patterns=[],this.bars=[],this.muted=!1,this.name=""}}class X{constructor(t){this.channels=[],this.limitDecay=4,this.limitRise=4e3,this.compressionThreshold=1,this.limitThreshold=1,this.compressionRatio=1,this.limitRatio=1,this.masterGain=1,this.inVolumeCap=0,this.outVolumeCap=0,this.mstMaxVols=new Map([[J.mstNone,6],[J.mstSongVolume,100],[J.mstTempo,e.tempoMax-e.tempoMin],[J.mstReverb,e.reverbRange-1],[J.mstNextBar,1],[J.mstInsVolume,e.volumeRange],[J.mstPan,e.panMax],[J.mstFilterCut,e.filterCutoffRange-1],[J.mstFilterPeak,e.filterResonanceRange-1],[J.mstFMSlider1,15],[J.mstFMSlider2,15],[J.mstFMSlider3,15],[J.mstFMSlider4,15],[J.mstFMFeedback,15],[J.mstPulseWidth,e.pulseWidthRange],[J.mstDetune,e.detuneMax-e.detuneMin],[J.mstVibratoDepth,50],[J.mstSongDetune,e.songDetuneMax-e.songDetuneMin],[J.mstVibratoSpeed,30],[J.mstVibratoDelay,50],[J.mstArpeggioSpeed,50],[J.mstPanDelay,20],[J.mstResetArpeggio,1],[J.mstMaxValue,6]]),this.mstNewNoteVols=new Map([[J.mstNone,6],[J.mstSongVolume,100],[J.mstTempo,Math.ceil((e.tempoMax-e.tempoMin)/2)],[J.mstReverb,0],[J.mstNextBar,1],[J.mstInsVolume,Math.ceil(e.volumeRange/2)],[J.mstPan,Math.ceil(e.panMax/2)],[J.mstFilterCut,e.filterCutoffRange-1],[J.mstFilterPeak,0],[J.mstFMSlider1,15],[J.mstFMSlider2,15],[J.mstFMSlider3,15],[J.mstFMSlider4,15],[J.mstFMFeedback,15],[J.mstPulseWidth,Math.ceil(e.pulseWidthRange)],[J.mstDetune,Math.ceil((e.detuneMax-e.detuneMin)/2)],[J.mstVibratoDepth,0],[J.mstSongDetune,Math.ceil((e.songDetuneMax-e.songDetuneMin)/2)],[J.mstVibratoSpeed,0],[J.mstVibratoDelay,0],[J.mstArpeggioSpeed,10],[J.mstPanDelay,10],[J.mstResetArpeggio,1],[J.mstMaxValue,6]]),this.getNewNoteVolume=(t,n,i,a)=>{if(t&&null!=n&&null!=i&&null!=a){a=e.modCount-a-1;let t=this.mstNewNoteVols.get(this.channels[n].instruments[i].modSettings[a]);return this.channels[n].instruments[i].modSettings[a]==J.mstTempo&&(t=this.realToModValue(this.tempo,J.mstTempo)),null!=t?t:6}return 6},this.getVolumeCap=(t,n,i,a)=>{if(t&&null!=n&&null!=i&&null!=a){a=e.modCount-a-1;let t=this.mstMaxVols.get(this.channels[n].instruments[i].modSettings[a]);return null!=t?t:6}return 6},this.getVolumeCapForSetting=(t,e)=>{if(t){let t=this.mstMaxVols.get(e);return null!=t?t:6}return 6},null!=t?this.fromBase64String(t):this.initToDefault(!0)}modValueToReal(t,n){switch(n){case J.mstTempo:t+=e.tempoMin;break;case J.mstInsVolume:t-=e.volumeRange/2;break;case J.mstDetune:t+=e.detuneMin;break;case J.mstSongDetune:t+=e.songDetuneMin;break;case J.mstFilterCut:case J.mstFilterPeak:case J.mstSongVolume:case J.mstPan:case J.mstReverb:case J.mstNextBar:case J.mstFMSlider1:case J.mstFMSlider2:case J.mstFMSlider3:case J.mstFMSlider4:case J.mstFMFeedback:case J.mstPulseWidth:case J.mstVibratoDepth:case J.mstVibratoSpeed:case J.mstVibratoDelay:case J.mstArpeggioSpeed:case J.mstPanDelay:case J.mstResetArpeggio:case J.mstNone:}return t}isSettingForSong(t){switch(t){case J.mstTempo:case J.mstReverb:case J.mstSongVolume:case J.mstNextBar:return!0;default:return!1}}realToModValue(t,n){switch(n){case J.mstTempo:t-=e.tempoMin;break;case J.mstInsVolume:t+=e.volumeRange/2;break;case J.mstDetune:t-=e.detuneMin;break;case J.mstSongDetune:t-=e.songDetuneMin;break;case J.mstFilterCut:case J.mstFilterPeak:case J.mstSongVolume:case J.mstPan:case J.mstReverb:case J.mstNextBar:case J.mstFMSlider1:case J.mstFMSlider2:case J.mstFMSlider3:case J.mstFMSlider4:case J.mstFMFeedback:case J.mstPulseWidth:case J.mstVibratoDepth:case J.mstVibratoSpeed:case J.mstVibratoDelay:case J.mstArpeggioSpeed:case J.mstPanDelay:case J.mstResetArpeggio:case J.mstNone:}return t}getChannelCount(){return this.pitchChannelCount+this.noiseChannelCount+this.modChannelCount}getChannelIsNoise(t){return t>=this.pitchChannelCount&&t<this.pitchChannelCount+this.noiseChannelCount}getChannelIsMod(t){return t>=this.pitchChannelCount+this.noiseChannelCount}initToDefault(t=!0){if(this.scale=0,this.key=0,this.loopStart=0,this.loopLength=4,this.tempo=150,this.reverb=0,this.beatsPerBar=8,this.barCount=16,this.patternsPerChannel=8,this.rhythm=1,this.instrumentsPerChannel=1,this.title="Unnamed",document.title=R.versionDisplayName,t){this.pitchChannelCount=3,this.noiseChannelCount=1,this.modChannelCount=0;for(let t=0;t<this.getChannelCount();t++){this.channels.length<=t&&(this.channels[t]=new Z);const e=this.channels[t];e.octave=Math.max(3-t,0);for(let t=0;t<this.patternsPerChannel;t++)e.patterns.length<=t?e.patterns[t]=new j:e.patterns[t].reset();e.patterns.length=this.patternsPerChannel;const n=t>=this.pitchChannelCount&&t<this.pitchChannelCount+this.noiseChannelCount,i=t>=this.pitchChannelCount+this.noiseChannelCount;for(let t=0;t<this.instrumentsPerChannel;t++)e.instruments.length<=t&&(e.instruments[t]=new _(n,i)),e.instruments[t].setTypeAndReset(i?8:n?2:0,n,i);e.instruments.length=this.instrumentsPerChannel;for(let t=0;t<this.barCount;t++)e.bars[t]=t<4?1:0;e.bars.length=this.barCount}this.channels.length=this.getChannelCount()}}toBase64String(){let t,n=[];n.push(X.T),n.push(D[X.H]),n.push(78);var i=encodeURIComponent(this.title);n.push(D[i.length>>6],D[63&i.length]);for(let t=0;t<i.length;t++)n.push(i.charCodeAt(t));n.push(110,D[this.pitchChannelCount],D[this.noiseChannelCount],D[this.modChannelCount]),n.push(115,D[this.scale]),n.push(107,D[this.key]),n.push(108,D[this.loopStart>>6],D[63&this.loopStart]),n.push(101,D[this.loopLength-1>>6],D[this.loopLength-1&63]),n.push(116,D[this.tempo>>6],D[63&this.tempo]),n.push(109,D[this.reverb]),n.push(97,D[this.beatsPerBar-1]),n.push(103,D[this.barCount-1>>6],D[this.barCount-1&63]),n.push(106,D[this.patternsPerChannel-1>>6],D[this.patternsPerChannel-1&63]),n.push(105,D[this.instrumentsPerChannel-1]),n.push(114,D[this.rhythm]),n.push(79),1!=this.compressionRatio||1!=this.limitRatio||4e3!=this.limitRise||4!=this.limitDecay||1!=this.limitThreshold||1!=this.compressionThreshold||1!=this.masterGain?(n.push(D[Math.round(this.compressionRatio<1?10*this.compressionRatio:10+60*(this.compressionRatio-1))]),n.push(D[Math.round(this.limitRatio<1?10*this.limitRatio:9+this.limitRatio)]),n.push(D[this.limitDecay]),n.push(D[Math.round((this.limitRise-2e3)/250)]),n.push(D[Math.round(20*this.compressionThreshold)]),n.push(D[Math.round(20*this.limitThreshold)]),n.push(D[Math.round(50*this.masterGain)>>6],D[63&Math.round(50*this.masterGain)])):n.push(D[63]),n.push(85);for(let t=0;t<this.getChannelCount();t++){var a=encodeURIComponent(this.channels[t].name);n.push(D[a.length>>6],D[63&a.length]);for(let t=0;t<a.length;t++)n.push(a.charCodeAt(t))}n.push(111);for(let t=0;t<this.getChannelCount();t++)n.push(D[this.channels[t].octave]);for(let t=0;t<this.getChannelCount();t++)for(let i=0;i<this.instrumentsPerChannel;i++){const a=this.channels[t].instruments[i];if(n.push(84,D[a.type]),n.push(118,D[a.volume+e.volumeRange/2>>6],D[a.volume+e.volumeRange/2&63]),n.push(76,D[a.pan>>6],D[63&a.pan]),n.push(D[a.panDelay]),n.push(68,D[a.detune-e.detuneMin>>6],D[a.detune-e.detuneMin&63]),n.push(117,D[a.preset>>6],D[63&a.preset]),n.push(113,D[a.effects]),4!=a.type&&(n.push(100,D[a.transition]),n.push(D[+a.tieNoteTransition]),n.push(D[+a.clicklessTransition]),n.push(102,D[a.filterCutoff]),n.push(121,D[a.filterResonance]),n.push(122,D[a.filterEnvelope]),n.push(67,D[a.chord])),0==a.type)n.push(119,D[a.chipWave]),n.push(99,D[a.vibrato]),a.vibrato==e.vibratos.length&&(n.push(D[Math.round(25*a.vibratoDepth)]),n.push(D[a.vibratoSpeed]),n.push(D[a.vibratoDelay]),n.push(D[a.vibratoType])),2==a.chord&&(n.push(71,D[a.arpeggioSpeed]),n.push(D[+a.fastTwoNoteArp])),n.push(104,D[a.interval]);else if(1==a.type){n.push(99,D[a.vibrato]),a.vibrato==e.vibratos.length&&(n.push(D[Math.round(25*a.vibratoDepth)]),n.push(D[a.vibratoSpeed]),n.push(D[a.vibratoDelay]),n.push(D[a.vibratoType])),2==a.chord&&(n.push(71,D[a.arpeggioSpeed]),n.push(D[+a.fastTwoNoteArp])),n.push(104,D[a.interval]),n.push(65,D[a.algorithm]),n.push(70,D[a.feedbackType]),n.push(66,D[a.feedbackAmplitude]),n.push(86,D[a.feedbackEnvelope]),n.push(81);for(let t=0;t<e.operatorCount;t++)n.push(D[a.operators[t].frequency]);n.push(80);for(let t=0;t<e.operatorCount;t++)n.push(D[a.operators[t].amplitude]);n.push(69);for(let t=0;t<e.operatorCount;t++)n.push(D[a.operators[t].envelope]);n.push(82);for(let t=0;t<e.operatorCount;t++)n.push(D[a.operators[t].waveform])}else if(7==a.type){n.push(119,D[a.chipWave]),n.push(99,D[a.vibrato]),a.vibrato==e.vibratos.length&&(n.push(D[Math.round(25*a.vibratoDepth)]),n.push(D[a.vibratoSpeed]),n.push(D[a.vibratoDelay]),n.push(D[a.vibratoType])),2==a.chord&&(n.push(71,D[a.arpeggioSpeed]),n.push(D[+a.fastTwoNoteArp])),n.push(104,D[a.interval]),n.push(77);for(let t=0;t<64;t++)n.push(D[a.customChipWave[t]+24])}else if(2==a.type)n.push(119,D[a.chipNoise]),2==a.chord&&(n.push(71,D[a.arpeggioSpeed]),n.push(D[+a.fastTwoNoteArp])),n.push(104,D[a.interval]);else if(3==a.type){n.push(83);const t=new I;for(let n=0;n<e.spectrumControlPoints;n++)t.write(e.spectrumControlPointBits,a.spectrumWave.spectrum[n]);t.encodeBase64(n),n.push(99,D[a.vibrato]),a.vibrato==e.vibratos.length&&(n.push(D[Math.round(25*a.vibratoDepth)]),n.push(D[a.vibratoSpeed]),n.push(D[a.vibratoDelay]),n.push(D[a.vibratoType])),2==a.chord&&(n.push(71,D[a.arpeggioSpeed]),n.push(D[+a.fastTwoNoteArp])),n.push(104,D[a.interval])}else if(4==a.type){n.push(122);for(let t=0;t<e.drumCount;t++)n.push(D[a.drumsetEnvelopes[t]]);n.push(83);const t=new I;for(let n=0;n<e.drumCount;n++)for(let i=0;i<e.spectrumControlPoints;i++)t.write(e.spectrumControlPointBits,a.drumsetSpectrumWaves[n].spectrum[i]);t.encodeBase64(n)}else if(5==a.type){n.push(99,D[a.vibrato]),a.vibrato==e.vibratos.length&&(n.push(D[Math.round(25*a.vibratoDepth)]),n.push(D[a.vibratoSpeed]),n.push(D[a.vibratoDelay]),n.push(D[a.vibratoType])),2==a.chord&&(n.push(71,D[a.arpeggioSpeed]),n.push(D[+a.fastTwoNoteArp])),n.push(104,D[a.interval]),n.push(72);const t=new I;for(let n=0;n<e.harmonicsControlPoints;n++)t.write(e.harmonicsControlPointBits,a.harmonicsWave.harmonics[n]);t.encodeBase64(n)}else if(6==a.type)n.push(99,D[a.vibrato]),a.vibrato==e.vibratos.length&&(n.push(D[Math.round(25*a.vibratoDepth)]),n.push(D[a.vibratoSpeed]),n.push(D[a.vibratoDelay]),n.push(D[a.vibratoType])),2==a.chord&&(n.push(71,D[a.arpeggioSpeed]),n.push(D[+a.fastTwoNoteArp])),n.push(87,D[a.pulseWidth],D[a.pulseEnvelope]),n.push(104,D[a.interval]);else if(8!=a.type)throw new Error("Unknown instrument type.")}n.push(98),t=new I;let r=0;for(;1<<r<this.patternsPerChannel+1;)r++;for(let e=0;e<this.getChannelCount();e++)for(let n=0;n<this.barCount;n++)t.write(r,this.channels[e].bars[n]);t.encodeBase64(n),n.push(112),t=new I;const s=new I;let o=0;for(;1<<o<this.instrumentsPerChannel;)o++;for(let n=0;n<this.getChannelCount();n++){const i=this.getChannelIsNoise(n),a=this.getChannelIsMod(n);if(a)for(let i=0;i<this.instrumentsPerChannel;i++){let a=this.channels[n].instruments[i];for(let n=0;n<e.modCount;n++){const e=a.modStatuses[n],i=a.modChannels[n],r=a.modInstruments[n],s=a.modSettings[n];t.write(2,e),e!=Q.msForPitch&&e!=Q.msForNoise||(t.write(8,i),t.write(o,r)),e!=Q.msNone&&t.write(6,s)}}const r=i||a?0:12*this.channels[n].octave;let l=(i||a?4:12)+r;const c=a?[0,1,2,3,4,5]:i?[4,6,7,2,3,8,0,10]:[12,19,24,31,36,7,0],h=[];for(let t=0;t<c.length;t++)c[t]+=r;for(const i of this.channels[n].patterns)if(t.write(o,i.instrument),i.notes.length>0){t.write(1,1);let n=0;for(const e of i.notes){e.start<n&&a&&(t.write(2,0),t.write(1,1),t.writePartDuration(n-e.start)),e.start>n&&(t.write(2,0),a&&t.write(1,0),t.writePartDuration(e.start-n)),s.clear(),1==e.pitches.length?s.write(1,0):(s.write(1,1),s.write(3,e.pitches.length-2)),s.writePinCount(e.pins.length-1),a?s.write(9,e.pins[0].volume):s.write(3,e.pins[0].volume);let i=0,r=e.pitches[0],o=r;const m=[];for(let t=1;t<e.pins.length;t++){const n=e.pins[t],l=r+n.interval;o!=l?(s.write(1,1),m.push(l),o=l):s.write(1,0),s.writePartDuration(n.time-i),i=n.time,a?s.write(9,n.volume):s.write(3,n.volume)}const d=String.fromCharCode.apply(null,s.encodeBase64([])),f=h.indexOf(d);-1==f?(t.write(2,1),t.concat(s)):(t.write(1,1),t.writeLongTail(0,0,f),h.splice(f,1)),h.unshift(d),h.length>10&&h.pop();const p=e.pitches.concat(m);for(let n=0;n<p.length;n++){const i=p[n],a=c.indexOf(i);if(-1==a){let e=0,n=l;if(n<i)for(;n!=i;)n++,-1==c.indexOf(n)&&e++;else for(;n!=i;)n--,-1==c.indexOf(n)&&e--;t.write(1,0),t.writePitchInterval(e)}else t.write(1,1),t.write(4,a),c.splice(a,1);c.unshift(i),c.length>16&&c.pop(),l=n==e.pitches.length-1?e.pitches[0]:i}n=e.end}n<this.beatsPerBar*e.partsPerBeat+ +a&&(t.write(2,0),a&&t.write(1,0),t.writePartDuration(this.beatsPerBar*e.partsPerBeat+ +a-n))}else t.write(1,0)}let l=t.lengthBase64(),c=[];for(;l>0;)c.unshift(D[63&l]),l>>=6;n.push(D[c.length]),Array.prototype.push.apply(n,c),t.encodeBase64(n);const h=64e3;if(n.length<h)return String.fromCharCode.apply(null,n);{let t="";for(let e=0;e<n.length;e+=h)t+=String.fromCharCode.apply(null,n.slice(e,e+h));return t}}fromBase64String(t){if(null==t||""==t)return void this.initToDefault(!0);let n=0;for(;t.charCodeAt(n)<=32;)n++;if(35==t.charCodeAt(n)&&n++,123==t.charCodeAt(n))return void this.fromJsonObject(JSON.parse(0==n?t:t.substring(n)));var i="beepbox";106==t.charCodeAt(n)&&(i="jummbox",n++);const a=N[t.charCodeAt(n++)];if("beepbox"==i&&(-1==a||a>X.N||a<X.O))return;if("jummbox"==i&&(-1==a||a>X.H||a<X.I))return;const r=a<2,s=a<3,o=a<4,l=a<5,c=a<6,h=a<7,m=a<8;if(this.initToDefault("beepbox"==i&&c),s&&"beepbox"==i){for(const t of this.channels)t.instruments[0].transition=0;this.channels[3].instruments[0].chipNoise=0}let d,f,p=0,u=-1,y=[],v=!1,g=!1;for(;n<t.length;)switch(d=t.charCodeAt(n++)){case 78:var b=(N[t.charCodeAt(n++)]<<6)+N[t.charCodeAt(n++)];this.title=decodeURIComponent(t.substring(n,n+b)),document.title=this.title+" - "+R.versionDisplayName,n+=b;break;case 110:this.pitchChannelCount=N[t.charCodeAt(n++)],this.noiseChannelCount=N[t.charCodeAt(n++)],this.modChannelCount="beepbox"==i||r?0:N[t.charCodeAt(n++)],this.pitchChannelCount=V(e.pitchChannelCountMin,e.pitchChannelCountMax,this.pitchChannelCount),this.noiseChannelCount=V(e.noiseChannelCountMin,e.noiseChannelCountMax,this.noiseChannelCount),this.modChannelCount=V(e.modChannelCountMin,e.modChannelCountMax,this.modChannelCount);for(let t=this.channels.length;t<this.getChannelCount();t++)this.channels[t]=new Z;this.channels.length=this.getChannelCount();break;case 115:this.scale=N[t.charCodeAt(n++)],"beepbox"==i&&(this.scale=0);break;case 107:this.key=W(0,e.keys.length,h&&"beepbox"==i?11-N[t.charCodeAt(n++)]:N[t.charCodeAt(n++)]);break;case 108:this.loopStart=l&&"beepbox"==i?N[t.charCodeAt(n++)]:(N[t.charCodeAt(n++)]<<6)+N[t.charCodeAt(n++)];break;case 101:this.loopLength=l&&"beepbox"==i?N[t.charCodeAt(n++)]:(N[t.charCodeAt(n++)]<<6)+N[t.charCodeAt(n++)]+1;break;case 116:this.tempo=o&&"beepbox"==i?[95,120,151,190][N[t.charCodeAt(n++)]]:h&&"beepbox"==i?[88,95,103,111,120,130,140,151,163,176,190,206,222,240,259][N[t.charCodeAt(n++)]]:N[t.charCodeAt(n++)]<<6|N[t.charCodeAt(n++)],this.tempo=W(e.tempoMin,e.tempoMax+1,this.tempo);break;case 109:"beepbox"==i?(this.reverb=8*N[t.charCodeAt(n++)],this.reverb=W(0,e.reverbRange,this.reverb)):(this.reverb=N[t.charCodeAt(n++)],this.reverb=W(0,e.reverbRange,this.reverb));break;case 97:this.beatsPerBar=s&&"beepbox"==i?[6,7,8,9,10][N[t.charCodeAt(n++)]]:N[t.charCodeAt(n++)]+1,this.beatsPerBar=Math.max(e.beatsPerBarMin,Math.min(e.beatsPerBarMax,this.beatsPerBar));break;case 103:{const i=(N[t.charCodeAt(n++)]<<6)+N[t.charCodeAt(n++)]+1;this.barCount=V(e.barCountMin,e.barCountMax,i);for(let t=0;t<this.getChannelCount();t++){for(let e=this.channels[t].bars.length;e<this.barCount;e++)this.channels[t].bars[e]=e<4?1:0;this.channels[t].bars.length=this.barCount}}break;case 106:this.patternsPerChannel="beepbox"==i&&m?N[t.charCodeAt(n++)]+1:(N[t.charCodeAt(n++)]<<6)+N[t.charCodeAt(n++)]+1,this.patternsPerChannel=V(1,e.barCountMax,this.patternsPerChannel);for(let t=0;t<this.getChannelCount();t++){for(let e=this.channels[t].patterns.length;e<this.patternsPerChannel;e++)this.channels[t].patterns[e]=new j;this.channels[t].patterns.length=this.patternsPerChannel}break;case 105:{const a=N[t.charCodeAt(n++)]+1;this.instrumentsPerChannel=V(e.instrumentsPerChannelMin,e.instrumentsPerChannelMax,a);for(let t=0;t<this.getChannelCount();t++){const e=t>=this.pitchChannelCount&&t<this.pitchChannelCount+this.noiseChannelCount,n=t>=this.pitchChannelCount+this.noiseChannelCount;for(let i=this.channels[t].instruments.length;i<this.instrumentsPerChannel;i++)this.channels[t].instruments[i]=new _(e,n);if(this.channels[t].instruments.length=this.instrumentsPerChannel,c&&"beepbox"==i)for(let i=0;i<this.instrumentsPerChannel;i++)this.channels[t].instruments[i].setTypeAndReset(e?2:0,e,n)}}break;case 114:this.rhythm=N[t.charCodeAt(n++)],("jummbox"==i&&s||"beepbox"==i)&&(0!=this.rhythm&&2!=this.rhythm||(v=!0),this.rhythm>=2&&(g=!0));break;case 111:if(s&&"beepbox"==i)f=N[t.charCodeAt(n++)],this.channels[f].octave=W(0,e.maxScrollableOctaves+1,N[t.charCodeAt(n++)]),y[f]=W(0,e.maxScrollableOctaves-+(window.localStorage.getItem("extraOctaves")||"0")+1,this.channels[f].octave);else for(f=0;f<this.getChannelCount();f++)this.channels[f].octave=W(0,e.maxScrollableOctaves+1,N[t.charCodeAt(n++)]),y[f]=W(0,e.maxScrollableOctaves-+(window.localStorage.getItem("extraOctaves")||"0")+1,this.channels[f].octave);break;case 84:{u++,u>=this.instrumentsPerChannel&&(p++,u=0),V(0,this.channels.length-1,p);const e=this.channels[p].instruments[u],i=W(0,9,N[t.charCodeAt(n++)]);e.setTypeAndReset(i,p>=this.pitchChannelCount&&p<this.pitchChannelCount+this.noiseChannelCount,p>=this.pitchChannelCount+this.noiseChannelCount),v&&(e.arpeggioSpeed=9),g&&(e.fastTwoNoteArp=!0)}break;case 117:{const e=N[t.charCodeAt(n++)]<<6|N[t.charCodeAt(n++)];this.channels[p].instruments[u].preset=e}break;case 119:if(s&&"beepbox"==i){const i=[1,2,3,4,5,6,7,8,0],a=N[t.charCodeAt(n++)];this.channels[a].instruments[0].chipWave=W(0,e.chipWaves.length,0|i[N[t.charCodeAt(n++)]])}else if(c&&"beepbox"==i){const i=[1,2,3,4,5,6,7,8,0];for(let a=0;a<this.getChannelCount();a++)for(let r=0;r<this.instrumentsPerChannel;r++)a>=this.pitchChannelCount?this.channels[a].instruments[r].chipNoise=W(0,e.chipNoises.length,N[t.charCodeAt(n++)]):this.channels[a].instruments[r].chipWave=W(0,e.chipWaves.length,0|i[N[t.charCodeAt(n++)]])}else if(h&&"beepbox"==i){const i=[1,2,3,4,5,6,7,8,0];p>=this.pitchChannelCount?this.channels[p].instruments[u].chipNoise=W(0,e.chipNoises.length,N[t.charCodeAt(n++)]):this.channels[p].instruments[u].chipWave=W(0,e.chipWaves.length,0|i[N[t.charCodeAt(n++)]])}else p>=this.pitchChannelCount?this.channels[p].instruments[u].chipNoise=W(0,e.chipNoises.length,N[t.charCodeAt(n++)]):this.channels[p].instruments[u].chipWave=W(0,e.chipWaves.length,N[t.charCodeAt(n++)]);break;case 102:if(h&&"beepbox"==i){const e=[10,6,3,0,8,5,2],a=[1,1,1,1,18,19,20],r=["none","bright","medium","soft","decay bright","decay medium","decay soft"];if(s&&"beepbox"==i){f=N[t.charCodeAt(n++)];const i=this.channels[f].instruments[0],s=[1,3,4,5][W(0,r.length,N[t.charCodeAt(n++)])];i.filterCutoff=e[s],i.filterEnvelope=a[s],i.filterResonance=0}else if(c&&"beepbox"==i)for(f=0;f<this.getChannelCount();f++)for(let i=0;i<this.instrumentsPerChannel;i++){const s=this.channels[f].instruments[i],o=W(0,r.length,N[t.charCodeAt(n++)]+1);f<this.pitchChannelCount?(s.filterCutoff=e[o],s.filterEnvelope=a[o],s.filterResonance=0):(s.filterCutoff=10,s.filterEnvelope=1,s.filterResonance=0)}else{const i=W(0,r.length,N[t.charCodeAt(n++)]),s=this.channels[p].instruments[u];s.filterCutoff=e[i],s.filterEnvelope=a[i],s.filterResonance=0}}else{this.channels[p].instruments[u].filterCutoff=W(0,e.filterCutoffRange,N[t.charCodeAt(n++)])}break;case 121:this.channels[p].instruments[u].filterResonance=W(0,e.filterResonanceRange,N[t.charCodeAt(n++)]);break;case 122:{const i=this.channels[p].instruments[u];if(4==i.type)for(let a=0;a<e.drumCount;a++)i.drumsetEnvelopes[a]=W(0,e.envelopes.length,N[t.charCodeAt(n++)]);else i.filterEnvelope=W(0,e.envelopes.length,N[t.charCodeAt(n++)])}break;case 87:if("beepbox"==i){const i=this.channels[p].instruments[u];i.pulseWidth=Math.round(W(0,e.pulseWidthRange+1,50*Math.pow(.5,.5*(7-N[t.charCodeAt(n++)])))),i.pulseEnvelope=W(0,e.envelopes.length,N[t.charCodeAt(n++)])}else{const i=this.channels[p].instruments[u];i.pulseWidth=W(0,e.pulseWidthRange+1,N[t.charCodeAt(n++)]),i.pulseEnvelope=W(0,e.envelopes.length,N[t.charCodeAt(n++)])}break;case 100:if(s&&"beepbox"==i)f=N[t.charCodeAt(n++)],this.channels[f].instruments[0].transition=W(0,e.transitions.length,N[t.charCodeAt(n++)]);else if(c&&"beepbox"==i)for(f=0;f<this.getChannelCount();f++)for(let i=0;i<this.instrumentsPerChannel;i++)this.channels[f].instruments[i].transition=W(0,e.transitions.length,N[t.charCodeAt(n++)]);else o||"beepbox"==i?this.channels[p].instruments[u].transition=W(0,e.transitions.length,N[t.charCodeAt(n++)]):(this.channels[p].instruments[u].transition=W(0,e.transitions.length,N[t.charCodeAt(n++)]),this.channels[p].instruments[u].tieNoteTransition=!!N[t.charCodeAt(n++)],this.channels[p].instruments[u].clicklessTransition=!!N[t.charCodeAt(n++)]);break;case 99:if(s&&"beepbox"==i){const e=[0,3,2,0],i=[1,1,1,13],a=N[t.charCodeAt(n++)],r=W(0,e.length,N[t.charCodeAt(n++)]),s=this.channels[a].instruments[0];s.vibrato=e[r],s.filterEnvelope=1==s.filterEnvelope?i[r]:s.filterEnvelope}else if(c&&"beepbox"==i){const e=[0,1,2,3,0,0],i=[1,1,1,1,16,13];for(let a=0;a<this.getChannelCount();a++)for(let r=0;r<this.instrumentsPerChannel;r++){const s=W(0,e.length,N[t.charCodeAt(n++)]),o=this.channels[a].instruments[r];o.vibrato=e[s],o.filterEnvelope=1==o.filterEnvelope?i[s]:o.filterEnvelope}}else if(h&&"beepbox"==i){const e=[0,1,2,3,0,0],i=[1,1,1,1,16,13],a=W(0,e.length,N[t.charCodeAt(n++)]),r=this.channels[p].instruments[u];r.vibrato=e[a],r.filterEnvelope=1==r.filterEnvelope?i[a]:r.filterEnvelope}else{const i=W(0,e.vibratos.length+1,N[t.charCodeAt(n++)]),a=this.channels[p].instruments[u];a.vibrato=i,i==e.vibratos.length?(a.vibratoDepth=W(0,this.mstMaxVols.get(J.mstVibratoDepth)+1,N[t.charCodeAt(n++)])/25,a.vibratoSpeed=W(0,this.mstMaxVols.get(J.mstVibratoSpeed)+1,N[t.charCodeAt(n++)]),a.vibratoDelay=W(0,this.mstMaxVols.get(J.mstVibratoDelay)+1,N[t.charCodeAt(n++)]),a.vibratoType=W(0,e.vibratoTypes.length,N[t.charCodeAt(n++)])):(a.vibratoDepth=e.vibratos[a.vibrato].amplitude,a.vibratoSpeed=10,a.vibratoDelay=e.vibratos[a.vibrato].delayParts,a.vibratoType=e.vibratos[a.vibrato].type)}break;case 71:{const e=this.channels[p].instruments[u];e.arpeggioSpeed=W(0,this.mstMaxVols.get(J.mstArpeggioSpeed)+1,N[t.charCodeAt(n++)]),e.fastTwoNoteArp=!!N[t.charCodeAt(n++)]}break;case 104:if(s&&"beepbox"==i)f=N[t.charCodeAt(n++)],this.channels[f].instruments[0].interval=W(0,e.intervals.length,N[t.charCodeAt(n++)]);else if(c&&"beepbox"==i)for(f=0;f<this.getChannelCount();f++)for(let i=0;i<this.instrumentsPerChannel;i++){const a=N[t.charCodeAt(n++)];let r=W(0,e.intervals.length,a);8==a&&(r=2,this.channels[f].instruments[i].chord=3),this.channels[f].instruments[i].interval=r}else if(h&&"beepbox"==i){const i=N[t.charCodeAt(n++)];let a=W(0,e.intervals.length,i);8==i&&(a=2,this.channels[p].instruments[u].chord=3),this.channels[p].instruments[u].interval=a}else this.channels[p].instruments[u].interval=W(0,e.intervals.length,N[t.charCodeAt(n++)]);break;case 67:this.channels[p].instruments[u].chord=W(0,e.chords.length,N[t.charCodeAt(n++)]);break;case 113:this.channels[p].instruments[u].effects=W(0,e.effectsNames.length,N[t.charCodeAt(n++)]);break;case 118:if(s&&"beepbox"==i){f=N[t.charCodeAt(n++)];this.channels[f].instruments[0].volume=Math.round(W(-e.volumeRange,1,5*-N[t.charCodeAt(n++)]))}else if(c&&"beepbox"==i)for(f=0;f<this.getChannelCount();f++)for(let i=0;i<this.instrumentsPerChannel;i++){this.channels[f].instruments[i].volume=Math.round(W(-e.volumeRange,1,5*-N[t.charCodeAt(n++)]))}else if(h&&"beepbox"==i){this.channels[p].instruments[u].volume=Math.round(W(-e.volumeRange,1,5*-N[t.charCodeAt(n++)]))}else if("beepbox"==i){this.channels[p].instruments[u].volume=Math.round(W(-e.volumeRange/2,1,25*-N[t.charCodeAt(n++)]/7))}else{this.channels[p].instruments[u].volume=Math.round(W(-e.volumeRange/2,e.volumeRange/2+1,(N[t.charCodeAt(n++)]<<6|N[t.charCodeAt(n++)])-e.volumeRange/2))}break;case 76:{const a=this.channels[p].instruments[u];a.pan=W(0,e.panMax+1,"beepbox"==i?Math.round(N[t.charCodeAt(n++)]*(e.panMax/8)):(N[t.charCodeAt(n++)]<<6)+N[t.charCodeAt(n++)]),"jummbox"!=i||s||(a.panDelay=N[t.charCodeAt(n++)])}break;case 68:this.channels[p].instruments[u].detune=W(e.detuneMin,e.detuneMax+1,(N[t.charCodeAt(n++)]<<6)+N[t.charCodeAt(n++)]+e.detuneMin);break;case 77:{let e=this.channels[p].instruments[u];for(let i=0;i<64;i++)e.customChipWave[i]=W(-24,25,N[t.charCodeAt(n++)]-24);let i=0;for(let t=0;t<e.customChipWave.length;t++)i+=e.customChipWave[t];const a=i/e.customChipWave.length;let r=0,s=0;for(let t=0;t<e.customChipWave.length;t++)r+=s,s=e.customChipWave[t]-a,e.customChipWaveIntegral[t]=r;e.customChipWaveIntegral[64]=0}break;case 79:{let e=N[t.charCodeAt(n++)];63==e?(this.compressionRatio=1,this.limitRatio=1,this.limitRise=4e3,this.limitDecay=4,this.limitThreshold=1,this.compressionThreshold=1,this.masterGain=1):(this.compressionRatio=e<10?e/10:1+(e-10)/60,e=N[t.charCodeAt(n++)],this.limitRatio=e<10?e/10:e-9,this.limitDecay=N[t.charCodeAt(n++)],this.limitRise=250*N[t.charCodeAt(n++)]+2e3,this.compressionThreshold=N[t.charCodeAt(n++)]/20,this.limitThreshold=N[t.charCodeAt(n++)]/20,this.masterGain=((N[t.charCodeAt(n++)]<<6)+N[t.charCodeAt(n++)])/50)}break;case 85:for(let e=0;e<this.getChannelCount();e++){var k;k=o?N[t.charCodeAt(n++)]:(N[t.charCodeAt(n++)]<<6)+N[t.charCodeAt(n++)],this.channels[e].name=decodeURIComponent(t.substring(n,n+k)),n+=k}break;case 65:this.channels[p].instruments[u].algorithm=W(0,e.algorithms.length,N[t.charCodeAt(n++)]);break;case 70:this.channels[p].instruments[u].feedbackType=W(0,e.feedbacks.length,N[t.charCodeAt(n++)]);break;case 66:this.channels[p].instruments[u].feedbackAmplitude=W(0,e.operatorAmplitudeMax+1,N[t.charCodeAt(n++)]);break;case 86:this.channels[p].instruments[u].feedbackEnvelope=W(0,e.envelopes.length,N[t.charCodeAt(n++)]);break;case 81:for(let i=0;i<e.operatorCount;i++)this.channels[p].instruments[u].operators[i].frequency=W(0,e.operatorFrequencies.length,N[t.charCodeAt(n++)]);break;case 80:for(let i=0;i<e.operatorCount;i++)this.channels[p].instruments[u].operators[i].amplitude=W(0,e.operatorAmplitudeMax+1,N[t.charCodeAt(n++)]);break;case 69:for(let i=0;i<e.operatorCount;i++)this.channels[p].instruments[u].operators[i].envelope=W(0,e.envelopes.length,N[t.charCodeAt(n++)]);break;case 82:for(let i=0;i<e.operatorCount;i++)this.channels[p].instruments[u].operators[i].waveform=W(0,e.operatorWaves.length,N[t.charCodeAt(n++)]);break;case 83:{const i=this.channels[p].instruments[u];if(3==i.type){const a=Math.ceil(e.spectrumControlPoints*e.spectrumControlPointBits/6),r=new O(t,n,n+a);for(let t=0;t<e.spectrumControlPoints;t++)i.spectrumWave.spectrum[t]=r.read(e.spectrumControlPointBits);i.spectrumWave.markCustomWaveDirty(),n+=a}else{if(4!=i.type)throw new Error("Unhandled instrument type for spectrum song tag code.");{const a=Math.ceil(e.drumCount*e.spectrumControlPoints*e.spectrumControlPointBits/6),r=new O(t,n,n+a);for(let t=0;t<e.drumCount;t++){for(let n=0;n<e.spectrumControlPoints;n++)i.drumsetSpectrumWaves[t].spectrum[n]=r.read(e.spectrumControlPointBits);i.drumsetSpectrumWaves[t].markCustomWaveDirty()}n+=a}}}break;case 72:{const i=this.channels[p].instruments[u],a=Math.ceil(e.harmonicsControlPoints*e.harmonicsControlPointBits/6),r=new O(t,n,n+a);for(let t=0;t<e.harmonicsControlPoints;t++)i.harmonicsWave.harmonics[t]=r.read(e.harmonicsControlPointBits);i.harmonicsWave.markCustomWaveDirty(),n+=a}break;case 98:{let e;if(s&&"beepbox"==i){f=N[t.charCodeAt(n++)];const i=N[t.charCodeAt(n++)];e=Math.ceil(.5*i);const a=new O(t,n,n+e);for(let t=0;t<i;t++)this.channels[f].bars[t]=a.read(3)+1}else if(l&&"beepbox"==i){let i=0;for(;1<<i<this.patternsPerChannel;)i++;e=Math.ceil(this.getChannelCount()*this.barCount*i/6);const a=new O(t,n,n+e);for(let t=0;t<this.getChannelCount();t++)for(let e=0;e<this.barCount;e++)this.channels[t].bars[e]=a.read(i)+1}else{let i=0;for(;1<<i<this.patternsPerChannel+1;)i++;e=Math.ceil(this.getChannelCount()*this.barCount*i/6);const a=new O(t,n,n+e);for(let t=0;t<this.getChannelCount();t++)for(let e=0;e<this.barCount;e++)this.channels[t].bars[e]=a.read(i)}n+=e}break;case 112:{let a,r=0,l=!(o&&"jummbox"==i||"beepbox"==i),c=l?4:3,m=l?16:8;if(s&&"beepbox"==i)a=N[t.charCodeAt(n++)],n++,r=N[t.charCodeAt(n++)],r<<=6,r+=N[t.charCodeAt(n++)];else{a=0;let e=V(1,4,N[t.charCodeAt(n++)]);for(;e>0;)r<<=6,r+=N[t.charCodeAt(n++)],e--}const d=new O(t,n,n+r);n+=r;let f=0;for(;1<<f<this.instrumentsPerChannel;)f++;for(;;){const t=this.getChannelIsNoise(a),n=this.getChannelIsMod(a);if(n)for(let t=0;t<this.instrumentsPerChannel;t++){let n=this.channels[a].instruments[t];for(let t=0;t<e.modCount;t++)n.modStatuses[t]=d.read(2),n.modStatuses[t]!=Q.msForPitch&&n.modStatuses[t]!=Q.msForNoise||(n.modStatuses[t]==Q.msForPitch?n.modChannels[t]=W(0,this.pitchChannelCount+1,d.read(8)):n.modChannels[t]=W(0,this.noiseChannelCount+1,d.read(8)),n.modInstruments[t]=W(0,this.instrumentsPerChannel+1,d.read(f))),n.modStatuses[t]!=Q.msNone&&(n.modSettings[t]=d.read(6))}const r=t||n?0:12*this.channels[a].octave;let o=null,p=null,u=(t||n?4:12)+r;const y=n?[0,1,2,3,4,5]:t?[4,6,7,2,3,8,0,10]:[12,19,24,31,36,7,0],v=[];for(let t=0;t<y.length;t++)y[t]+=r;for(let t=0;t<this.patternsPerChannel;t++){const r=this.channels[a].patterns[t];if(r.reset(),r.instrument=d.read(f),("beepbox"!=i||!s)&&0==d.read(1))continue;let g=0;const b=r.notes;for(;g<this.beatsPerBar*e.partsPerBeat+ +n;){const t=1==d.read(1);let a=!1,r=0;if(t?r=V(0,v.length-1,d.readLongTail(0,0)):a=1==d.read(1),t||a){let a,s,f;if(t)a=v[r],v.splice(r,1);else{if(a={},l)1==d.read(1)?a.pitchCount=d.read(3)+2:a.pitchCount=1;else for(a.pitchCount=1;a.pitchCount<4&&1==d.read(1);)a.pitchCount++;a.pinCount=d.readPinCount(),a.initialVolume="beepbox"==i?2*d.read(2):n?d.read(9):d.read(3),a.pins=[],a.length=0,a.bendCount=0;for(let t=0;t<a.pinCount;t++)s={},s.pitchBend=1==d.read(1),s.pitchBend&&a.bendCount++,a.length+=h&&"beepbox"==i?d.readLegacyPartDuration()*e.partsPerBeat/e.rhythms[this.rhythm].stepsPerBeat:d.readPartDuration(),s.time=a.length,s.volume="beepbox"==i?2*d.read(2):n?d.read(9):d.read(3),a.pins.push(s)}v.unshift(a),v.length>10&&v.pop(),o=new U(0,g,g+a.length,a.initialVolume),o.pitches=[],o.pins.length=1;const k=[];for(let t=0;t<a.pitchCount+a.bendCount;t++){if(1==d.read(1)){const t=V(0,y.length-1,d.read(c));f=y[t],y.splice(t,1)}else{const t=d.readPitchInterval();f=u;let e=t;for(;e>0;){for(f++;-1!=y.indexOf(f);)f++;e--}for(;e<0;){for(f--;-1!=y.indexOf(f);)f--;e++}}y.unshift(f),y.length>m&&y.pop(),t<a.pitchCount?o.pitches.push(f):k.push(f),u=t==a.pitchCount-1?o.pitches[0]:f}k.unshift(o.pitches[0]);for(const t of a.pins)t.pitchBend&&k.shift(),p=L(k[0]-o.pitches[0],t.time,t.volume),o.pins.push(p);g=V(0,this.beatsPerBar*e.partsPerBeat,o.end),b.push(o)}else if(n){const t=1==d.read(1),e=d.readPartDuration();t?g-=e:g+=e}else{g+=h&&"beepbox"==i?d.readLegacyPartDuration()*e.partsPerBeat/e.rhythms[this.rhythm].stepsPerBeat:d.readPartDuration()}}}if(s&&"beepbox"==i)break;if(a++,a>=this.getChannelCount())break}}break;default:throw new Error("Unrecognized song tag code "+String.fromCharCode(d)+" at index "+(n-1))}for(let t=0;t<this.getChannelCount();t++)null!=y[t]&&(this.channels[t].octave=y[t])}toJsonObject(t=!0,n=1,i=!0){const a=[];for(let r=0;r<this.getChannelCount();r++){const s=[],o=this.getChannelIsNoise(r),l=this.getChannelIsMod(r);for(let t=0;t<this.instrumentsPerChannel;t++)s.push(this.channels[r].instruments[t].toJsonObject());const c=[];for(const t of this.channels[r].patterns){const n=[];for(const i of t.notes){let a=this.getVolumeCapForSetting(l,this.channels[r].instruments[t.instrument].modSettings[e.modCount-i.pitches[0]-1]);const s=[];for(const t of i.pins){let n=l?Math.round(t.volume):Math.round(100*t.volume/a);s.push({tick:(t.time+i.start)*e.rhythms[this.rhythm].stepsPerBeat/e.partsPerBeat,pitchBend:t.interval,volume:n,forMod:l})}n.push({pitches:i.pitches,points:s})}c.push({instrument:t.instrument+1,notes:n})}const h=[];if(t)for(let t=0;t<this.loopStart;t++)h.push(this.channels[r].bars[t]);for(let t=0;t<n;t++)for(let t=this.loopStart;t<this.loopStart+this.loopLength;t++)h.push(this.channels[r].bars[t]);if(i)for(let t=this.loopStart+this.loopLength;t<this.barCount;t++)h.push(this.channels[r].bars[t]);a.push({type:l?"mod":o?"drum":"pitch",octaveScrollBar:this.channels[r].octave,instruments:s,patterns:c,sequence:h})}return{name:this.title,format:X.L,version:X.H,scale:e.scales[this.scale].name,key:e.keys[this.key].name,introBars:this.loopStart,loopBars:this.loopLength,beatsPerBar:this.beatsPerBar,ticksPerBeat:e.rhythms[this.rhythm].stepsPerBeat,beatsPerMinute:this.tempo,reverb:this.reverb,channels:a}}fromJsonObject(t){if(this.initToDefault(!0),!t)return;if(null!=t.name&&(this.title=t.name),this.scale=0,null!=t.scale){const n={"romani :)":"dbl harmonic :)","romani :(":"dbl harmonic :(",enigma:"strange"},i=null!=n[t.scale]?n[t.scale]:t.scale,a=e.scales.findIndex((t=>t.name==i));-1!=a&&(this.scale=a)}if(null!=t.key)if("number"==typeof t.key)this.key=(t.key+1200>>>0)%e.keys.length;else if("string"==typeof t.key){const e=t.key,n=e.charAt(0).toUpperCase(),i=e.charAt(1).toLowerCase();let a={C:0,D:2,E:4,F:5,G:7,A:9,B:11}[n];const r={"#":1,"♯":1,b:-1,"♭":-1}[i];null!=a&&(null!=r&&(a+=r),a<0&&(a+=12),a%=12,this.key=a)}null!=t.beatsPerMinute&&(this.tempo=W(e.tempoMin,e.tempoMax+1,0|t.beatsPerMinute)),null!=t.reverb&&(this.reverb=W(0,e.reverbRange,0|t.reverb)),null!=t.beatsPerBar&&(this.beatsPerBar=Math.max(e.beatsPerBarMin,Math.min(e.beatsPerBarMax,0|t.beatsPerBar)));let n=4;null!=t.ticksPerBeat&&(n=0|t.ticksPerBeat||4,this.rhythm=e.rhythms.findIndex((t=>t.stepsPerBeat==n)),-1==this.rhythm&&(this.rhythm=1));let i=1,a=1,r=1;if(t.channels)for(const e of t.channels)e.instruments&&(i=Math.max(i,0|e.instruments.length)),e.patterns&&(a=Math.max(a,0|e.patterns.length)),e.sequence&&(r=Math.max(r,0|e.sequence.length));this.instrumentsPerChannel=Math.min(i,e.instrumentsPerChannelMax),this.patternsPerChannel=Math.min(a,e.barCountMax),this.barCount=Math.min(r,e.barCountMax),null!=t.introBars&&(this.loopStart=W(0,this.barCount,0|t.introBars)),null!=t.loopBars&&(this.loopLength=W(1,this.barCount-this.loopStart+1,0|t.loopBars));const s=[],o=[],l=[];if(t.channels)for(let i=0;i<t.channels.length;i++){let a=t.channels[i];const r=new Z;let c=!1,h=!1;null!=a.type?(c="drum"==a.type,h="mod"==a.type):c=i>=3,c?o.push(r):h?l.push(r):s.push(r),null!=a.octaveScrollBar&&(r.octave=W(0,e.maxScrollableOctaves-+(window.localStorage.getItem("extraOctaves")||"0")+1,0|a.octaveScrollBar));for(let t=r.instruments.length;t<this.instrumentsPerChannel;t++)r.instruments[t]=new _(c,h);r.instruments.length=this.instrumentsPerChannel;for(let t=r.patterns.length;t<this.patternsPerChannel;t++)r.patterns[t]=new j;r.patterns.length=this.patternsPerChannel;for(let t=0;t<this.barCount;t++)r.bars[t]=1;r.bars.length=this.barCount;for(let t=0;t<this.instrumentsPerChannel;t++){r.instruments[t].fromJsonObject(a.instruments[t],c,h,0==this.rhythm||2==this.rhythm,this.rhythm>=2)}for(let t=0;t<this.patternsPerChannel;t++){const i=r.patterns[t];let s=void 0;if(a.patterns&&(s=a.patterns[t]),null!=s&&(i.instrument=W(0,this.instrumentsPerChannel,(0|s.instrument)-1),s.notes&&s.notes.length>0)){const t=Math.min(this.beatsPerBar*e.partsPerBeat,s.notes.length>>>0);for(let a=0;a<s.notes.length&&!(a>=t);a++){const t=s.notes[a];if(!(t&&t.pitches&&t.pitches.length>=1&&t.points&&t.points.length>=2))continue;const o=new U(0,0,0,0);o.pitches=[],o.pins=[];for(let n=0;n<t.pitches.length;n++){const i=0|t.pitches[n];if(-1==o.pitches.indexOf(i)&&(o.pitches.push(i),o.pitches.length>=e.maxChordSize))break}if(o.pitches.length<1)continue;let l=0;for(let a=0;a<t.points.length;a++){const s=t.points[a];if(null==s||null==s.tick)continue;const c=null==s.pitchBend?0:0|s.pitchBend,m=Math.round(+s.tick*e.partsPerBeat/n);let d,f=this.getVolumeCapForSetting(h,r.instruments[i.instrument].modSettings[e.modCount-o.pitches[0]-1]);d=null==s.volume?f:null==s.forMod?Math.max(0,Math.min(f,Math.round((0|s.volume)*f/100))):(0|s.forMod)>0?Math.round(0|s.volume):Math.max(0,Math.min(f,Math.round((0|s.volume)*f/100))),m>this.beatsPerBar*e.partsPerBeat||(0==o.pins.length&&(o.start=m,l=c),o.pins.push(L(c-l,m-o.start,d)))}if(o.pins.length<2)continue;o.end=o.pins[o.pins.length-1].time+o.start;const m=c?e.drumCount-1:e.maxPitch;let d=m,f=0;for(let t=0;t<o.pitches.length;t++)o.pitches[t]+=l,(o.pitches[t]<0||o.pitches[t]>m)&&(o.pitches.splice(t,1),t--),o.pitches[t]<d&&(d=o.pitches[t]),o.pitches[t]>f&&(f=o.pitches[t]);if(!(o.pitches.length<1)){for(let t=0;t<o.pins.length;t++){const e=o.pins[t];e.interval+d<0&&(e.interval=-d),e.interval+f>m&&(e.interval=m-f),t>=2&&e.interval==o.pins[t-1].interval&&e.interval==o.pins[t-2].interval&&e.volume==o.pins[t-1].volume&&e.volume==o.pins[t-2].volume&&(o.pins.splice(t-1,1),t--)}i.notes.push(o)}}}}for(let t=0;t<this.barCount;t++)r.bars[t]=a.sequence?Math.min(this.patternsPerChannel,a.sequence[t]>>>0):0}s.length>e.pitchChannelCountMax&&(s.length=e.pitchChannelCountMax),o.length>e.noiseChannelCountMax&&(o.length=e.noiseChannelCountMax),l.length>e.modChannelCountMax&&(l.length=e.modChannelCountMax),this.pitchChannelCount=s.length,this.noiseChannelCount=o.length,this.modChannelCount=l.length,this.channels.length=0,Array.prototype.push.apply(this.channels,s),Array.prototype.push.apply(this.channels,o),Array.prototype.push.apply(this.channels,l)}getPattern(t,e){if(e<0||e>=this.barCount)return null;const n=this.channels[t].bars[e];return 0==n?null:this.channels[t].patterns[n-1]}getPatternInstrument(t,e){const n=this.getPattern(t,e);return null==n?0:n.instrument}getBeatsPerMinute(){return this.tempo}}X.L="BeepBox",X.O=2,X.N=8,X.I=1,X.H=4,X.T=106;class Y{constructor(){this.pitches=[0,0,0,0],this.pitchCount=0,this.chordSize=0,this.drumsetPitch=0,this.note=null,this.prevNote=null,this.nextNote=null,this.prevNotePitchIndex=0,this.nextNotePitchIndex=0,this.active=!1,this.noteStart=0,this.noteEnd=0,this.noteLengthTicks=0,this.ticksSinceReleased=0,this.liveInputSamplesHeld=0,this.lastInterval=0,this.lastVolume=0,this.stereoVolume1=0,this.stereoVolume2=0,this.stereoOffset=0,this.stereoDelay=0,this.sample=0,this.phases=[],this.phaseDeltas=[],this.volumeStarts=[],this.volumeDeltas=[],this.volumeStart=0,this.volumeDelta=0,this.phaseDeltaScale=0,this.pulseWidth=0,this.pulseWidthDelta=0,this.filter=0,this.filterScale=0,this.filterSample0=0,this.filterSample1=0,this.vibratoScale=0,this.intervalMult=0,this.intervalVolumeMult=1,this.feedbackOutputs=[],this.feedbackMult=0,this.feedbackDelta=0,this.stereoVolumeLStart=0,this.stereoVolumeRStart=0,this.stereoVolumeLDelta=0,this.stereoVolumeRDelta=0,this.stereoDelayStart=0,this.stereoDelayEnd=0,this.stereoDelayDelta=0,this.customVolumeStart=0,this.customVolumeEnd=0,this.filterResonanceStart=0,this.filterResonanceDelta=0,this.isFirstOrder=!1,this.reset()}reset(){for(let t=0;t<e.operatorCount;t++)this.phases[t]=0,this.feedbackOutputs[t]=0;this.sample=0,this.filterSample0=0,this.filterSample1=0,this.liveInputSamplesHeld=0}}class tt{constructor(t=null){this.samplesPerSecond=44100,this.song=null,this.liveInputDuration=0,this.liveInputStarted=!1,this.liveInputPitches=[],this.liveInputChannel=0,this.loopRepeatCount=-1,this.volume=1,this.wantToSkip=!1,this.playheadInternal=0,this.bar=0,this.beat=0,this.part=0,this.tick=0,this.tickSampleCountdown=0,this.isPlayingSong=!1,this.liveInputEndTime=0,this.tonePool=new B,this.activeTones=[],this.tyingOver=[],this.activeModTones=[],this.releasedTones=[],this.liveInputTones=new B,this.limit=0,this.stereoBufferIndex=0,this.samplesForNone=null,this.samplesForReverb=null,this.samplesForChorus=null,this.samplesForChorusReverb=null,this.chorusDelayLine=new Float32Array(2048),this.chorusDelayPos=0,this.chorusPhase=0,this.reverbDelayLine=new Float32Array(16384),this.reverbDelayPos=0,this.reverbFeedback0=0,this.reverbFeedback1=0,this.reverbFeedback2=0,this.reverbFeedback3=0,this.audioCtx=null,this.scriptNode=null,this.audioProcessCallback=t=>{const e=t.outputBuffer,n=e.getChannelData(0),i=e.getChannelData(1);if(performance.now()<this.liveInputEndTime||this.isPlayingSong)this.synthesize(n,i,e.length,this.isPlayingSong);else{for(let t=0;t<e.length;t++)n[t]=0,i[t]=0;this.deactivateAudio()}},null!=t&&this.setSong(t)}warmUpSynthesizer(t){if(null!=t)for(let e=0;e<t.getChannelCount();e++)for(let n=0;n<t.instrumentsPerChannel;n++)tt.getInstrumentSynthFunction(t.channels[e].instruments[n]),t.channels[e].instruments[n].warmUp()}computeLatestModValues(){if(null!=this.song&&this.song.modChannelCount>0){let t=[],n=[];this.modValues=[],this.nextModValues=[],this.modInsValues=[],this.nextModInsValues=[];for(let t=0;t<this.song.pitchChannelCount+this.song.noiseChannelCount;t++){n[t]=[],this.modInsValues[t]=[],this.nextModInsValues[t]=[];for(let e=0;e<this.song.instrumentsPerChannel;e++)this.modInsValues[t][e]=[],this.nextModInsValues[t][e]=[],n[t][e]=[]}let i=this.beat*e.partsPerBeat+this.part;for(let a=this.song.pitchChannelCount+this.song.noiseChannelCount;a<this.song.getChannelCount();a++)if(!this.song.channels[a].muted){let r;for(let s=this.bar;s>=0;s--)if(r=this.song.getPattern(a,s),null!=r){let o=this.song.getPatternInstrument(a,s),l=this.song.channels[a].instruments[o],c=[],h=[],m=s==this.bar?i:this.findPartsInBar(s);for(const t of r.notes)if(t.start<m&&(null==c[e.modCount-1-t.pitches[0]]||t.end>c[e.modCount-1-t.pitches[0]]))if(t.end<=m)c[e.modCount-1-t.pitches[0]]=t.end,h[e.modCount-1-t.pitches[0]]=t.pins[t.pins.length-1].volume;else{c[e.modCount-1-t.pitches[0]]=m;for(let n=0;n<t.pins.length;n++)if(t.pins[n].time+t.start>m){const i=t.pins[n].time-t.pins[n-1].time,a=m-t.start-t.pins[n-1].time,r=t.pins[n].volume-t.pins[n-1].volume;h[e.modCount-1-t.pitches[0]]=Math.round(t.pins[n-1].volume+r*a/i),n=t.pins.length}}for(let i=0;i<e.modCount;i++)null!=c[i]&&(l.modStatuses[i]==Q.msForSong?(null==t[l.modSettings[i]]||s*e.partsPerBeat*this.song.beatsPerBar+c[i]>t[l.modSettings[i]])&&(this.setModValue(h[i],h[i],i,l,l.modSettings[i]),t[l.modSettings[i]]=s*e.partsPerBeat*this.song.beatsPerBar+c[i]):(null==n[l.modChannels[i]][l.modInstruments[i]][l.modSettings[i]]||s*e.partsPerBeat*this.song.beatsPerBar+c[i]>n[l.modChannels[i]][l.modInstruments[i]][l.modSettings[i]])&&(this.setModValue(h[i],h[i],i,l,l.modSettings[i]),n[l.modChannels[i]][l.modInstruments[i]][l.modSettings[i]]=s*e.partsPerBeat*this.song.beatsPerBar+c[i]))}}}}static operatorAmplitudeCurve(t){return(Math.pow(16,t/15)-1)/15}get playing(){return this.isPlayingSong}get playhead(){return this.playheadInternal}set playhead(t){if(null!=this.song){this.playheadInternal=Math.max(0,Math.min(this.song.barCount,t));let n=this.playheadInternal;this.bar=Math.floor(n),n=this.song.beatsPerBar*(n-this.bar),this.beat=Math.floor(n),n=e.partsPerBeat*(n-this.beat),this.part=Math.floor(n),n=e.ticksPerPart*(n-this.part),this.tick=Math.floor(n);const i=this.getSamplesPerTick();n=i*(n-this.tick),this.tickSampleCountdown=i-n}}getSamplesPerBar(){if(null==this.song)throw new Error;return this.getSamplesPerTick()*e.ticksPerPart*e.partsPerBeat*this.song.beatsPerBar}findPartsInBar(t){if(null==this.song)return 0;let n=e.partsPerBeat*this.song.beatsPerBar;for(let i=this.song.pitchChannelCount+this.song.noiseChannelCount;i<this.song.getChannelCount();i++){let a=this.song.getPattern(i,t);if(null!=a){let t=this.song.channels[i].instruments[a.instrument];for(let i=0;i<e.modCount;i++)if(t.modSettings[i]==J.mstNextBar&&t.modStatuses[i]==Q.msForSong)for(const t of a.notes)t.pitches[0]==e.modCount-1-i&&n>t.start&&(n=t.start)}}return n}getTotalSamples(t,n,i){if(null==this.song)return-1;let a=t?0:this.song.loopStart,r=n?this.song.barCount:this.song.loopStart+this.song.loopLength,s=!1,o=!1,l=this.song.tempo;for(let t=this.song.pitchChannelCount+this.song.noiseChannelCount;t<this.song.getChannelCount();t++)for(let n=a;n<r;n++){let i=this.song.getPattern(t,n);if(null!=i){let n=this.song.channels[t].instruments[i.instrument];for(let t=0;t<e.modCount;t++)n.modSettings[t]==J.mstTempo&&n.modStatuses[t]==Q.msForSong&&(s=!0),n.modSettings[t]==J.mstNextBar&&n.modStatuses[t]==Q.msForSong&&(o=!0)}}if(a>0){let t=null,n=0;for(let i=a-1;i>=0;i--){for(let a=this.song.pitchChannelCount+this.song.noiseChannelCount;a<this.song.getChannelCount();a++){let r=this.song.getPattern(a,i);if(null!=r){let s=this.song.getPatternInstrument(a,i),o=this.song.channels[a].instruments[s],l=this.findPartsInBar(i);for(const i of r.notes)if(o.modSettings[e.modCount-1-i.pitches[0]]==J.mstTempo&&o.modStatuses[e.modCount-1-i.pitches[0]]==Q.msForSong&&i.start<l&&(null==t||i.end>t))if(i.end<=l)t=i.end,n=i.pins[i.pins.length-1].volume;else{t=l;for(let t=0;t<i.pins.length;t++)if(i.pins[t].time+i.start>l){const e=i.pins[t].time-i.pins[t-1].time,a=l-i.start-i.pins[t-1].time,r=i.pins[t].volume-i.pins[t-1].volume;n=Math.round(i.pins[t-1].volume+r*a/e),t=i.pins.length}}}}null!=t&&(l=this.song.modValueToReal(n,J.mstTempo),i=-1)}}if(s||o){let t=a,n=!1,c=0;for(;!n;){let a=e.partsPerBeat*this.song.beatsPerBar,h=0;if(o&&(a=this.findPartsInBar(t)),s){let n=!1;for(let i=this.song.pitchChannelCount+this.song.noiseChannelCount;i<this.song.getChannelCount();i++)if(0==n){let r=this.song.getPattern(i,t);if(null!=r){let t=this.song.channels[i].instruments[r.instrument];for(let i=0;i<e.modCount;i++)if(0==n&&t.modSettings[i]==J.mstTempo&&t.modStatuses[i]==Q.msForSong&&r.notes.find((t=>t.pitches[0]==e.modCount-1-i))){n=!0,r.notes.sort((function(t,e){return t.start==e.start?t.pitches[0]-e.pitches[0]:t.start-e.start}));for(const t of r.notes)if(t.pitches[0]==e.modCount-1-i&&(c+=Math.min(a-h,t.start-h)*e.ticksPerPart*this.getSamplesPerTickSpecificBPM(l),t.start<a))for(let n=1;n<t.pins.length;n++){if(t.pins[n-1].time+t.start<=a){const i=e.ticksPerPart*Math.min(a-(t.start+t.pins[n-1].time),t.pins[n].time-t.pins[n-1].time),r=this.song.modValueToReal(t.pins[n-1].volume,J.mstTempo);let s=this.song.modValueToReal(t.pins[n].volume,J.mstTempo);t.pins[n].time+t.start>a&&(s=this.song.modValueToReal(t.pins[n-1].volume+(t.pins[n].volume-t.pins[n-1].volume)*(a-(t.start+t.pins[n-1].time))/(t.pins[n].time-t.pins[n-1].time),J.mstTempo));let o=e.partsPerBeat*e.ticksPerPart/60;c+=s!=r?-this.samplesPerSecond*i*(Math.log(o*s*i)-Math.log(o*r*i))/(o*(r-s)):i*this.getSamplesPerTickSpecificBPM(s),l=s}h=Math.min(t.start+t.pins[n].time,a)}}}}}c+=(a-h)*e.ticksPerPart*this.getSamplesPerTickSpecificBPM(l),t++,0!=i&&t==this.song.loopStart+this.song.loopLength&&(t=this.song.loopStart,i>0&&i--),t>=r&&(n=!0)}return Math.ceil(c)}return this.getSamplesPerBar()*this.getTotalBars(t,n,i)}getTotalBars(t,e,n=this.loopRepeatCount){if(null==this.song)throw new Error;let i=this.song.loopLength*(n+1);return t&&(i+=this.song.loopStart),e&&(i+=this.song.barCount-(this.song.loopStart+this.song.loopLength)),i}setSong(t){"string"==typeof t?this.song=new X(t):t instanceof X&&(this.song=t)}setModValue(t,e,n,i,a){let r,s;switch(a){case J.mstSongVolume:case J.mstReverb:case J.mstTempo:case J.mstSongDetune:r=this.song.modValueToReal(t,a),s=this.song.modValueToReal(e,a),null!=this.modValues[a]&&this.modValues[a]==r&&this.nextModValues[a]==s||(this.modValues[a]=r,this.nextModValues[a]=s);break;case J.mstInsVolume:case J.mstPan:case J.mstPulseWidth:case J.mstFilterCut:case J.mstFilterPeak:case J.mstFMSlider1:case J.mstFMSlider2:case J.mstFMSlider3:case J.mstFMSlider4:case J.mstFMFeedback:case J.mstVibratoDepth:case J.mstVibratoSpeed:case J.mstVibratoDelay:case J.mstArpeggioSpeed:case J.mstPanDelay:case J.mstResetArpeggio:case J.mstDetune:r=this.song.modValueToReal(t,a),s=this.song.modValueToReal(e,a);let o=i.modChannels[n]+(i.modStatuses[n]==Q.msForNoise?this.song.pitchChannelCount:0);null!=this.modInsValues[o][i.modInstruments[n]][a]&&this.modInsValues[o][i.modInstruments[n]][a]==r&&this.nextModInsValues[o][i.modInstruments[n]][a]==s||(this.modInsValues[o][i.modInstruments[n]][a]=r,this.nextModInsValues[o][i.modInstruments[n]][a]=s);break;case J.mstNextBar:r=this.song.modValueToReal(t,a);break;case J.mstNone:default:r=-1}return r}getModValue(t,e,n,i,a){if(e){if(null!=this.modValues[t]&&null!=this.nextModValues[t])return a?this.nextModValues[t]:this.modValues[t]}else if(null!=n&&null!=i&&null!=this.modInsValues[n][i][t]&&null!=this.nextModInsValues[n][i][t])return a?this.nextModInsValues[n][i][t]:this.modInsValues[n][i][t];return-1}isAnyModActive(t,e){for(let n=0;n<J.mstMaxValue;n++)if(null!=this.modValues&&null!=this.modValues[n]||null!=this.modInsValues&&null!=this.modInsValues[t]&&null!=this.modInsValues[t][e]&&null!=this.modInsValues[t][e][n])return!0;return!1}unsetMod(t,e,n){(this.isModActive(t,!0)||null!=e&&null!=n&&this.isModActive(t,!1,e,n))&&(this.modValues[t]=null,this.nextModValues[t]=null,null!=e&&null!=n&&(this.modInsValues[e][n][t]=null,this.nextModInsValues[e][n][t]=null))}isModActive(t,e,n,i){return e?null!=this.modValues&&null!=this.modValues[t]:null!=n&&null!=i&&null!=this.modInsValues&&null!=this.modInsValues[n]&&null!=this.modInsValues[n][i]&&null!=this.modInsValues[n][i][t]&&null!=this.modInsValues[n][i][t]}activateAudio(){null!=this.audioCtx&&null!=this.scriptNode||(this.audioCtx=this.audioCtx||new(window.AudioContext||window.webkitAudioContext),this.samplesPerSecond=this.audioCtx.sampleRate,this.scriptNode=this.audioCtx.createScriptProcessor?this.audioCtx.createScriptProcessor(2048,0,2):this.audioCtx.createJavaScriptNode(2048,0,2),this.scriptNode.onaudioprocess=this.audioProcessCallback,this.scriptNode.channelCountMode="explicit",this.scriptNode.channelInterpretation="speakers",this.scriptNode.connect(this.audioCtx.destination)),this.audioCtx.resume()}deactivateAudio(){null!=this.audioCtx&&null!=this.scriptNode&&(this.scriptNode.disconnect(this.audioCtx.destination),this.scriptNode=null,this.audioCtx.close&&this.audioCtx.close(),this.audioCtx=null)}maintainLiveInput(){this.activateAudio(),this.liveInputEndTime=performance.now()+1e4}play(){this.isPlayingSong||(this.isPlayingSong=!0,this.warmUpSynthesizer(this.song),this.computeLatestModValues(),this.activateAudio())}pause(){this.isPlayingSong&&(this.isPlayingSong=!1,null!=this.song&&(this.song.inVolumeCap=0,this.song.outVolumeCap=0),this.modValues=[],this.modInsValues=[],this.nextModValues=[],this.nextModInsValues=[],this.tyingOver=[])}snapToStart(){this.bar=0,this.snapToBar()}goToBar(t){this.bar=t,this.playheadInternal=this.bar}snapToBar(){this.playheadInternal=this.bar,this.beat=0,this.part=0,this.tick=0,this.tickSampleCountdown=0}resetEffects(){this.reverbDelayPos=0,this.reverbFeedback0=0,this.reverbFeedback1=0,this.reverbFeedback2=0,this.reverbFeedback3=0,this.freeAllTones();for(let t=0;t<this.reverbDelayLine.length;t++)this.reverbDelayLine[t]=0;for(let t=0;t<this.chorusDelayLine.length;t++)this.chorusDelayLine[t]=0;if(null!=this.samplesForNone)for(let t=0;t<this.samplesForNone.length;t++)this.samplesForNone[t]=0;if(null!=this.samplesForReverb)for(let t=0;t<this.samplesForReverb.length;t++)this.samplesForReverb[t]=0;if(null!=this.samplesForChorus)for(let t=0;t<this.samplesForChorus.length;t++)this.samplesForChorus[t]=0;if(null!=this.samplesForChorusReverb)for(let t=0;t<this.samplesForChorusReverb.length;t++)this.samplesForChorusReverb[t]=0}jumpIntoLoop(){if(this.song&&(this.bar<this.song.loopStart||this.bar>=this.song.loopStart+this.song.loopLength)){const t=this.bar;this.bar=this.song.loopStart,this.playheadInternal+=this.bar-t,this.playing&&this.computeLatestModValues()}}nextBar(){if(!this.song)return;const t=this.bar;this.bar++,this.bar>=this.song.barCount&&(this.bar=0),this.playheadInternal+=this.bar-t;for(let t=0;t<this.song.pitchChannelCount+this.song.noiseChannelCount;t++)this.tyingOver[t]=-1;this.playing&&this.computeLatestModValues()}skipBar(){if(!this.song)return;const t=this.getSamplesPerTick();this.bar++,this.beat=0,this.part=0,this.tick=0,this.tickSampleCountdown=t,0!=this.loopRepeatCount&&this.bar==this.song.loopStart+this.song.loopLength&&(this.bar=this.song.loopStart,this.loopRepeatCount>0&&this.loopRepeatCount--)}firstBar(){if(this.song){this.bar=0,this.playheadInternal=0,this.beat=0,this.part=0;for(let t=0;t<this.song.pitchChannelCount+this.song.noiseChannelCount;t++)this.tyingOver[t]=-1;this.playing&&this.computeLatestModValues()}}jumpToEditingBar(t){if(this.song){this.bar=t,this.playheadInternal=t,this.beat=0,this.part=0;for(let t=0;t<this.song.pitchChannelCount+this.song.noiseChannelCount;t++)this.tyingOver[t]=-1;this.playing&&this.computeLatestModValues()}}prevBar(){if(!this.song)return;const t=this.bar;this.bar--,(this.bar<0||this.bar>=this.song.barCount)&&(this.bar=this.song.barCount-1),this.playheadInternal+=this.bar-t;for(let t=0;t<this.song.pitchChannelCount+this.song.noiseChannelCount;t++)this.tyingOver[t]=-1;this.playing&&this.computeLatestModValues()}synthesize(t,n,i,a=!0){if(null==this.song){for(let e=0;e<i;e++)t[e]=0,n[e]=0;return void this.deactivateAudio()}this.song.inVolumeCap=0,this.song.outVolumeCap=0;const r=this.song.pitchChannelCount+this.song.noiseChannelCount;for(let t=this.activeTones.length;t<r;t++)this.activeTones[t]=new B,this.releasedTones[t]=new B;if(this.activeTones.length=r,this.releasedTones.length=r,r!=this.tyingOver.length){let t=this.tyingOver.length;for(this.tyingOver.length=r;t<this.tyingOver.length;)this.tyingOver[t++]=-1}for(let t=this.activeModTones.length;t<this.song.modChannelCount;t++){this.activeModTones[t]=[];for(let n=0;n<e.modCount;n++)this.activeModTones[t][n]=new B;this.activeModTones[t].length=e.modCount}this.activeModTones.length=this.song.modChannelCount;let s=this.getSamplesPerTick(),o=0,l=!1;for(;this.tickSampleCountdown<=0;)this.tickSampleCountdown+=s;this.tickSampleCountdown>s&&(this.tickSampleCountdown=s),a&&(this.beat>=this.song.beatsPerBar&&(this.bar++,this.beat=0,this.part=0,this.tick=0,this.tickSampleCountdown=s,0!=this.loopRepeatCount&&this.bar==this.song.loopStart+this.song.loopLength&&(this.bar=this.song.loopStart,this.loopRepeatCount>0&&this.loopRepeatCount--)),this.bar>=this.song.barCount&&(this.bar=0,-1!=this.loopRepeatCount&&(l=!0,this.pause())));const c=4*i;null!=this.samplesForNone&&this.samplesForNone.length==c&&null!=this.samplesForReverb&&this.samplesForReverb.length==c&&null!=this.samplesForChorus&&this.samplesForChorus.length==c&&null!=this.samplesForChorusReverb&&this.samplesForChorusReverb.length==c||(this.samplesForNone=new Float32Array(c),this.samplesForReverb=new Float32Array(c),this.samplesForChorus=new Float32Array(c),this.samplesForChorusReverb=new Float32Array(c),this.stereoBufferIndex=0);let h=this.stereoBufferIndex;const m=this.samplesForNone,d=this.samplesForReverb,f=this.samplesForChorus,p=this.samplesForChorusReverb,u=+this.volume,y=this.chorusDelayLine,v=this.reverbDelayLine,g=2*Math.PI/(2*this.samplesPerSecond),b=150*this.samplesPerSecond/44100,k=2048-1.51*b,w=2048-2.1*b,M=2048-3.35*b,C=2048-1.47*b,E=2048-2.15*b,q=2048-3.25*b;let x=this.chorusPhase%(2*Math.PI),P=2047&this.chorusDelayPos,S=16383&this.reverbDelayPos,F=+this.reverbFeedback0,z=+this.reverbFeedback1,R=+this.reverbFeedback2,A=+this.reverbFeedback3,T=this.song.reverb;this.isModActive(J.mstReverb,!0)&&(T=this.getModValue(J.mstReverb,!0));let H=.425*Math.pow(T/e.reverbRange,.667);const D=1-Math.pow(.5,this.song.limitDecay/this.samplesPerSecond),N=1-Math.pow(.5,this.song.limitRise/this.samplesPerSecond),O=this.song.compressionThreshold,I=this.song.limitThreshold,L=this.song.compressionRatio,W=this.song.limitRatio,V=this.song.masterGain;let U=+this.limit;for(;o<i&&!l;){const T=i-o,B=Math.min(Math.ceil(this.tickSampleCountdown),T);for(let t=0,n=this.song.pitchChannelCount+this.song.noiseChannelCount;t<this.song.modChannelCount;t++,n++){this.determineCurrentActiveTones(this.song,n,a);for(let i=0;i<e.modCount;i++)for(let e=0;e<this.activeModTones[t][i].count();e++){const a=this.activeModTones[t][i].get(e);0==this.song.channels[n].muted&&this.playTone(this.song,h,c,n,s,B,a,!1,!1)}}this.wantToSkip&&(this.wantToSkip=!1,this.skipBar()),this.isModActive(J.mstReverb,!0)&&(H=.425*Math.pow(this.getModValue(J.mstReverb,!0)/e.reverbRange,.667));const nt=this.tickSampleCountdown,it=1-nt/s,at=1-(nt-B)/s,rt=(this.beat*e.partsPerBeat+this.part)*e.ticksPerPart+this.tick,st=rt/e.ticksPerPart,ot=(rt+1)/e.ticksPerPart,lt=st+(ot-st)*it,ct=st+(ot-st)*at;for(let t=0;t<this.song.pitchChannelCount+this.song.noiseChannelCount;t++)for(let e=0;e<this.song.instrumentsPerChannel;e++){let n=this.song.channels[t].instruments[e],i=n.vibratoSpeed;n.LFOtime=n.nextLFOtime,this.isModActive(J.mstVibratoSpeed,!1,t,e)&&(i=this.getModValue(J.mstVibratoSpeed,!1,t,e,!1)),0==i?(n.LFOtime=0,n.nextLFOtime=0):n.nextLFOtime+=.1*i*(ct-lt)}for(let t=0;t<this.song.pitchChannelCount+this.song.noiseChannelCount;t++){if(t==this.liveInputChannel){this.determineLiveInputTones(this.song);for(let e=0;e<this.liveInputTones.count();e++){const n=this.liveInputTones.get(e);this.playTone(this.song,h,c,t,s,B,n,!1,!1)}}this.determineCurrentActiveTones(this.song,t,a);for(let e=0;e<this.activeTones[t].count();e++){const n=this.activeTones[t].get(e);this.playTone(this.song,h,c,t,s,B,n,!1,!1)}for(let n=0;n<this.releasedTones[t].count();n++){const i=this.releasedTones[t].get(n);if(i.ticksSinceReleased>=i.instrument.getTransition().releaseTicks){this.freeReleasedTone(t,n),n--;continue}const a=n+this.activeTones[t].count()>=e.maximumTonesPerChannel;this.playTone(this.song,h,c,t,s,B,i,!0,a)}}let ht=P+k-b*Math.sin(x+0),mt=P+w-b*Math.sin(x+2.1),dt=P+M-b*Math.sin(x+4.2),ft=P+1024+C-b*Math.sin(x+3.2),pt=P+1024+E-b*Math.sin(x+5.3),ut=P+1024+q-b*Math.sin(x+1);x+=g*B;const yt=(P+B+k-b*Math.sin(x+0)-ht)/B,vt=(P+B+w-b*Math.sin(x+2.1)-mt)/B,gt=(P+B+M-b*Math.sin(x+4.2)-dt)/B,bt=(P+B+1024+C-b*Math.sin(x+3.2)-ft)/B,kt=(P+B+1024+E-b*Math.sin(x+5.3)-pt)/B,wt=(P+B+1024+q-b*Math.sin(x+1)-ut)/B,Mt=o+B;for(let e=o;e<Mt;e++){const i=h,a=h+1,r=m[i];m[i]=0;const s=m[a];m[a]=0;const o=d[i];d[i]=0;const l=d[a];d[a]=0;const c=f[i];f[i]=0;const g=f[a];f[a]=0;const b=p[i];p[i]=0;const k=p[a];p[a]=0,h+=2;const w=c+b,M=g+k,C=ht%1,E=mt%1,q=dt%1,x=ft%1,T=pt%1,B=ut%1,j=y[2047&ht],$=y[ht+1&2047],G=y[2047&mt],K=y[mt+1&2047],_=y[2047&dt],Q=y[dt+1&2047],J=y[2047&ft],Z=y[ft+1&2047],X=y[2047&pt],Y=y[pt+1&2047],tt=y[2047&ut],et=.5*(w-(j+($-j)*C)+(G+(K-G)*E)-(_+(Q-_)*q)),nt=.5*(M-(J+(Z-J)*x)+(X+(Y-X)*T)-(tt+(y[ut+1&2047]-tt)*B));y[P]=w,y[P+1024&2047]=M,P=P+1&2047,ht+=yt,mt+=vt,dt+=gt,ft+=bt,pt+=kt,ut+=wt;const it=S+3041&16383,at=S+6426&16383,rt=S+10907&16383,st=v[S],ot=v[it],lt=v[at],ct=v[rt],Mt=-(st+b+o)+ot,Ct=-(st+k+l)-ot,Et=-lt+ct,qt=-lt-ct;F+=.5*((Mt+Et)*H-F),z+=.5*((Ct+qt)*H-z),R+=.5*((Mt-Et)*H-R),A+=.5*((Ct-qt)*H-A),v[it]=F,v[at]=z,v[rt]=R,v[S]=A,S=S+1&16383;const xt=V*V*(r+et+o+ot+lt+ct),Pt=V*V*(s+nt+l+st+lt-ct),St=xt<0?-xt:xt,Ft=Pt<0?-Pt:Pt,zt=St>Ft?St:Ft;this.song.inVolumeCap=this.song.inVolumeCap>zt?this.song.inVolumeCap:zt;const Rt=+(zt>O)+ +(zt>I),At=+(0==Rt)*((.8*(zt+1-O)+.25)*L+1.05*(1-L))+1.05*+(1==Rt)+1.05*((zt+1-I)*W+(1-I))*+(2==Rt);U+=(At-U)*(U<At?N:D);const Tt=u/(U>=1?1.05*U:.8*U+.25);t[e]=xt*Tt,n[e]=Pt*Tt,this.song.outVolumeCap=this.song.outVolumeCap>zt*Tt?this.song.outVolumeCap:zt*Tt}if(o+=B,this.tickSampleCountdown-=B,this.tickSampleCountdown<=0){for(let t=0;t<this.song.pitchChannelCount+this.song.noiseChannelCount;t++)for(let n=0;n<this.releasedTones[t].count();n++){this.releasedTones[t].get(n).ticksSinceReleased++;n+this.activeTones[t].count()>=e.maximumTonesPerChannel&&(this.freeReleasedTone(t,n),n--)}for(let t=0;t<this.song.pitchChannelCount+this.song.noiseChannelCount;t++)for(let n=0;n<this.song.channels[t].instruments.length;n++){let i=this.song.channels[t].instruments[n],a=i.arpeggioSpeed;this.isModActive(J.mstArpeggioSpeed,!1,t,n)?(a=this.getModValue(J.mstArpeggioSpeed,!1,t,n,!1),Number.isInteger(a)?i.arpTime+=e.arpSpeedScale[a]:i.arpTime+=(1-a%1)*e.arpSpeedScale[Math.floor(a)]+a%1*e.arpSpeedScale[Math.ceil(a)]):i.arpTime+=e.arpSpeedScale[a]}if(this.tick++,this.tickSampleCountdown+=s,this.tick==e.ticksPerPart){this.tick=0,this.part++,this.liveInputDuration--;var j=this.part+this.beat*e.partsPerBeat>=this.findPartsInBar(this.bar)-1;for(let t=0;t<this.song.pitchChannelCount+this.song.noiseChannelCount;t++){var $=!1,G=this.activeTones[t].count(),K=this.song.getPattern(t,this.bar);if(null!=K&&j){var _=K.instrument;if(this.song.channels[t].instruments[_].tieNoteTransition&&G>0){var Q=this.bar+1;(Q>=this.song.barCount||Q>=this.song.loopStart+this.song.loopLength&&0!=this.loopRepeatCount)&&(Q=this.song.loopStart);var Z=this.song.getPattern(t,Q),X=this.activeTones[t].get(0).note;if(null!=X){for(var Y=0;X.pins[Y].time+X.start<this.part+this.beat*e.partsPerBeat&&Y<X.pins.length-1;)Y++;var tt=X.pins[Y].volume,et=X.pins[Y].interval;if(null!=Z&&Z.instrument==_)for(let n=0;n<Z.notes.length;n++)if(0==Z.notes[n].start&&Z.notes[n].pins[0].volume==tt&&Z.notes[n].pitches.length==X.pitches.length){$=!0;for(let t=0;t<X.pitches.length;t++)-1==Z.notes[n].pitches.findIndex((e=>e==X.pitches[t]+et))&&($=!1,t=X.pitches.length);n=Z.notes.length,$&&(this.part+this.beat*e.partsPerBeat<this.findPartsInBar(this.bar)?this.tyingOver[t]<0&&(this.tyingOver[t]=0):0==X.start&&this.tyingOver[t]>=0?this.tyingOver[t]+=this.part+this.beat*e.partsPerBeat:this.tyingOver[t]=this.part+this.beat*e.partsPerBeat-X.start)}}}}for(let n=0;n<this.activeTones[t].count();n++){const i=this.activeTones[t].get(n),a=i.instrument.getTransition();null!=i.note&&i.note.end==this.part+this.beat*e.partsPerBeat&&(a.isSeamless||i.instrument.clicklessTransition||this.tyingOver[t]>=0||(a.releases?this.releaseTone(t,i):this.freeTone(i),this.activeTones[t].remove(n),n--),$||(this.tyingOver[t]=-1))}}for(let t=0;t<this.song.modChannelCount;t++)for(let n=0;n<e.modCount;n++)for(let i=0;i<this.activeModTones[t][n].count();i++){const a=this.activeModTones[t][n].get(i);a.instrument.getTransition().isSeamless||null==a.note||a.note.end!=this.part+this.beat*e.partsPerBeat||(this.freeTone(a),this.activeModTones[t][n].remove(i),i--)}this.part==e.partsPerBeat&&(this.part=0,a&&(this.beat++,this.beat==this.song.beatsPerBar&&(this.beat=0,this.bar++,0!=this.loopRepeatCount&&this.bar==this.song.loopStart+this.song.loopLength&&(this.bar=this.song.loopStart,this.loopRepeatCount>0&&this.loopRepeatCount--),this.bar>=this.song.barCount&&(this.bar=0,-1!=this.loopRepeatCount&&(l=!0,this.resetEffects(),this.pause())))))}}for(let t=0;t<J.mstMaxValue;t++)null!=this.nextModValues&&null!=this.nextModValues[t]&&(this.modValues[t]=this.nextModValues[t]);this.isModActive(J.mstTempo,!0)&&(s=this.getSamplesPerTick(),this.tickSampleCountdown=Math.min(this.tickSampleCountdown,s));for(let t=0;t<this.song.pitchChannelCount;t++)for(let n of this.song.channels[t].instruments)n.nextLFOtime=n.nextLFOtime%(e.vibratoTypes[n.vibratoType].period/(e.ticksPerPart*s/this.samplesPerSecond)),n.arpTime=n.arpTime%(2520*e.ticksPerArpeggio);for(let t=0;t<J.mstMaxValue;t++)for(let e=0;e<r;e++)for(let n=0;n<this.song.instrumentsPerChannel;n++)null!=this.nextModInsValues&&null!=this.nextModInsValues[e]&&null!=this.nextModInsValues[e][n]&&null!=this.nextModInsValues[e][n][t]&&(this.modInsValues[e][n][t]=this.nextModInsValues[e][n][t])}const nt=1e-24;-1e-24<F&&F<nt&&(F=0),-1e-24<z&&z<nt&&(z=0),-1e-24<R&&R<nt&&(R=0),-1e-24<A&&A<nt&&(A=0),-1e-24<U&&U<nt&&(U=0),this.stereoBufferIndex=(this.stereoBufferIndex+2*i)%c,this.chorusPhase=x,this.chorusDelayPos=P,this.reverbDelayPos=S,this.reverbFeedback0=F,this.reverbFeedback1=z,this.reverbFeedback2=R,this.reverbFeedback3=A,this.limit=U,a&&(this.playheadInternal=(((this.tick+1-this.tickSampleCountdown/s)/2+this.part)/e.partsPerBeat+this.beat)/this.song.beatsPerBar+this.bar)}freeTone(t){this.tonePool.pushBack(t)}newTone(){if(this.tonePool.count()>0){const t=this.tonePool.popBack();return t.reset(),t.active=!1,t}return new Y}releaseTone(t,e){null!=this.song&&this.song.getChannelIsMod(t)||this.releasedTones[t].pushFront(e)}freeReleasedTone(t,e){null!=this.song&&this.song.getChannelIsMod(t)||(this.freeTone(this.releasedTones[t].get(e)),this.releasedTones[t].remove(e))}freeAllTones(){for(;this.liveInputTones.count()>0;)this.freeTone(this.liveInputTones.popBack());for(let t=0;t<this.activeTones.length;t++)for(;this.activeTones[t].count()>0;)this.freeTone(this.activeTones[t].popBack());for(let t=0;t<this.releasedTones.length;t++)for(;this.releasedTones[t].count()>0;)this.freeTone(this.releasedTones[t].popBack());for(let t=0;t<this.activeModTones.length;t++)for(let e=0;e<this.activeModTones[t].length;e++)for(;this.activeModTones[t][e].count()>0;)this.freeTone(this.activeModTones[t][e].popBack())}determineLiveInputTones(t){const e=this.liveInputTones,n=this.liveInputPitches;let i=0;if(this.liveInputDuration>0){const a=t.channels[this.liveInputChannel].instruments[t.getPatternInstrument(this.liveInputChannel,this.bar)];if(a.getChord().arpeggiates){let t;0==e.count()?(t=this.newTone(),e.pushBack(t)):!a.getTransition().isSeamless&&this.liveInputStarted?(this.releaseTone(this.liveInputChannel,e.popFront()),t=this.newTone(),e.pushBack(t)):t=e.get(0),i=1;for(let e=0;e<n.length;e++)t.pitches[e]=n[e];t.pitchCount=n.length,t.chordSize=1,t.instrument=a,t.note=t.prevNote=t.nextNote=null}else for(let t=0;t<n.length;t++){let r;e.count()<=t?(r=this.newTone(),e.pushBack(r)):!a.getTransition().isSeamless&&this.liveInputStarted?(this.releaseTone(this.liveInputChannel,e.get(t)),r=this.newTone(),e.set(t,r)):r=e.get(t),i++,r.pitches[0]=n[t],r.pitchCount=1,r.chordSize=n.length,r.instrument=a,r.note=r.prevNote=r.nextNote=null}}for(;e.count()>i;)this.releaseTone(this.liveInputChannel,e.popBack());this.liveInputStarted=!1}determineCurrentActiveTones(t,n,i){const a=t.channels[n].instruments[t.getPatternInstrument(n,this.bar)],r=t.getPattern(n,this.bar),s=this.part+this.beat*e.partsPerBeat;if(i&&t.getChannelIsMod(n)&&!t.channels[n].muted){let i=n-(t.pitchChannelCount+t.noiseChannelCount),o=[],l=[],c=[],h=e.modCount;for(;h--;)o.push(null),l.push(null),c.push(null);if(null!=r)for(let t=0;t<r.notes.length;t++)r.notes[t].end<=s?(null==l[r.notes[t].pitches[0]]||r.notes[t].end>l[r.notes[t].pitches[0]].start)&&(l[r.notes[t].pitches[0]]=r.notes[t]):r.notes[t].start<=s&&r.notes[t].end>s?o[r.notes[t].pitches[0]]=r.notes[t]:r.notes[t].start>s&&(null==c[r.notes[t].pitches[0]]||r.notes[t].start<c[r.notes[t].pitches[0]].start)&&(c[r.notes[t].pitches[0]]=r.notes[t]);for(let t=0;t<e.modCount;t++){const e=this.activeModTones[i][t];if(null!=o[t])null!=l[t]&&l[t].end!=o[t].start&&(l[t]=null),null!=c[t]&&c[t].start!=o[t].end&&(c[t]=null),this.syncTones(n,e,a,o[t].pitches,o[t],l[t],c[t],s);else for(;e.count()>0;)this.freeTone(e.popBack())}}else if(!t.getChannelIsMod(n)){let e=null,o=null,l=null;if(i&&null!=r&&!t.channels[n].muted)for(let t=0;t<r.notes.length;t++)if(r.notes[t].end<=s)o=r.notes[t];else if(r.notes[t].start<=s&&r.notes[t].end>s)e=r.notes[t];else if(r.notes[t].start>s){l=r.notes[t];break}const c=this.activeTones[n];if(null!=e)null!=o&&o.end!=e.start&&(o=null),null!=l&&l.start!=e.end&&(l=null),this.syncTones(n,c,a,e.pitches,e,o,l,s);else for(;c.count()>0;)c.peakBack().instrument.getTransition().releases&&this.tyingOver[n]<0?this.releaseTone(n,c.popBack()):this.freeTone(c.popBack())}}syncTones(t,n,i,a,r,s,o,l){let c=0;if(i.getChord().arpeggiates){let e;0==n.count()?(e=this.newTone(),n.pushBack(e)):e=n.get(0),c=1;for(let t=0;t<a.length;t++)e.pitches[t]=a[t];e.pitchCount=a.length,e.chordSize=1,e.instrument=i,e.note=r,e.noteStart=r.start-Math.max(0,this.tyingOver[t]),e.noteEnd=r.end,e.prevNote=s,e.nextNote=o,e.prevNotePitchIndex=0,e.nextNotePitchIndex=0}else{const h=i.getTransition();for(let m=0;m<a.length;m++){const a=m*i.getChord().strumParts;let d=s&&s.pitches.length>m?s:null,f=r,p=o&&o.pitches.length>m?o:null,u=f.start+a-Math.max(0,this.tyingOver[t]);if(u>l){if(!(n.count()>m&&(h.isSeamless||this.tyingOver[t]>=0)&&null!=d))break;p=f,f=d,d=null,u=f.start+a-Math.max(0,this.tyingOver[t])}let y,v=f.end;(h.isSeamless||this.tyingOver[t]>=0)&&null!=p&&(v=Math.min(e.partsPerBeat*this.song.beatsPerBar,v+a)),n.count()<=m?(y=this.newTone(),n.pushBack(y)):y=n.get(m),c++,y.pitches[0]=f.pitches[m],y.pitchCount=1,y.chordSize=f.pitches.length,y.instrument=i,y.note=f,y.noteStart=u,y.noteEnd=v,y.prevNote=d,y.nextNote=p,y.prevNotePitchIndex=m,y.nextNotePitchIndex=m}}for(;n.count()>c;)n.peakBack().instrument.getTransition().releases&&this.tyingOver[t]<0?this.releaseTone(t,n.popBack()):this.freeTone(n.popBack())}playTone(t,e,n,i,a,r,s,o,l){let c;switch(tt.computeTone(this,t,i,a,r,s,o,l),s.instrument.effects){case 0:c=this.samplesForNone;break;case 1:c=this.samplesForReverb;break;case 2:c=this.samplesForChorus;break;case 3:c=this.samplesForChorusReverb;break;default:throw new Error}tt.getInstrumentSynthFunction(s.instrument)(this,c,e,n,2*r,s,s.instrument)}static computeEnvelope(t,e,n,i){switch(t.type){case 0:return i;case 1:return 1;case 4:return 1/(1+e*t.speed);case 5:return 1-1/(1+e*t.speed);case 6:return.5-.5*Math.cos(2*n*Math.PI*t.speed);case 7:return.75-.25*Math.cos(2*n*Math.PI*t.speed);case 2:return Math.max(1,2-10*e);case 3:const a=t.speed,r=.25/Math.sqrt(a);return e<r?e/r:1/(1+(e-r)*a);case 8:return Math.pow(2,-t.speed*e);case 9:let s=.5-.5*Math.cos(n*t.speed);return s=1/(1+e*(t.speed-s/(1.5/t.speed))),s=s>0?s:0,s;case 10:return e<8/t.speed?1:0;case 11:let o=1-e/(16/t.speed);return o=o>0?o:0,o;default:throw new Error("Unrecognized operator envelope type.")}}static computeChordVolume(t){return 1/(.25*(t-1)+1)}static computeTone(t,n,i,a,r,s,o,l){const c=s.instrument,m=c.getTransition(),d=c.getChord(),f=d.arpeggiates?1:tt.computeChordVolume(s.chordSize),p=n.getChannelIsNoise(i),u=p?e.noiseInterval:1,y=e.ticksPerPart*a/t.samplesPerSecond,v=1/e.partsPerBeat,g=s.active,b=t.tickSampleCountdown,k=1-b/a,w=1-(b-r)/a,M=(t.beat*e.partsPerBeat+t.part)*e.ticksPerPart+t.tick,C=M/e.ticksPerPart,E=(M+1)/e.ticksPerPart,q=C+(E-C)*k,x=C+(E-C)*w,P=t.song.channels[i].instruments.findIndex((t=>t==c)),S=m.isSeamless||t.tyingOver[i]>=0;s.phaseDeltaScale=0,s.filter=1,s.filterScale=1,s.vibratoScale=0,s.intervalMult=1,s.intervalVolumeMult=1,s.active=!1;let F=c.pan,z=c.pan;t.isModActive(J.mstPan,!1,i,P)&&(F=t.getModValue(J.mstPan,!1,i,P,!1),z=t.getModValue(J.mstPan,!1,i,P,!0));let R=c.panDelay,A=c.panDelay;t.isModActive(J.mstPanDelay,!1,i,P)&&(R=t.getModValue(J.mstPanDelay,!1,i,P,!1),A=t.getModValue(J.mstPanDelay,!1,i,P,!0));const T=(F-e.panCenter)/e.panCenter,H=(z-e.panCenter)/e.panCenter,B=13e-5*R*t.samplesPerSecond,D=13e-5*A*t.samplesPerSecond;s.stereoDelayStart=-T*B;const N=-H*D;s.stereoDelayDelta=(N-s.stereoDelayStart)/r,s.stereoVolumeLStart=1.414*Math.cos((1+T)*Math.PI*.25),s.stereoVolumeRStart=1.414*Math.cos((1-T)*Math.PI*.25);const O=1.414*Math.cos((1+H)*Math.PI*.25),I=1.414*Math.cos((1-H)*Math.PI*.25);s.stereoVolumeLDelta=(O-s.stereoVolumeLStart)/r,s.stereoVolumeRDelta=(I-s.stereoVolumeRStart)/r;let L,W,V,U,j=!0,$=0,G=0,K=0,Q=1,Z=1,X=f,Y=f,et=0,nt=0,it=0,at=0;if(3==c.type)p?(W=e.spectrumBasePitch,V=.6):(W=e.keys[n.key].basePitch,V=.3),L=e.spectrumBasePitch,U=28;else if(4==c.type)W=e.spectrumBasePitch,V=.45,L=W,U=48;else if(2==c.type)W=e.chipNoises[c.chipNoise].basePitch,V=.19,L=W,U=e.chipNoises[c.chipNoise].isSoft?24:60;else if(1==c.type)W=e.keys[n.key].basePitch,V=.03,L=16,U=48;else if(0==c.type||7==c.type)W=e.keys[n.key].basePitch,V=.03375,L=16,U=48;else if(5==c.type)W=e.keys[n.key].basePitch,V=.025,L=16,U=48;else if(6==c.type)W=e.keys[n.key].basePitch,V=.04725,L=16,U=48;else{if(8!=c.type)throw new Error("Unknown instrument type in computeTone.");V=1,L=0,U=1,W=0}for(let t=0;t<e.operatorCount;t++)s.phaseDeltas[t]=0,s.volumeStarts[t]=0,s.volumeDeltas[t]=0;if(o){const t=s.noteLengthTicks+s.ticksSinceReleased,n=s.ticksSinceReleased+k,i=s.ticksSinceReleased+w,a=s.noteLengthTicks+n,r=s.noteLengthTicks+i,o=s.instrument.getTransition();j=!1,$=Math.floor(t/e.ticksPerPart),G=K=s.lastInterval,et=nt=tt.expressionToVolumeMult(s.lastVolume),Q=tt.expressionToVolumeMult(6*(1-n/o.releaseTicks)),Z=tt.expressionToVolumeMult(6*(1-i/o.releaseTicks)),it=a/e.ticksPerPart,at=r/e.ticksPerPart,l&&(Q*=1-k,Z*=1-w)}else if(null==s.note){Q=Z=1,et=nt=1,s.lastInterval=0,s.lastVolume=6,s.ticksSinceReleased=0,j=!1;const t=s.liveInputSamplesHeld/a;s.liveInputSamplesHeld+=r;const n=s.liveInputSamplesHeld/a;s.noteLengthTicks=n;const i=t/e.ticksPerPart,o=n/e.ticksPerPart;$=Math.floor(i),it=i,at=o}else{const a=s.note,r=s.prevNote,o=s.nextNote,l=t.part+t.beat*e.partsPerBeat,h=e.partsPerBeat*n.beatsPerBar,p=s.noteStart,u=s.noteEnd;let y;for($=l-p,y=1;y<a.pins.length-1&&!(a.pins[y].time+a.start>l);y++);const v=a.pins[y-1],b=a.pins[y],M=p*e.ticksPerPart,q=u*e.ticksPerPart-M,x=(a.start+v.time)*e.ticksPerPart,P=(a.start+b.time)*e.ticksPerPart;s.lastInterval=a.pins[a.pins.length-1].interval,s.lastVolume=a.pins[a.pins.length-1].volume,s.ticksSinceReleased=0,s.noteLengthTicks=q;const F=l*e.ticksPerPart+t.tick,z=l*e.ticksPerPart+t.tick+1,R=F-M,A=z-M,T=Math.min(1,(F-x)/(P-x)),H=Math.min(1,(z-x)/(P-x));let B=v.volume+(b.volume-v.volume)*T,D=v.volume+(b.volume-v.volume)*H,N=1,O=1,I=f,L=f,W=v.interval+(b.interval-v.interval)*T,V=v.interval+(b.interval-v.interval)*H,U=C-p,_=E-p;j=F+k-M==0||!g;const J=.5*q;if(S&&!m.slides&&0==a.start)j=!g;else if(S&&null!=r&&(j=!g,m.slides)){const t=Math.min(J,m.slideTicks),e=Math.max(0,1-R/t),n=Math.max(0,1-A/t),i=.5*(r.pitches[s.prevNotePitchIndex]+r.pins[r.pins.length-1].interval-s.pitches[0]),o=.5*(r.pins[r.pins.length-1].volume-a.pins[0].volume),l=.5*(r.end-r.start);if(W+=e*i,V+=n*i,B+=e*o,D+=n*o,U+=e*l,_+=n*l,!d.arpeggiates){const t=.5*(r.pitches.length-s.chordSize);I=tt.computeChordVolume(s.chordSize+e*t),L=tt.computeChordVolume(s.chordSize+n*t)}}if(S&&!m.slides&&a.end==h);else if(S&&null!=o){if(m.slides){const t=Math.min(J,m.slideTicks),e=Math.max(0,1-(q-R)/t),n=Math.max(0,1-(q-A)/t),i=.5*(o.pitches[s.nextNotePitchIndex]-(s.pitches[0]+a.pins[a.pins.length-1].interval)),r=.5*(o.pins[0].volume-a.pins[a.pins.length-1].volume),l=.5*-(u-p);if(W+=e*i,V+=n*i,B+=e*r,D+=n*r,U+=e*l,_+=n*l,!d.arpeggiates){const t=.5*(o.pitches.length-s.chordSize);I=tt.computeChordVolume(s.chordSize+e*t),L=tt.computeChordVolume(s.chordSize+n*t)}}}else if(!(m.releases&&t.tyingOver[i]<0)){const t=m.releaseTicks;t>0&&(N*=Math.min(1,(q-R)/t),O*=Math.min(1,(q-A)/t))}G=W+(V-W)*k,K=W+(V-W)*w,8!=c.type?(et=tt.expressionToVolumeMult(B+(D-B)*k),nt=tt.expressionToVolumeMult(B+(D-B)*w)):(et=B+(D-B)*Math.max(0,k),nt=B+(D-B)*Math.min(1,w),s.customVolumeStart=et,s.customVolumeEnd=nt),Q=N+(O-N)*k,Z=N+(O-N)*w,X=I+(L-I)*k,Y=I+(L-I)*w,it=U+(_-U)*k,at=U+(_-U)*w}const rt=1/t.samplesPerSecond;if(s.active=!0,0==c.type||1==c.type||5==c.type||6==c.type||7==c.type||3==c.type){const n=tt.getLFOAmplitude(c,y*c.LFOtime),a=tt.getLFOAmplitude(c,y*c.nextLFOtime);let r,s,o=c.vibratoDepth,l=c.vibratoDepth;t.isModActive(J.mstVibratoDepth,!1,i,P)&&(o=t.getModValue(J.mstVibratoDepth,!1,i,P,!1)/25,l=t.getModValue(J.mstVibratoDepth,!1,i,P,!0)/25);const h=t.isModActive(J.mstVibratoDelay,!1,i,P);if(c.vibrato==e.vibratos.length||h){let e=c.vibratoDelay,n=c.vibratoDelay;h&&(e=t.getModValue(J.mstVibratoDelay,!1,i,P,!1),n=t.getModValue(J.mstVibratoDelay,!1,i,P,!0),e==t.song.mstMaxVols.get(J.mstVibratoDelay)&&(e=Number.MAX_VALUE),n==t.song.mstMaxVols.get(J.mstVibratoDelay)&&(n=Number.MAX_VALUE)),r=e,s=n}else r=e.vibratos[c.vibrato].delayParts,s=e.vibratos[c.vibrato].delayParts;G+=($<r?0:o)*n,K+=($<s?0:l)*a}if(!S||(m.slides||null==s.note||0!=s.note.start)&&null==s.prevNote){const t=m.attackSeconds;t>0&&(Q*=Math.min(1,y*it/t),Z*=Math.min(1,y*at/t))}const st=tt.instrumentVolumeToVolumeMult(c.volume);4==c.type&&(s.drumsetPitch=s.pitches[0],null!=s.note&&(s.drumsetPitch+=s.note.pickMainInterval()),s.drumsetPitch=Math.max(0,Math.min(e.drumCount-1,s.drumsetPitch)));let ot,lt,ct=c.filterCutoff,ht=c.filterCutoff;t.isModActive(J.mstFilterCut,!1,i,P)&&(ct=n.modValueToReal(t.getModValue(J.mstFilterCut,!1,i,P,!1),J.mstFilterCut),ht=n.modValueToReal(t.getModValue(J.mstFilterCut,!1,i,P,!0),J.mstFilterCut)),4==c.type?(ot=0,lt=0):(ot=.5*(ct-(e.filterCutoffRange-1)),lt=.5*(ht-(e.filterCutoffRange-1)));const mt=4==c.type?c.getDrumsetEnvelope(s.drumsetPitch):c.getFilterEnvelope(),dt=e.filterCutoffMaxHz*Math.pow(2,ot),ft=e.filterCutoffMaxHz*Math.pow(2,lt),pt=2*Math.sin(Math.PI*dt/t.samplesPerSecond),ut=2*Math.sin(Math.PI*ft/t.samplesPerSecond),yt=2*Math.sin(Math.PI*e.filterCutoffMinHz/t.samplesPerSecond);s.filter=pt*tt.computeEnvelope(mt,y*it,v*q,et);let vt=ut*tt.computeEnvelope(mt,y*at,v*x,nt);s.filter=Math.min(e.filterMax,Math.max(yt,s.filter)),vt=Math.min(e.filterMax,Math.max(yt,vt)),s.filterScale=Math.pow(vt/s.filter,1/r);let gt=Math.pow(.5,.35*ot),bt=Math.pow(.5,.35*lt);s.filterResonanceStart=c.getFilterResonance(),s.filterResonanceDelta=0;let kt=c.filterResonance,wt=c.filterResonance;if(s.isFirstOrder=4!=c.type&&0==kt,t.isModActive(J.mstFilterPeak,!1,i,P)){s.isFirstOrder=!1,kt=n.modValueToReal(t.getModValue(J.mstFilterPeak,!1,i,P,!1),J.mstFilterPeak),wt=n.modValueToReal(t.getModValue(J.mstFilterPeak,!1,i,P,!0),J.mstFilterPeak),s.filterResonanceStart=e.filterMaxResonance*Math.pow(Math.max(0,kt-1)/(e.filterResonanceRange-2),.5);const a=e.filterMaxResonance*Math.pow(Math.max(0,wt-1)/(e.filterResonanceRange-2),.5);s.filterResonanceDelta=(a-s.filterResonanceStart)/r}else s.filterResonanceStart=e.filterMaxResonance*Math.pow(Math.max(0,kt-1)/(e.filterResonanceRange-2),.5);if(0==s.isFirstOrder&&(gt=Math.pow(gt,1.7)*Math.pow(.5,.125*(kt-1)),bt=Math.pow(bt,1.7)*Math.pow(.5,.125*(wt-1))),8==mt.type?(gt*=1.25+.025*mt.speed,bt*=1.25+.025*mt.speed):4==mt.type&&(gt*=1+.02*mt.speed,bt*=1+.02*mt.speed),j&&s.reset(),1==c.type){let n=1,a=1,o=0,l=0,m=0;if(s.pitchCount>1&&!d.harmonizes){const t=Math.floor(c.arpTime/e.ticksPerArpeggio);m=s.pitches[h(s.pitchCount,c.fastTwoNoteArp,t)]-s.pitches[0]}let f=c.detune/25,p=c.detune/25;t.isModActive(J.mstDetune,!1,i,P)&&(f=t.getModValue(J.mstDetune,!1,i,P,!1)/25,p=t.getModValue(J.mstDetune,!1,i,P,!0)/25),t.isModActive(J.mstSongDetune,!0)&&(f+=t.getModValue(J.mstSongDetune,!0,null,null,!1)/25,p+=t.getModValue(J.mstSongDetune,!0,null,null,!0)/25);const g=e.algorithms[c.algorithm].carrierCount;for(let h=0;h<e.operatorCount;h++){const b=e.algorithms[c.algorithm].associatedCarrier[h]-1,k=s.pitches[d.harmonizes?h<s.pitchCount?h:b<s.pitchCount?b:0:0],w=e.operatorFrequencies[c.operators[h].frequency].mult,M=e.operatorCarrierInterval[b]+m,C=W+(k+G+f)*u+M,E=w*_.frequencyFromPitch(C)+e.operatorFrequencies[c.operators[h].frequency].hzOffset;s.phaseDeltas[h]=E*rt*e.sineWaveLength;let S=c.operators[h].amplitude,F=c.operators[h].amplitude;t.isModActive(J.mstFMSlider1+h,!1,i,P)&&(S*=t.getModValue(J.mstFMSlider1+h,!1,i,P,!1)/15,F*=t.getModValue(J.mstFMSlider1+h,!1,i,P,!0)/15);const z=tt.operatorAmplitudeCurve(S),R=tt.operatorAmplitudeCurve(F);let A=z*e.operatorFrequencies[c.operators[h].frequency].amplitudeSign,T=R*e.operatorFrequencies[c.operators[h].frequency].amplitudeSign;if(t.isModActive(J.mstInsVolume,!1,i,P)){const n=t.getModValue(J.mstInsVolume,!1,i,P,!1),a=t.getModValue(J.mstInsVolume,!1,i,P,!0);A*=n<=0?(n+e.volumeRange/2)/(e.volumeRange/2):this.instrumentVolumeToVolumeMult(n),T*=a<=0?(a+e.volumeRange/2)/(e.volumeRange/2):this.instrumentVolumeToVolumeMult(a)}if(t.isModActive(J.mstSongVolume,!0)&&(A*=t.getModValue(J.mstSongVolume,!0,void 0,void 0,!1)/100,T*=t.getModValue(J.mstSongVolume,!0,void 0,void 0,!0)/100),h<g){const t=W+(k+K+p)*u+M,e=Math.pow(2,-(C-L)/U),n=Math.pow(2,-(t-L)/U);A*=e,T*=n,o+=z,l+=R}else A*=1.5*e.sineWaveLength,T*=1.5*e.sineWaveLength,n*=1-Math.min(1,S/15),a*=1-Math.min(1,F/15);const H=e.envelopes[c.operators[h].envelope];A*=tt.computeEnvelope(H,y*it,v*q,et),T*=tt.computeEnvelope(H,y*at,v*x,nt),s.volumeStarts[h]=A,s.volumeDeltas[h]=(T-A)/r}let b=c.feedbackAmplitude,k=c.feedbackAmplitude;t.isModActive(J.mstFMFeedback,!1,i,P)&&(b*=t.getModValue(J.mstFMFeedback,!1,i,P,!1)/15,k*=t.getModValue(J.mstFMFeedback,!1,i,P,!0)/15);const w=.3*e.sineWaveLength*b/15,M=.3*e.sineWaveLength*k/15,C=e.envelopes[c.feedbackEnvelope];let E=w*tt.computeEnvelope(C,y*it,v*q,et),S=M*tt.computeEnvelope(C,y*at,v*x,nt);s.feedbackMult=E,s.feedbackDelta=(S-s.feedbackMult)/r;const F=V*st;s.volumeStart=gt*F*Q*X;const z=bt*F*Z*Y;s.volumeDelta=(z-s.volumeStart)/r,n*=(Math.pow(2,2-1.4*b/15)-1)/3,a*=(Math.pow(2,2-1.4*k/15)-1)/3,n*=1-Math.min(1,Math.max(0,o-1)/2),a*=1-Math.min(1,Math.max(0,l-1)/2),s.volumeStart*=1+3*n,s.volumeDelta*=1+1.5*(n+a)}else if(8==c.type){s.volumeStart=Q;let t=Z;s.volumeStart*=et,t*=nt,s.volumeDelta=(t-s.volumeStart)/r}else{let n=c.detune/25,a=c.detune/25;t.isModActive(J.mstDetune,!1,i,P)&&(n=t.getModValue(J.mstDetune,!1,i,P,!1)/25,a=t.getModValue(J.mstDetune,!1,i,P,!0)/25),t.isModActive(J.mstSongDetune,!0)&&(n+=t.getModValue(J.mstSongDetune,!0,null,null,!1)/25,a+=t.getModValue(J.mstSongDetune,!0,null,null,!0)/25);let o=s.pitches[0];if(s.pitchCount>1){const t=Math.floor(c.arpTime/e.ticksPerArpeggio);if(d.harmonizes){const e=s.pitches[1+h(s.pitchCount-1,c.fastTwoNoteArp,t)]-s.pitches[0];s.intervalMult=Math.pow(2,e/12),s.intervalVolumeMult=Math.pow(2,-e/U)}else o=s.pitches[h(s.pitchCount,c.fastTwoNoteArp,t)]}const l=W+(o+G+n)*u,m=W+(o+K+a)*u,f=_.frequencyFromPitch(l),p=Math.pow(2,-(l-L)/U),g=Math.pow(2,-(m-L)/U);let b=V*gt,k=V*bt;if(2==c.type&&(b*=e.chipNoises[c.chipNoise].volume,k*=e.chipNoises[c.chipNoise].volume),0!=c.type&&7!=c.type||(b*=e.chipWaves[c.chipWave].volume,k*=e.chipWaves[c.chipWave].volume),0!=c.type&&5!=c.type&&7!=c.type||(b*=e.intervals[c.interval].volume,k*=e.intervals[c.interval].volume),6==c.type){let n=c.pulseWidth/(2*e.pulseWidthRange),a=c.pulseWidth/(2*e.pulseWidthRange);t.isModActive(J.mstPulseWidth,!1,i,P)&&(n=t.getModValue(J.mstPulseWidth,!1,i,P,!1)/(2*e.pulseWidthRange),a=t.getModValue(J.mstPulseWidth,!1,i,P,!0)/(2*e.pulseWidthRange));const o=e.envelopes[c.pulseEnvelope],l=n*tt.computeEnvelope(o,y*it,v*q,et),h=a*tt.computeEnvelope(o,y*at,v*x,nt);s.pulseWidth=l,s.pulseWidthDelta=(h-l)/r}s.phaseDeltas[0]=f*rt,s.volumeStart=Q*X*p*b*st;let w=Z*Y*g*k*st;if(0==mt.type||6==c.type&&0==e.envelopes[c.pulseEnvelope].type||(s.volumeStart*=et,w*=nt),t.isModActive(J.mstInsVolume,!1,i,P)){const n=t.getModValue(J.mstInsVolume,!1,i,P,!1),a=t.getModValue(J.mstInsVolume,!1,i,P,!0);s.volumeStart*=n<=0?(n+e.volumeRange/2)/(e.volumeRange/2):this.instrumentVolumeToVolumeMult(n),w*=a<=0?(a+e.volumeRange/2)/(e.volumeRange/2):this.instrumentVolumeToVolumeMult(a)}t.isModActive(J.mstSongVolume,!0)&&(s.volumeStart*=t.getModValue(J.mstSongVolume,!0,void 0,void 0,!1)/100,w*=t.getModValue(J.mstSongVolume,!0,void 0,void 0,!0)/100),s.volumeDelta=(w-s.volumeStart)/r}s.phaseDeltaScale=Math.pow(2,(K-G)*u/12/r)}static getLFOAmplitude(t,n){let i=0;for(const a of e.vibratoTypes[t.vibratoType].periodsSeconds)i+=Math.sin(2*Math.PI*n/a);return i}static getInstrumentSynthFunction(t){if(1==t.type){const n=t.algorithm+"_"+t.feedbackType;if(null==tt.fmSynthFunctionCache[n]){const i=[];for(const n of tt.fmSourceTemplate)if(-1!=n.indexOf("// CARRIER OUTPUTS")){const a=[];for(let n=0;n<e.algorithms[t.algorithm].carrierCount;n++)a.push("operator"+n+"Scaled");i.push(n.replace("/*operator#Scaled*/",a.join(" + ")))}else if(-1!=n.indexOf("// INSERT OPERATOR COMPUTATION HERE"))for(let n=e.operatorCount-1;n>=0;n--)for(const a of tt.operatorSourceTemplate)if(-1!=a.indexOf("/* + operator@Scaled*/")){let r="";for(const i of e.algorithms[t.algorithm].modulatedBy[n])r+=" + operator"+(i-1)+"Scaled";const s=e.feedbacks[t.feedbackType].indices[n];if(s.length>0){r+=" + feedbackMult * (";const t=[];for(const e of s)t.push("operator"+(e-1)+"Output");r+=t.join(" + ")+")"}i.push(a.replace(/\#/g,n+"").replace("/* + operator@Scaled*/",r))}else i.push(a.replace(/\#/g,n+""));else if(-1!=n.indexOf("#"))for(let t=0;t<e.operatorCount;t++)i.push(n.replace(/\#/g,t+""));else i.push(n);tt.fmSynthFunctionCache[n]=new Function("synth","data","stereoBufferIndex","stereoBufferLength","runLength","tone","instrument",i.join("\n"))}return tt.fmSynthFunctionCache[n]}if(0==t.type)return tt.chipSynth;if(7==t.type)return tt.chipSynth;if(5==t.type)return tt.harmonicsSynth;if(6==t.type)return tt.pulseWidthSynth;if(2==t.type)return tt.noiseSynth;if(3==t.type)return tt.spectrumSynth;if(4==t.type)return tt.drumsetSynth;if(8==t.type)return tt.modSynth;throw new Error("Unrecognized instrument type: "+t.type)}static chipSynth(t,n,i,a,r,s,o){var l,c;7==o.type?(l=o.customChipWaveIntegral,c=.1):(l=e.chipWaves[o.chipWave].samples,c=1);const h=+l.length-1,m=+Math.pow(2,(e.intervals[o.interval].offset+e.intervals[o.interval].spread)/12),d=Math.pow(2,(e.intervals[o.interval].offset-e.intervals[o.interval].spread)/12)*s.intervalMult,f=s.intervalVolumeMult*e.intervals[o.interval].sign;0!=o.interval||o.getChord().customInterval||(s.phases[1]=s.phases[0]);const p=d/m;let u=s.phaseDeltas[0]*m*h,y=u*p;const v=+s.phaseDeltaScale;let g=+s.volumeStart;const b=+s.volumeDelta;let k=s.phases[0]%1*h,w=s.phases[1]%1*h;const M=s.isFirstOrder;let C=+s.filter,E=M?1:C;const q=+s.filterScale,x=M?1:q;let P=s.filterResonanceStart,S=s.filterResonanceDelta,F=+s.filterSample0,z=+s.filterSample1;const R=0|k,A=0|w,T=R%h,H=A%h,B=k-R,D=w-A;let N=l[T],O=l[H];N+=(l[T+1]-N)*B,O+=(l[H+1]-O)*D;const I=i+r;i+=s.stereoOffset;let L,W=s.stereoVolumeLStart,V=s.stereoVolumeLDelta,U=s.stereoVolumeRStart,j=s.stereoVolumeRDelta,$=s.stereoDelayStart,G=s.stereoDelayDelta;for(;i<I;){k+=u,w+=y;const t=0|k,e=0|w,r=t%h,s=e%h;let o=l[r],m=l[s];const d=k-t,p=w-e;o+=(l[r+1]-o)*d,m+=(l[s+1]-m)*p;let M=(o-N)/u,R=(m-O)/y;N=o,O=m;F+=C*(M+R*f-F+(P+P/(1-C))*(F-z)),z+=E*(F-z),C*=q,E*=x,u*=v,y*=v,P+=S;const A=z*g*c;g+=b,L=$<0?[0,0,2*(0|-$),-$%1]:[2*(0|$),$%1,0,0],n[(i+L[0])%a]+=A*W*(1-L[1]),n[(i+L[0]+2)%a]+=A*W*L[1],n[(i+L[2]+1)%a]+=A*U*(1-L[3]),n[(i+L[2]+3)%a]+=A*U*L[3],W+=V,U+=j,$+=G,i+=2}s.phases[0]=k/h,s.phases[1]=w/h;const K=1e-24;-1e-24<F&&F<K&&(F=0),-1e-24<z&&z<K&&(z=0),s.filterSample0=F,s.filterSample1=z}static harmonicsSynth(t,n,i,a,r,s,o){const l=o.harmonicsWave.getCustomWave(),c=+l.length-1,h=+Math.pow(2,(e.intervals[o.interval].offset+e.intervals[o.interval].spread)/12),m=Math.pow(2,(e.intervals[o.interval].offset-e.intervals[o.interval].spread)/12)*s.intervalMult,d=s.intervalVolumeMult*e.intervals[o.interval].sign;0!=o.interval||o.getChord().customInterval||(s.phases[1]=s.phases[0]);const f=m/h;let p=s.phaseDeltas[0]*h*c,u=p*f;const y=+s.phaseDeltaScale;let v=+s.volumeStart;const g=+s.volumeDelta;let b=s.phases[0]%1*c,k=s.phases[1]%1*c;const w=s.isFirstOrder;let M=+s.filter,C=w?1:M;const E=+s.filterScale,q=w?1:E;let x=s.filterResonanceStart,P=s.filterResonanceDelta,S=+s.filterSample0,F=+s.filterSample1;const z=0|b,R=0|k,A=z%c,T=R%c,H=b-z,B=k-R;let D=l[A],N=l[T];D+=(l[A+1]-D)*H,N+=(l[T+1]-N)*B;const O=i+r;i+=s.stereoOffset;let I,L=s.stereoVolumeLStart,W=s.stereoVolumeLDelta,V=s.stereoVolumeRStart,U=s.stereoVolumeRDelta,j=s.stereoDelayStart,$=s.stereoDelayDelta;for(;i<O;){b+=p,k+=u;const t=0|b,e=0|k,r=t%c,s=e%c;let o=l[r],h=l[s];const m=b-t,f=k-e;o+=(l[r+1]-o)*m,h+=(l[s+1]-h)*f;let w=(o-D)/p,z=(h-N)/u;D=o,N=h;S+=M*(w+z*d-S+(x+x/(1-M))*(S-F)),F+=C*(S-F),M*=E,C*=q,p*=y,u*=y,x+=P;const R=F*v;v+=g,I=j<0?[0,0,2*(0|-j),-j%1]:[2*(0|j),j%1,0,0],n[(i+I[0])%a]+=R*L*(1-I[1]),n[(i+I[0]+2)%a]+=R*L*I[1],n[(i+I[2]+1)%a]+=R*V*(1-I[3]),n[(i+I[2]+3)%a]+=R*V*I[3],L+=W,V+=U,j+=$,i+=2}s.phases[0]=b/c,s.phases[1]=k/c;const G=1e-24;-1e-24<S&&S<G&&(S=0),-1e-24<F&&F<G&&(F=0),s.filterSample0=S,s.filterSample1=F}static pulseWidthSynth(t,e,n,i,a,r,s){let o=r.phaseDeltas[0];const l=+r.phaseDeltaScale;let c=+r.volumeStart;const h=+r.volumeDelta;let m=r.phases[0]%1,d=r.pulseWidth;const f=r.pulseWidthDelta,p=r.isFirstOrder;let u=+r.filter,y=p?1:u;const v=+r.filterScale,g=p?1:v;let b=r.filterResonanceStart,k=r.filterResonanceDelta,w=+r.filterSample0,M=+r.filterSample1;const C=n+a;n+=r.stereoOffset;let E,q=r.stereoVolumeLStart,x=r.stereoVolumeLDelta,P=r.stereoVolumeRStart,S=r.stereoVolumeRDelta,F=r.stereoDelayStart,z=r.stereoDelayDelta;for(;n<C;){const t=m%1,a=(m+d)%1;let r=a-t;if(t<o)r+=.5*((R=t/o)+R-R*R-1);else if(t>1-o){r+=.5*((R=(t-1)/o)+R+R*R+1)}if(a<o)r-=.5*((R=a/o)+R-R*R-1);else if(a>1-o){var R;r-=.5*((R=(a-1)/o)+R+R*R+1)}w+=u*(r-w+(b+b/(1-u))*(w-M)),M+=y*(w-M),u*=v,y*=g,m+=o,o*=l,d+=f,b+=k;const s=M*c;c+=h,E=F<0?[0,0,2*(0|-F),-F%1]:[2*(0|F),F%1,0,0],e[(n+E[0])%i]+=s*q*(1-E[1]),e[(n+E[0]+2)%i]+=s*q*E[1],e[(n+E[2]+1)%i]+=s*P*(1-E[3]),e[(n+E[2]+3)%i]+=s*P*E[3],q+=x,P+=S,F+=z,n+=2}r.phases[0]=m;const A=1e-24;-1e-24<w&&w<A&&(w=0),-1e-24<M&&M<A&&(M=0),r.filterSample0=w,r.filterSample1=M}static noiseSynth(t,n,i,a,r,s,o){let l=o.getDrumWave(),c=+s.phaseDeltas[0];const h=+s.phaseDeltaScale;let m=+s.volumeStart;const d=+s.volumeDelta;let f=s.phases[0]%1*e.chipNoiseLength;0==s.phases[0]&&(f=Math.random()*e.chipNoiseLength);let p=+s.sample;const u=s.isFirstOrder;let y=+s.filter,v=u?1:y;const g=+s.filterScale,b=u?1:g;let k=s.filterResonanceStart,w=s.filterResonanceDelta,M=+s.filterSample0,C=+s.filterSample1;const E=Math.min(1,s.phaseDeltas[0]*e.chipNoises[o.chipNoise].pitchFilterMult),q=i+r;i+=s.stereoOffset;let x,P=s.stereoVolumeLStart,S=s.stereoVolumeLDelta,F=s.stereoVolumeRStart,z=s.stereoVolumeRDelta,R=s.stereoDelayStart,A=s.stereoDelayDelta;for(;i<q;){p+=(l[32767&f]-p)*E;M+=y*(p-M+(k+k/(1-y))*(M-C)),C+=v*(M-C),f+=c,y*=g,v*=b,c*=h,k+=w;const t=C*m;m+=d,x=R<0?[0,0,2*(0|-R),-R%1]:[2*(0|R),R%1,0,0],n[(i+x[0])%a]+=t*P*(1-x[1]),n[(i+x[0]+2)%a]+=t*P*x[1],n[(i+x[2]+1)%a]+=t*F*(1-x[3]),n[(i+x[2]+3)%a]+=t*F*x[3],P+=S,F+=z,R+=A,i+=2}s.phases[0]=f/e.chipNoiseLength,s.sample=p;const T=1e-24;-1e-24<M&&M<T&&(M=0),-1e-24<C&&C<T&&(C=0),s.filterSample0=M,s.filterSample1=C}static spectrumSynth(t,n,i,a,r,s,o){let l=o.getDrumWave(),c=128*s.phaseDeltas[0];const h=+s.phaseDeltaScale;let m=+s.volumeStart;const d=+s.volumeDelta;let f=+s.sample;const p=s.isFirstOrder;let u=+s.filter,y=p?1:u;const v=+s.filterScale,g=p?1:v;let b=s.filterResonanceStart,k=s.filterResonanceDelta,w=+s.filterSample0,M=+s.filterSample1,C=s.phases[0]%1*e.chipNoiseLength;0==s.phases[0]&&(C=tt.findRandomZeroCrossing(l)+c);const E=Math.min(1,c),q=i+r;i+=s.stereoOffset;let x,P=s.stereoVolumeLStart,S=s.stereoVolumeLDelta,F=s.stereoVolumeRStart,z=s.stereoVolumeRDelta,R=s.stereoDelayStart,A=s.stereoDelayDelta;for(;i<q;){const t=0|C,e=32767&t;let r=l[e];const s=C-t;r+=(l[e+1]-r)*s,f+=(r-f)*E;w+=u*(f-w+(b+b/(1-u))*(w-M)),M+=y*(w-M),C+=c,u*=v,y*=g,c*=h,b+=k;const o=M*m;m+=d,x=R<0?[0,0,2*(0|-R),-R%1]:[2*(0|R),R%1,0,0],n[(i+x[0])%a]+=o*P*(1-x[1]),n[(i+x[0]+2)%a]+=o*P*x[1],n[(i+x[2]+1)%a]+=o*F*(1-x[3]),n[(i+x[2]+3)%a]+=o*F*x[3],P+=S,F+=z,R+=A,i+=2}s.phases[0]=C/e.chipNoiseLength,s.sample=f;const T=1e-24;-1e-24<w&&w<T&&(w=0),-1e-24<M&&M<T&&(M=0),s.filterSample0=w,s.filterSample1=M}static drumsetSynth(t,n,i,a,r,s,o){let l=o.getDrumsetWave(s.drumsetPitch),c=s.phaseDeltas[0]/_.drumsetIndexReferenceDelta(s.drumsetPitch);const h=+s.phaseDeltaScale;let m=+s.volumeStart;const d=+s.volumeDelta;let f=+s.sample;const p=s.isFirstOrder;let u=+s.filter,y=p?1:u;const v=+s.filterScale,g=p?1:v;let b=s.filterResonanceStart,k=s.filterResonanceDelta,w=+s.filterSample0,M=+s.filterSample1,C=s.phases[0]%1*e.chipNoiseLength;0==s.phases[0]&&(C=tt.findRandomZeroCrossing(l)+c);const E=i+r;i+=s.stereoOffset;let q,x=s.stereoVolumeLStart,P=s.stereoVolumeLDelta,S=s.stereoVolumeRStart,F=s.stereoVolumeRDelta,z=s.stereoDelayStart,R=s.stereoDelayDelta;for(;i<E;){const t=0|C,e=32767&t;f=l[e];const r=C-t;f+=(l[e+1]-f)*r;w+=u*(f-w+(b+b/(1-u))*(w-M)),M+=y*(w-M),C+=c,u*=v,y*=g,c*=h,b+=k;const s=M*m;m+=d,q=z<0?[0,0,2*(0|-z),-z%1]:[2*(0|z),z%1,0,0],n[(i+q[0])%a]+=s*x*(1-q[1]),n[(i+q[0]+2)%a]+=s*x*q[1],n[(i+q[2]+1)%a]+=s*S*(1-q[3]),n[(i+q[2]+3)%a]+=s*S*q[3],x+=P,S+=F,z+=R,i+=2}s.phases[0]=C/e.chipNoiseLength,s.sample=f;const A=1e-24;-1e-24<w&&w<A&&(w=0),-1e-24<M&&M<A&&(M=0),s.filterSample0=w,s.filterSample1=M}static modSynth(t,n,i,a,r,s,o){if(!t.song)return;let l=e.modCount-1-s.pitches[0],c=o.modSettings[l];t.setModValue(s.customVolumeStart,s.customVolumeEnd,l,o,c),c==J.mstResetArpeggio&&0==t.tick&&s.noteStart==t.beat*e.partsPerBeat+t.part?t.song.channels[o.modChannels[l]].instruments[o.modInstruments[l]].arpTime=0:c==J.mstNextBar&&(t.wantToSkip=!0)}static findRandomZeroCrossing(t){let n=Math.random()*e.chipNoiseLength,i=32767&n,a=t[i];for(let r=128;r>0;r--){const r=i+16&32767,s=t[r];if(a*s<=0){for(let r=0;r<16;r++){const r=i+1&32767,s=t[r];if(a*s<=0){const t=s-a;n=i,Math.abs(t)>1e-8&&(n+=-a/t),n=Math.max(0,n)%e.chipNoiseLength;break}i=r,a=s}break}i=r,a=s}return n}static instrumentVolumeToVolumeMult(t){return t==-e.volumeRange/2?0:Math.pow(2,e.volumeLogScale*t)}static volumeMultToInstrumentVolume(t){return t<=0?-e.volumeRange/2:Math.min(e.volumeRange,Math.log(t)/Math.LN2/e.volumeLogScale)}static expressionToVolumeMult(t){return Math.pow(Math.max(0,t)/6,1.5)}static volumeMultToExpression(t){return 6*Math.pow(Math.max(0,t),1/1.5)}getSamplesPerTick(){if(null==this.song)return 0;let t=this.song.getBeatsPerMinute();return this.isModActive(J.mstTempo,!0)&&(t=this.getModValue(J.mstTempo,!0)),this.getSamplesPerTickSpecificBPM(t)}getSamplesPerTickSpecificBPM(t){const n=t/60,i=e.partsPerBeat*n,a=e.ticksPerPart*i;return this.samplesPerSecond/a}}tt.fmSynthFunctionCache={},tt.fmSourceTemplate=("\nlet phaseDeltaScale = +tone.phaseDeltaScale;\n// I'm adding 1000 to the phase to ensure that it's never negative even when modulated by other waves because negative numbers don't work with the modulus operator very well.\nlet operator#Phase       = +((tone.phases[#] % 1) + 1000) * beepbox.Config.sineWaveLength;\nlet operator#PhaseDelta  = +tone.phaseDeltas[#];\nlet operator#OutputMult  = +tone.volumeStarts[#];\nconst operator#OutputDelta = +tone.volumeDeltas[#];\nlet operator#Output      = +tone.feedbackOutputs[#];\nlet feedbackMult         = +tone.feedbackMult;\nconst feedbackDelta        = +tone.feedbackDelta;\nlet volume = +tone.volumeStart;\nconst volumeDelta = +tone.volumeDelta;\n\nconst isFirstOrder = tone.isFirstOrder;\nlet filter1 = +tone.filter;\nlet filter2 = isFirstOrder ? 1.0 : filter1;\nconst filterScale1 = +tone.filterScale;\nconst filterScale2 = isFirstOrder ? 1.0 : filterScale1;\nlet filterResonance = tone.filterResonanceStart;\nlet filterResonanceDelta = tone.filterResonanceDelta;\nlet filterSample0 = +tone.filterSample0;\nlet filterSample1 = +tone.filterSample1;\n\nconst stopIndex = stereoBufferIndex + runLength;\nstereoBufferIndex += tone.stereoOffset;\nlet stereoVolumeL = tone.stereoVolumeLStart;\nlet stereoVolumeLDelta = tone.stereoVolumeLDelta;\nlet stereoVolumeR = tone.stereoVolumeRStart;\nlet stereoVolumeRDelta = tone.stereoVolumeRDelta;\nlet stereoDelay = tone.stereoDelayStart;\nlet stereoDelayDelta = tone.stereoDelayDelta;\nlet delays = [];\nwhile (stereoBufferIndex < stopIndex) {\n// INSERT OPERATOR COMPUTATION HERE\nconst fmOutput = (/*operator#Scaled*/); // CARRIER OUTPUTS\n\nconst feedback = filterResonance + filterResonance / (1.0 - filter1);\nfilterSample0 += filter1 * (fmOutput - filterSample0 + feedback * (filterSample0 - filterSample1));\nfilterSample1 += filter2 * (filterSample0 - filterSample1);\n\nfeedbackMult += feedbackDelta;\noperator#OutputMult += operator#OutputDelta;\noperator#Phase += operator#PhaseDelta;\noperator#PhaseDelta *= phaseDeltaScale;\nfilter1 *= filterScale1;\nfilter2 *= filterScale2;\nfilterResonance += filterResonanceDelta;\n\nconst output = filterSample1 * volume;\nvolume += volumeDelta;\n\n//const absStereoDelay: number = Math.abs(stereoDelay);\n//const fracStereoDelay: number = absStereoDelay % 1;\n//const floorStereoDelay: number = absStereoDelay | 0;\n\n//delays = stereoDelay < 0 ? [0, 0, floorStereoDelay * 2, fracStereoDelay] : [floorStereoDelay * 2, fracStereoDelay, 0, 0];\n\n// Optimized ver: can remove the above three declarations, but muddier conceptually. Still has that conditional, too...\ndelays = stereoDelay < 0 ? [0, 0, ((-stereoDelay) | 0) * 2, (-stereoDelay) % 1] : [(stereoDelay | 0) * 2, stereoDelay % 1, 0, 0];\n\ndata[(stereoBufferIndex + delays[0]) % stereoBufferLength] += output * stereoVolumeL * (1 - delays[1]);\ndata[(stereoBufferIndex + delays[0] + 2) % stereoBufferLength] += output * stereoVolumeL * delays[1];\ndata[(stereoBufferIndex + delays[2] + 1) % stereoBufferLength] += output * stereoVolumeR * (1 - delays[3]);\ndata[(stereoBufferIndex + delays[2] + 3) % stereoBufferLength] += output * stereoVolumeR * delays[3];\n\nstereoVolumeL += stereoVolumeLDelta;\nstereoVolumeR += stereoVolumeRDelta;\nstereoDelay += stereoDelayDelta;\n\nstereoBufferIndex += 2;\n}\n\ntone.phases[#] = operator#Phase / "+e.sineWaveLength+";\ntone.feedbackOutputs[#] = operator#Output;\n\nconst epsilon = (1.0e-24);\nif (-epsilon < filterSample0 && filterSample0 < epsilon) filterSample0 = 0.0;\nif (-epsilon < filterSample1 && filterSample1 < epsilon) filterSample1 = 0.0;\ntone.filterSample0 = filterSample0;\ntone.filterSample1 = filterSample1;\n").split("\n"),tt.operatorSourceTemplate=("\nvar operator#Wave     = beepbox.Config.operatorWaves[instrument.operators[#].waveform].samples;\nconst operator#PhaseMix = operator#Phase/* + operator@Scaled*/;\nconst operator#PhaseInt = operator#PhaseMix|0;\nconst operator#Index    = operator#PhaseInt & "+e.sineWaveMask+";\nconst operator#Sample   = operator#Wave[operator#Index];\noperator#Output       = operator#Sample + (operator#Wave[operator#Index + 1] - operator#Sample) * (operator#PhaseMix - operator#PhaseInt);\nconst operator#Scaled   = operator#OutputMult * operator#Output;\n").split("\n");const{a:et,button:nt,div:it,h1:at,input:rt}=M,{svg:st,circle:ot,rect:lt,path:ct}=C;document.head.appendChild(M.style({type:"text/css"},`\n\t\tbody {\n\t\t\tcolor: ${z.primaryText};\n\t\t\tbackground: ${z.editorBackground};\n\t\t}\n\t\th1 {\n\t\t\tfont-weight: bold;\n\t\t\tfont-size: 14px;\n\t\t\tline-height: 22px;\n\t\t\ttext-align: initial;\n\t\t\tmargin: 0;\n\t\t}\n\t\ta {\n\t\t\tfont-weight: bold;\n\t\t\tfont-size: 12px;\n\t\t\tline-height: 22px;\n\t\t\twhite-space: nowrap;\n\t\t\tcolor: ${z.linkAccent};\n\t\t}\n\t\tbutton {\n\t\t\tmargin: 0;\n\t\t\tpadding: 0;\n\t\t\tposition: relative;\n\t\t\tborder: none;\n\t\t\tborder-radius: 5px;\n\t\t\tbackground: ${z.uiWidgetBackground};\n\t\t\tcolor: ${z.primaryText};\n\t\t\tcursor: pointer;\n\t\t\tfont-size: 14px;\n\t\t\tfont-family: inherit;\n\t\t}\n\t\tbutton:hover, button:focus {\n\t\t\tbackground: ${z.uiWidgetFocus};\n\t\t}\n\t\t.playButton, .pauseButton {\n\t\t\tpadding-left: 24px;\n\t\t\tpadding-right: 6px;\n\t\t}\n\t\t.playButton::before {\n\t\t\tcontent: "";\n\t\t\tposition: absolute;\n\t\t\tleft: 6px;\n\t\t\ttop: 50%;\n\t\t\tmargin-top: -6px;\n\t\t\twidth: 12px;\n\t\t\theight: 12px;\n\t\t\tpointer-events: none;\n\t\t\tbackground: ${z.primaryText};\n\t\t\t-webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="-6 -6 12 12"><path d="M 6 0 L -5 6 L -5 -6 z" fill="gray"/></svg>');\n\t\t\t-webkit-mask-repeat: no-repeat;\n\t\t\t-webkit-mask-position: center;\n\t\t\tmask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="-6 -6 12 12"><path d="M 6 0 L -5 6 L -5 -6 z" fill="gray"/></svg>');\n\t\t\tmask-repeat: no-repeat;\n\t\t\tmask-position: center;\n\t\t}\n\t\t.pauseButton::before {\n\t\t\tcontent: "";\n\t\t\tposition: absolute;\n\t\t\tleft: 6px;\n\t\t\ttop: 50%;\n\t\t\tmargin-top: -6px;\n\t\t\twidth: 12px;\n\t\t\theight: 12px;\n\t\t\tpointer-events: none;\n\t\t\tbackground: ${z.primaryText};\n\t\t\t-webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="-6 -6 12 12"><rect x="-5" y="-6" width="3" height="12" fill="gray"/><rect x="2"  y="-6" width="3" height="12" fill="gray"/></svg>');\n\t\t\t-webkit-mask-repeat: no-repeat;\n\t\t\t-webkit-mask-position: center;\n\t\t\tmask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="-6 -6 12 12"><rect x="-5" y="-6" width="3" height="12" fill="gray"/><rect x="2"  y="-6" width="3" height="12" fill="gray"/></svg>');\n\t\t\tmask-repeat: no-repeat;\n\t\t\tmask-position: center;\n\t\t}\n\t\t\n\t\tinput[type=range] {\n\t\t\t-webkit-appearance: none;\n\t\t\tappearance: none;\n\t\t\theight: 16px;\n\t\t\tmargin: 0;\n\t\t\tcursor: pointer;\n\t\t\tbackground-color: ${z.editorBackground};\n\t\t\ttouch-action: pan-y;\n\t\t}\n\t\tinput[type=range]:focus {\n\t\t\toutline: none;\n\t\t}\n\t\tinput[type=range]::-webkit-slider-runnable-track {\n\t\t\twidth: 100%;\n\t\t\theight: 4px;\n\t\t\tcursor: pointer;\n\t\t\tbackground: ${z.uiWidgetBackground};\n\t\t}\n\t\tinput[type=range]::-webkit-slider-thumb {\n\t\t\theight: 16px;\n\t\t\twidth: 4px;\n\t\t\tborder-radius: 2px;\n\t\t\tbackground: ${z.primaryText};\n\t\t\tcursor: pointer;\n\t\t\t-webkit-appearance: none;\n\t\t\tmargin-top: -6px;\n\t\t}\n\t\tinput[type=range]:focus::-webkit-slider-runnable-track, input[type=range]:hover::-webkit-slider-runnable-track {\n\t\t\tbackground: ${z.uiWidgetFocus};\n\t\t}\n\t\tinput[type=range]::-moz-range-track {\n\t\t\twidth: 100%;\n\t\t\theight: 4px;\n\t\t\tcursor: pointer;\n\t\t\tbackground: ${z.uiWidgetBackground};\n\t\t}\n\t\tinput[type=range]:focus::-moz-range-track, input[type=range]:hover::-moz-range-track  {\n\t\t\tbackground: ${z.uiWidgetFocus};\n\t\t}\n\t\tinput[type=range]::-moz-range-thumb {\n\t\t\theight: 16px;\n\t\t\twidth: 4px;\n\t\t\tborder-radius: 2px;\n\t\t\tborder: none;\n\t\t\tbackground: ${z.primaryText};\n\t\t\tcursor: pointer;\n\t\t}\n\t\tinput[type=range]::-ms-track {\n\t\t\twidth: 100%;\n\t\t\theight: 4px;\n\t\t\tcursor: pointer;\n\t\t\tbackground: ${z.uiWidgetBackground};\n\t\t\tborder-color: transparent;\n\t\t}\n\t\tinput[type=range]:focus::-ms-track, input[type=range]:hover::-ms-track {\n\t\t\tbackground: ${z.uiWidgetFocus};\n\t\t}\n\t\tinput[type=range]::-ms-thumb {\n\t\t\theight: 16px;\n\t\t\twidth: 4px;\n\t\t\tborder-radius: 2px;\n\t\t\tbackground: ${z.primaryText};\n\t\t\tcursor: pointer;\n\t\t}\n\t`)),z.setTheme("jummbox classic");let ht,mt=null,dt=(4294967295*Math.random()>>>0).toString(16),ft=!1,pt=!1,ut=1,yt=0,vt=0;const gt=new tt;let bt=at({style:"flex-grow: 1; margin: 0 1px; margin-left: 10px; overflow: hidden;"},""),kt=et({target:"_top",style:"margin: 0 4px;"},"✎ Edit"),wt=et({href:"javascript:void(0)",style:"margin: 0 4px;"},"⎘ Copy URL"),Mt=et({href:"javascript:void(0)",style:"margin: 0 4px;"},"⤳ Share"),Ct=et({target:"_top",style:"margin: 0 4px;"},"⇱ Fullscreen"),Et=!1;const qt=nt({style:"width: 100%; height: 100%; max-height: 50px;"}),xt=it({style:"flex-shrink: 0; display: flex; padding: 2px; width: 80px; height: 100%; box-sizing: border-box; align-items: center;"},qt),Pt=ct({d:"M 4 2 L 4 0 L 7 3 L 4 6 L 4 4 Q 2 4 2 6 Q 2 8 4 8 L 4 10 Q 0 10 0 6 Q 0 2 4 2 M 8 10 L 8 12 L 5 9 L 8 6 L 8 8 Q 10 8 10 6 Q 10 4 8 4 L 8 2 Q 12 2 12 6 Q 12 10 8 10 z"}),St=nt({title:"loop",style:"background: none; flex: 0 0 12px; margin: 0 3px; width: 12px; height: 12px; display: flex;"},st({width:12,height:12,viewBox:"0 0 12 12"},Pt)),Ft=st({style:"flex: 0 0 12px; margin: 0 1px; width: 12px; height: 12px;",viewBox:"0 0 12 12"},ct({fill:z.uiWidgetBackground,d:"M 1 9 L 1 3 L 4 3 L 7 0 L 7 12 L 4 9 L 1 9 M 9 3 Q 12 6 9 9 L 8 8 Q 10.5 6 8 4 L 9 3 z"})),zt=rt({title:"volume",type:"range",value:75,min:0,max:75,step:1,style:"width: 12vw; max-width: 100px; margin: 0 1px;"}),Rt=st({width:12,height:12,viewBox:"0 0 12 12"},ot({cx:"5",cy:"5",r:"4.5","stroke-width":"1",stroke:"currentColor",fill:"none"}),ct({stroke:"currentColor","stroke-width":"2",d:"M 8 8 L 11 11 M 5 2 L 5 8 M 2 5 L 8 5",fill:"none"})),At=nt({title:"zoom",style:"background: none; flex: 0 0 12px; margin: 0 3px; width: 12px; height: 12px; display: flex;"},Rt),Tt=st({style:"min-width: 0; min-height: 0; touch-action: pan-y pinch-zoom;"}),Ht=it({style:`position: absolute; left: 0; top: 0; width: 2px; height: 100%; background: ${z.playhead}; pointer-events: none;`}),Bt=it({style:"display: flex; flex-grow: 1; flex-shrink: 1; position: relative;"},Tt,Ht),Dt=it({style:"display: flex; flex-grow: 1; flex-shrink: 1; height: 0; position: relative; align-items: center; overflow: hidden;"},Bt),Nt=C.rect({"pointer-events":"none",width:"90%",height:"50%",x:"5%",y:"25%",fill:z.uiWidgetBackground}),Ot=C.rect({"pointer-events":"none",height:"50%",width:"0%",x:"5%",y:"25%",fill:"url('#volumeGrad2')"}),It=C.rect({"pointer-events":"none",width:"2px",height:"50%",x:"5%",y:"25%",fill:z.uiWidgetFocus}),Lt=C.stop({"stop-color":"lime",offset:"60%"}),Wt=C.stop({"stop-color":"orange",offset:"90%"}),Vt=C.stop({"stop-color":"red",offset:"100%"}),Ut=C.linearGradient({id:"volumeGrad2",gradientUnits:"userSpaceOnUse"},Lt,Wt,Vt),jt=C.defs({},Ut),$t=C.svg({style:"touch-action: none; overflow: hidden; margin: auto;",width:"160px",height:"10px",preserveAspectRatio:"none"},jt,Nt,Ot,It);function Gt(){let t=location.hash;if(mt!=t&&""!=t){mt=t,"#"==t.charAt(0)&&(t=t.substring(1)),Ct.setAttribute("href",location.href);for(const e of t.split("&")){let n=e.indexOf("=");if(-1!=n){let t=e.substring(0,n),i=e.substring(n+1);switch(t){case"song":gt.setSong(i),gt.snapToStart(),gt.song&&(bt.textContent=gt.song.title),kt.setAttribute("href","../#"+i);break;case"loop":gt.loopRepeatCount="1"!=i?0:-1,re()}}else gt.setSong(t),gt.snapToStart(),kt.setAttribute("href","../#"+t)}ne()}}function Kt(){gt.playing&&(ht=requestAnimationFrame(Kt),localStorage.getItem("playerId")!=dt&&Qt(),ee(),_t()),ft!=gt.playing&&ae()}function _t(){if(null==gt.song)return It.setAttribute("x","5%"),void Ot.setAttribute("width","0%");var t,e;yt--,yt<=0&&(vt-=.03),gt.song.outVolumeCap>vt&&(vt=gt.song.outVolumeCap,yt=50),t=gt.song.outVolumeCap,e=vt,Ot.setAttribute("width",""+Math.min(144,144*t)),It.setAttribute("x",""+(8+Math.min(144,144*e))),gt.playing||(It.setAttribute("x","5%"),Ot.setAttribute("width","0%"))}function Qt(){null!=gt.song&&(null!=ht&&cancelAnimationFrame(ht),ht=null,gt.playing?(gt.pause(),_t()):(gt.play(),localStorage.setItem("playerId",dt),Kt())),ae()}function Jt(t){t.preventDefault(),Xt(t.clientX||t.pageX)}function Zt(t){Xt(t.touches[0].clientX)}function Xt(t){if(Et&&null!=gt.song){const e=Dt.getBoundingClientRect();gt.playhead=gt.song.barCount*(t-e.left)/(e.right-e.left),gt.computeLatestModValues(),ee()}}function Yt(){Et=!1}function te(){const t=+zt.value;gt.volume=Math.min(1,Math.pow(t/50,.5))*Math.pow(2,(t-75)/25)}function ee(){if(null!=gt.song){let t=gt.playhead/gt.song.barCount;Ht.style.left=ut*t+"px";const e=Dt.getBoundingClientRect();Dt.scrollLeft=t*(ut-e.width)}}function ne(){if(Tt.innerHTML="",null==gt.song)return;const t=Dt.getBoundingClientRect();let n,i,a;if(pt){n=t.height,i=Math.max(3,Math.min(e.pitchOctaves,Math.round(n/24))),a=12*i+1;const r=(n-1)/a,s=Math.max(8,4*r);ut=Math.max(t.width,s*gt.song.barCount*gt.song.beatsPerBar)}else{ut=t.width;const r=Math.max(1,ut/(gt.song.barCount*gt.song.beatsPerBar)/6);n=Math.min(t.height,r*(e.maxPitch+1)+1),i=Math.max(3,Math.min(e.pitchOctaves,Math.round(n/(12*r)))),a=12*i+1}Bt.style.width=ut+"px",Bt.style.height=n+"px",Tt.style.width=ut+"px",Tt.style.height=n+"px";const r=ut/gt.song.barCount,s=r/(gt.song.beatsPerBar*e.partsPerBeat),o=(n-1)/a,l=(n-1)/e.drumCount;for(let t=0;t<gt.song.barCount+1;t++){const e=t==gt.song.loopStart||t==gt.song.loopStart+gt.song.loopLength?z.loopAccent:z.uiWidgetBackground;Tt.appendChild(lt({x:t*r-1,y:0,width:2,height:n,fill:e}))}for(let t=0;t<=i;t++)Tt.appendChild(lt({x:0,y:12*t*o,width:ut,height:o+1,fill:z.tonic,opacity:.75}));for(let t=gt.song.channels.length-1-gt.song.modChannelCount;t>=0;t--){const a=gt.song.getChannelIsNoise(t),c=a?l:o,h=gt.song.channels[t].octave,m=(i-3)/2,d=e.pitchOctaves-i,f=d/2;let p=h-2.5;Math.abs(p)<=m?p=0:p<0?p+=m:p-=m;const u=Math.max(0,Math.min(d,Math.round(f+p)))*c*12+n-.5*c-.5;for(let e=0;e<gt.song.barCount;e++){const n=gt.song.getPattern(t,e);if(null==n)continue;const i=e*r;for(let e=0;e<n.notes.length;e++){const r=n.notes[e];for(const e of r.pitches){const n=ie(e,r.start,r.pins,(c+1)/2,i,u,s,c),o=ct({d:n,fill:z.getChannelColor(gt.song,t).primaryChannel});a&&(o.style.opacity=String(.6)),Tt.appendChild(o)}}}}ee()}function ie(t,e,n,i,a,r,s,o){let l=`M ${a+s*(e+n[0].time)} ${r-t*o+i*(n[0].volume/6)} `;for(let c=0;c<n.length;c++){const h=n[c];l+=`L ${a+s*(e+h.time)} ${r-o*(t+h.interval)-i*(h.volume/6)} `}for(let c=n.length-1;c>=0;c--){const h=n[c];l+=`L ${a+s*(e+h.time)} ${r-o*(t+h.interval)+i*(h.volume/6)} `}return l}function ae(){gt.playing?(qt.classList.remove("playButton"),qt.classList.add("pauseButton"),qt.title="Pause (Space)",qt.innerText="Pause"):(qt.classList.remove("pauseButton"),qt.classList.add("playButton"),qt.title="Play (Space)",qt.innerText="Play"),ft=gt.playing}function re(){Pt.setAttribute("fill",-1==gt.loopRepeatCount?z.linkAccent:z.uiWidgetBackground)}function se(){Rt.style.color=pt?z.linkAccent:z.uiWidgetBackground}return document.body.appendChild(Dt),document.body.appendChild(it({style:"flex-shrink: 0; height: 20vh; min-height: 22px; max-height: 70px; display: flex; align-items: center;"},xt,St,Ft,zt,At,$t,bt,kt,wt,Mt,Ct)),top!==self?(wt.style.display="none",Mt.style.display="none"):(Ct.style.display="none","share"in navigator||(Mt.style.display="none")),null!=localStorage.getItem("volume")&&(zt.value=localStorage.getItem("volume")),te(),window.addEventListener("resize",(function(){ne()})),window.addEventListener("keydown",(function(t){switch(t.keyCode){case 32:Qt(),t.preventDefault();break;case 219:gt.prevBar(),ee(),t.preventDefault();break;case 221:gt.nextBar(),ee(),t.preventDefault()}})),Tt.addEventListener("mousedown",(function(t){Et=!0,Jt(t)})),window.addEventListener("mousemove",Jt),window.addEventListener("mouseup",Yt),Tt.addEventListener("touchstart",(function(t){Et=!0,Zt(t)})),Tt.addEventListener("touchmove",Zt),Tt.addEventListener("touchend",Yt),Tt.addEventListener("touchcancel",Yt),qt.addEventListener("click",Qt),St.addEventListener("click",(function(){-1==gt.loopRepeatCount?gt.loopRepeatCount=0:gt.loopRepeatCount=-1,re()})),zt.addEventListener("input",(function(){localStorage.setItem("volume",zt.value),te()})),At.addEventListener("click",(function(){pt=!pt,se(),ne()})),wt.addEventListener("click",(function(){let t;if(t=navigator,t.clipboard&&t.clipboard.writeText)return void t.clipboard.writeText(location.href).catch((()=>{window.prompt("Copy to clipboard:",location.href)}));const e=document.createElement("textarea");e.innerText=location.href,document.body.appendChild(e),e.select();const n=document.execCommand("copy");e.remove(),n||window.prompt("Copy this:",location.href)})),Mt.addEventListener("click",(function(){navigator.share({url:location.href})})),window.addEventListener("hashchange",Gt),Gt(),re(),se(),ae(),t.Channel=Z,t.Config=e,t.Instrument=_,t.Note=U,t.Pattern=j,t.Synth=tt,Object.defineProperty(t,"W",{value:!0}),t}({});
//# sourceMappingURL=beepbox_player.min.js.map